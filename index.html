<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced Toolset for Efficient Time Series Dissimilarity Analysis • distantia</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Advanced Toolset for Efficient Time Series Dissimilarity Analysis">
<meta name="description" content="Fast C++ implementation of Dynamic Time Warping for time series dissimilarity analysis, with applications in environmental monitoring and sensor data analysis, climate science, signal processing and pattern recognition, and financial data analysis. Built upon the ideas presented in Benito and Birks (2020) &lt;doi:10.1111/ecog.04895&gt;, provides tools for analyzing time series of varying lengths and structures, including irregular multivariate time series. Key features include individual variable contribution analysis, restricted permutation tests for statistical significance, and imputation of missing data via GAMs. Additionally, the package provides an ample set of tools to prepare and manage time series data.">
<meta property="og:description" content="Fast C++ implementation of Dynamic Time Warping for time series dissimilarity analysis, with applications in environmental monitoring and sensor data analysis, climate science, signal processing and pattern recognition, and financial data analysis. Built upon the ideas presented in Benito and Birks (2020) &lt;doi:10.1111/ecog.04895&gt;, provides tools for analyzing time series of varying lengths and structures, including irregular multivariate time series. Key features include individual variable contribution analysis, restricted permutation tests for statistical significance, and imputation of missing data via GAMs. Additionally, the package provides an ample set of tools to prepare and manage time series data.">
<meta property="og:image" content="https://blasbenito.github.io/distantia/logo.png">
<link rel="stylesheet" href="extra.css">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">distantia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="articles/dynamic_time_warping_and_lock_step.html">Dynamic Time Warping vs Lock-Step</a></li>
    <li><a class="dropdown-item" href="articles/time_series_lists.html">Handling Time Series Lists</a></li>
    <li><a class="dropdown-item" href="articles/mapping_dissimilarity.html">Mapping Time Series Dissimilarity</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Articles</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.blasbenito.com/post/dynamic-time-warping/">A Gentle Intro to Dynamic Time Warping</a></li>
    <li><a class="external-link dropdown-item" href="https://www.blasbenito.com/post/distantia-showcase-covid/">Analyzing Epidemiological Time Series With The R Package {distantia}</a></li>
    <li><a class="external-link dropdown-item" href="https://www.blasbenito.com/post/dynamic-time-warping-from-scratch/">Coding a Minimalistic DTW Library</a></li>
    <li><a class="dropdown-item" href="articles/dtw_applications.html">Implementations and Applications of Dynamic Time Warping</a></li>
    <li><a class="dropdown-item" href="articles/distantia_in_the_wild.html">distantia In The Wild</a></li>
    <li><a class="dropdown-item" href="articles/download_history.html">Download history</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Original Paper</h6></li>
    <li><a class="external-link dropdown-item" href="https://nsojournals.onlinelibrary.wiley.com/doi/full/10.1111/ecog.04895">Benito &amp; Birks 2020 (Ecography)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BlasBenito/distantia/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="distantia-time-series-dissimilarity-">
<code>distantia</code> Time Series Dissimilarity 
<a class="anchor" aria-label="anchor" href="#distantia-time-series-dissimilarity-"></a>
</h1>
</div>
<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- badges: start -->

<!-- badges: end -->
<div class="section level2">
<h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a>
</h2>
<p>Version 2.0 of <code>distantia</code> is a full re-write of the original package and <strong>will break existing workflows</strong> before <strong>making them better</strong>. Please refer to the <a href="https://blasbenito.github.io/distantia/news/index.html">Changelog</a> for details before updating.</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The R package <strong><code>distantia</code></strong> offers an efficient, feature-rich toolkit for managing, comparing, and analyzing time series data. It is designed to handle a wide range of scenarios, including:</p>
<ul>
<li>Multivariate and univariate time series.</li>
<li>Regular and irregular sampling.</li>
<li>Time series of different lengths.</li>
</ul>
<div class="section level3">
<h3 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h3>
<div class="section level4">
<h4 id="comprehensive-analytical-tools">Comprehensive Analytical Tools<a class="anchor" aria-label="anchor" href="#comprehensive-analytical-tools"></a>
</h4>
<ul>
<li>10 distance metrics: see <code><a href="reference/distances.html">distantia::distances</a></code>.</li>
<li>The normalized dissimilarity metric <code>psi</code>.</li>
<li>Free and Restricted Dynamic Time Warping (DTW) for shape-based comparison.</li>
<li>A Lock-Step method for sample-to-sample comparison</li>
<li>Restricted permutation tests for robust inferential support.</li>
<li>Analysis of contribution to dissimilarity of individual variables in multivariate time series.</li>
<li>Hierarchical and K-means clustering of time series based on dissimilarity matrices.</li>
</ul>
</div>
<div class="section level4">
<h4 id="computational-efficiency">Computational Efficiency<a class="anchor" aria-label="anchor" href="#computational-efficiency"></a>
</h4>
<ul>
<li>A <strong>C++ back-end</strong> powered by <a href="https://www.rcpp.org/" class="external-link">Rcpp</a>.</li>
<li>
<strong>Parallel processing</strong> managed through the <a href="https://future.futureverse.org/" class="external-link">future</a> package.</li>
<li>
<strong>Efficient data handling</strong> via <a href="https://CRAN.R-project.org/package=zoo" class="external-link">zoo</a>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="time-series-management-tools">Time Series Management Tools<a class="anchor" aria-label="anchor" href="#time-series-management-tools"></a>
</h4>
<ul>
<li>Introduces <strong>time series lists</strong> (TSL), a versatile format for handling collections of time series stored as lists of <code>zoo</code> objects.</li>
<li>Includes a suite of <code>tsl_...()</code> functions for generating, resampling, transforming, analyzing, and visualizing univariate and multivariate time series.</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you find this package useful, please cite it as:</p>
<p><em>Blas M. Benito, H. John B. Birks (2020). distantia: an open-source toolset to quantify dissimilarity between multivariate ecological time-series. Ecography, 43(5), 660-667. doi: <a href="https://nsojournals.onlinelibrary.wiley.com/doi/10.1111/ecog.04895" class="external-link">10.1111/ecog.04895</a>.</em></p>
<p><em>Blas M. Benito (2024). distantia: A Toolset for Time Series Dissimilarity Analysis. R package version 2.0.0. url: <a href="https://blasbenito.github.io/distantia/" class="uri">https://blasbenito.github.io/distantia/</a>.</em></p>
</div>
<div class="section level2">
<h2 id="install">Install<a class="anchor" aria-label="anchor" href="#install"></a>
</h2>
<p>Version 2.0.0 of <code>distantia</code> can be installed from CRAN and GitHub.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#CRAN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"distantia"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#GitHub</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span></span>
<span>  repo <span class="op">=</span> <span class="st">"blasbenito/distantia"</span>, </span>
<span>  ref <span class="op">=</span> <span class="st">"main"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>This section showcases several features of the package <code>distantia</code>. Please, check the <strong>Articles</strong> section for further details.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>All heavy duty functions in <code>distantia</code> support parallelization via the <a href="https://future.futureverse.org/" class="external-link">future</a> package. However, due to the high efficiency of the C++ backend of <code>distantia</code>, parallel execution is only worth it for very large datasets and restricted permutation analyses.</p>
<p>Progress bars provided by the <a href="https://progressr.futureverse.org/" class="external-link">progressr</a> package are also available. Unfortunately, the latter does not work in Rmarkdown documents like this one.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://blasbenito.github.io/distantia/">distantia</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="co"># library(progressr)</span></span>
<span></span>
<span><span class="co">#parallelization setup</span></span>
<span><span class="co"># future::plan(future::multisession)</span></span>
<span></span>
<span><span class="co">#progress bar (does not work in Rmarkdown)</span></span>
<span><span class="co">#progressr::handlers(global = TRUE)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>The <code>albatross</code> data frame contains daily GPS data of 4 individuals of Waved Albatross in the Pacific captured during the summer of 2008. Below are the first 10 rows of this data frame:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#&gt;   name       time         x         y     speed temperature  heading</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; 1 X132 2008-05-31 -89.62097 -1.389512 0.1473333    29.06667 212.0307</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; 2 X132 2008-06-01 -89.62101 -1.389508 0.2156250    28.25000 184.0337</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; 3 X132 2008-06-02 -89.62101 -1.389503 0.2143750    27.68750 123.1269</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 4 X132 2008-06-03 -89.62099 -1.389508 0.2018750    27.81250 183.4600</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 5 X132 2008-06-04 -89.62098 -1.389507 0.2256250    27.68750 114.8931</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 6 X132 2008-06-05 -89.62925 -1.425734 1.3706667    25.73333 245.8033</span></span></code></pre></div>
<p>The code below transforms the data to a <em>Time Series List</em> with <code><a href="reference/tsl_initialize.html">tsl_initialize()</a></code> and applies global scaling and centering with <code><a href="reference/tsl_transform.html">tsl_transform()</a></code> and <code>f_scale_global</code> to facilitate time series comparisons.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tsl_initialize.html">tsl_initialize</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">distantia</span><span class="fu">::</span><span class="va"><a href="reference/albatross.html">albatross</a></span>,</span>
<span>  name_column <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>  time_column <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  lock_step <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/tsl_transform.html">tsl_transform</a></span><span class="op">(</span></span>
<span>    f <span class="op">=</span> <span class="va">f_scale_global</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/tsl_plot.html">tsl_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl</span>,</span>
<span>  ylim <span class="op">=</span> <span class="st">"relative"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="dissimilarity-analysis">Dissimilarity Analysis<a class="anchor" aria-label="anchor" href="#dissimilarity-analysis"></a>
</h3>
<div class="section level4">
<h4 id="lock-step-analysis">Lock-Step Analysis<a class="anchor" aria-label="anchor" href="#lock-step-analysis"></a>
</h4>
<p>Lock-step analysis performs direct comparisons between samples observed at the same time without any time distortion. It requires time series of the same length preferably observed at the same times.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/distantia.html">distantia</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl</span>,</span>
<span>  lock_step <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_ls</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"psi"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      x    y      psi</span></span>
<span><span class="co">#&gt; 1 X132 X134 1.888451</span></span>
<span><span class="co">#&gt; 3 X132 X153 2.128340</span></span>
<span><span class="co">#&gt; 5 X134 X153 2.187862</span></span>
<span><span class="co">#&gt; 4 X134 X136 2.270977</span></span>
<span><span class="co">#&gt; 2 X132 X136 2.427479</span></span>
<span><span class="co">#&gt; 6 X136 X153 2.666099</span></span></code></pre></div>
<p>The “psi” column shows normalized dissimilarity values and is used to sort the data frame from lowest to highest dissimilarity. Hence, the first row shows the most similar pair of time series.</p>
<p>The function <code><a href="reference/distantia_boxplot.html">distantia_boxplot()</a></code> enables a quick identification of the time series that are either more dissimilar (top) or similar (bottom) to others.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/distantia_boxplot.html">distantia_boxplot</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">df_ls</span>, text_cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png"><!-- --></p>
</div>
<div class="section level4">
<h4 id="dynamic-time-warping">Dynamic Time Warping<a class="anchor" aria-label="anchor" href="#dynamic-time-warping"></a>
</h4>
<p>By default, <code><a href="reference/distantia.html">distantia()</a></code> computes unrestricted dynamic time warping with orthogonal and diagonal least cost paths.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_dtw</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/distantia.html">distantia</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_dtw</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"psi"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      x    y      psi</span></span>
<span><span class="co">#&gt; 1 X132 X134 1.163499</span></span>
<span><span class="co">#&gt; 5 X134 X153 2.115504</span></span>
<span><span class="co">#&gt; 4 X134 X136 2.206298</span></span>
<span><span class="co">#&gt; 3 X132 X153 2.306471</span></span>
<span><span class="co">#&gt; 2 X132 X136 2.307844</span></span>
<span><span class="co">#&gt; 6 X136 X153 2.686551</span></span></code></pre></div>
<p>The function <code><a href="reference/distantia_dtw_plot.html">distantia_dtw_plot()</a></code> provides detailed insights into the alignment between a pair of time series resulting from DTW.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/distantia_dtw_plot.html">distantia_dtw_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X132"</span>, <span class="st">"X153"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<p>Deviations from the perfect diagonal in the least-cost path reveal adjustments made by DTW to align time series by shape rather than time.</p>
<p>The article <a href="https://blasbenito.github.io/distantia/articles/dynamic_time_warping_and_lock_step.html">Dynamic Time Warping vs Lock-Step</a> provides further insights on the advantages and disadvantages of each method in different scenarios.</p>
</div>
</div>
<div class="section level3">
<h3 id="permutation-test">Permutation Test<a class="anchor" aria-label="anchor" href="#permutation-test"></a>
</h3>
<p>The function <code><a href="reference/distantia.html">distantia()</a></code> implements restricted permutation tests to assess the significance of dissimilarity scores. It provides several setups to support different assumptions.</p>
<p>For example, the configuration below rearranges complete rows within 7-day blocks, assuming strong dependencies within rows and between observations that are close in time.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_dtw</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/distantia.html">distantia</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl</span>,</span>
<span>  repetitions <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  permutation <span class="op">=</span> <span class="st">"restricted_by_row"</span>,</span>
<span>  block_size <span class="op">=</span> <span class="fl">7</span> <span class="co">#one week</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_dtw</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"psi"</span>, <span class="st">"p_value"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      x    y      psi p_value</span></span>
<span><span class="co">#&gt; 1 X132 X134 1.163499   0.001</span></span>
<span><span class="co">#&gt; 5 X134 X153 2.115504   0.380</span></span>
<span><span class="co">#&gt; 4 X134 X136 2.206298   0.134</span></span>
<span><span class="co">#&gt; 3 X132 X153 2.306471   0.376</span></span>
<span><span class="co">#&gt; 2 X132 X136 2.307844   0.002</span></span>
<span><span class="co">#&gt; 6 X136 X153 2.686551   0.005</span></span></code></pre></div>
<p>The “p_value” column represents the fraction of permutations yielding a psi score lower than the observed value, and indicates the strength of similarity between two time series. A significance threshold (e.g., 0.05, depending on iterations) helps identifying pairs of time series with a robust similarity.</p>
</div>
<div class="section level3">
<h3 id="variable-importance">Variable Importance<a class="anchor" aria-label="anchor" href="#variable-importance"></a>
</h3>
<p>When comparing multivariate time series, certain variables contribute more to similarity or dissimilarity. The <code><a href="reference/momentum.html">momentum()</a></code> function uses a leave-one-out algorithm to quantify each variable’s contribution to the overall dissimilarity between two time series.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_importance</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/momentum.html">momentum</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_importance</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"variable"</span>, <span class="st">"importance"</span>, <span class="st">"effect"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;       x    y    variable  importance               effect</span></span>
<span><span class="co">#&gt; 1  X132 X134           x   89.721187 decreases similarity</span></span>
<span><span class="co">#&gt; 2  X132 X134           y  101.305396 decreases similarity</span></span>
<span><span class="co">#&gt; 3  X132 X134       speed  -28.286386 increases similarity</span></span>
<span><span class="co">#&gt; 4  X132 X134 temperature   78.130508 decreases similarity</span></span>
<span><span class="co">#&gt; 5  X132 X134     heading  -43.644053 increases similarity</span></span>
<span><span class="co">#&gt; 6  X132 X136           x   15.687570 decreases similarity</span></span>
<span><span class="co">#&gt; 7  X132 X136           y   82.867368 decreases similarity</span></span>
<span><span class="co">#&gt; 8  X132 X136       speed  -67.196851 increases similarity</span></span>
<span><span class="co">#&gt; 9  X132 X136 temperature  382.039900 decreases similarity</span></span>
<span><span class="co">#&gt; 10 X132 X136     heading -104.245839 increases similarity</span></span>
<span><span class="co">#&gt; 11 X132 X153           x  467.261463 decreases similarity</span></span>
<span><span class="co">#&gt; 12 X132 X153           y  159.727491 decreases similarity</span></span>
<span><span class="co">#&gt; 13 X132 X153       speed  -44.549191 increases similarity</span></span>
<span><span class="co">#&gt; 14 X132 X153 temperature   -4.016121 increases similarity</span></span>
<span><span class="co">#&gt; 15 X132 X153     heading  -88.852346 increases similarity</span></span>
<span><span class="co">#&gt; 16 X134 X136           x   36.205194 decreases similarity</span></span>
<span><span class="co">#&gt; 17 X134 X136           y   90.757712 decreases similarity</span></span>
<span><span class="co">#&gt; 18 X134 X136       speed  -61.923595 increases similarity</span></span>
<span><span class="co">#&gt; 19 X134 X136 temperature  348.244258 decreases similarity</span></span>
<span><span class="co">#&gt; 20 X134 X136     heading  -96.737145 increases similarity</span></span>
<span><span class="co">#&gt; 21 X134 X153           x  761.132445 decreases similarity</span></span>
<span><span class="co">#&gt; 22 X134 X153           y   26.329542 decreases similarity</span></span>
<span><span class="co">#&gt; 23 X134 X153       speed  -62.801312 increases similarity</span></span>
<span><span class="co">#&gt; 24 X134 X153 temperature  -23.264433 increases similarity</span></span>
<span><span class="co">#&gt; 25 X134 X153     heading  -76.874072 increases similarity</span></span>
<span><span class="co">#&gt; 26 X136 X153           x  530.402462 decreases similarity</span></span>
<span><span class="co">#&gt; 27 X136 X153           y   24.217594 decreases similarity</span></span>
<span><span class="co">#&gt; 28 X136 X153       speed  -67.659029 increases similarity</span></span>
<span><span class="co">#&gt; 29 X136 X153 temperature  255.711643 decreases similarity</span></span>
<span><span class="co">#&gt; 30 X136 X153     heading -119.877355 increases similarity</span></span></code></pre></div>
<p>Positive “importance” values indicate variables contributing to dissimilarity, while negative values indicate contribution to similarity. The function documentation provides more details on how importance scores are computed.</p>
<p>The <code><a href="reference/momentum_boxplot.html">momentum_boxplot()</a></code> function provides a quick insight into which variables contribute the most to similarity or dissimilarity across all pairs of time series.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/momentum_boxplot.html">momentum_boxplot</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">df_importance</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="75%"></p>
</div>
<div class="section level3">
<h3 id="clustering">Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h3>
<p>The package <code>distantia</code> provides tools to group together time series by dissimilarity using hierarchical or K-means clustering. The example below applies the former to the <code>albatross</code> dataset to find out groups of individuals with the most similar movement time series.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtw_hclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/distantia_cluster_hclust.html">distantia_cluster_hclust</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">df_dtw</span>,</span>
<span>  clusters <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">#automatic mode</span></span>
<span>  method <span class="op">=</span> <span class="cn">NULL</span>    <span class="co">#automatic mode</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">#cluster object</span></span>
<span><span class="va">dtw_hclust</span><span class="op">$</span><span class="va">cluster_object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::hclust(d = d_dist, method = method)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cluster method   : ward.D </span></span>
<span><span class="co">#&gt; Number of objects: 4</span></span>
<span></span>
<span><span class="co">#number of clusters</span></span>
<span><span class="va">dtw_hclust</span><span class="op">$</span><span class="va">clusters</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span></span>
<span><span class="co">#clustering data frame</span></span>
<span><span class="co">#group label in column "cluster"</span></span>
<span><span class="co">#negatives in column "silhouette_width" higlight anomalous cluster assignation</span></span>
<span><span class="va">dtw_hclust</span><span class="op">$</span><span class="va">df</span></span>
<span><span class="co">#&gt;   name cluster silhouette_width</span></span>
<span><span class="co">#&gt; 1 X132       1        0.4955501</span></span>
<span><span class="co">#&gt; 2 X134       1        0.4500134</span></span>
<span><span class="co">#&gt; 3 X136       2        0.0000000</span></span>
<span><span class="co">#&gt; 4 X153       3        0.0000000</span></span>
<span></span>
<span><span class="co">#tree plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span></span>
<span>    <span class="va">dtw_hclust</span><span class="op">$</span><span class="va">cluster_object</span></span>
<span>    <span class="op">)</span>,</span>
<span>  horiz <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="75%"></p>
<p>This is just a summary of the features implemented in the package. Please visit the <strong>Articles</strong> section to find out more about <code>distantia</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<p>If you encounter bugs or issues with the documentation, please <a href="https://github.com/BlasBenito/distantia/issues" class="external-link">file a issue on GitHub</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=distantia" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/BlasBenito/distantia/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/BlasBenito/distantia/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing distantia</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://blasbenito.com" class="external-link">Blas M. Benito</a> <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-5105-7232" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://zenodo.org/badge/latestdoi/187805264" class="external-link"><img src="https://zenodo.org/badge/187805264.svg" alt="DOI"></a></li>
<li><a href="https://CRAN.R-project.org/package=distantia" class="external-link"><img src="http://www.r-pkg.org/badges/version/distantia" alt="CRAN_Release_Badge"></a></li>
<li><a href="https://CRAN.R-project.org/package=distantia" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/distantia" alt="CRAN_Download_Badge"></a></li>
<li><a href="https://github.com/BlasBenito/distantia/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/BlasBenito/distantia/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://blasbenito.com" class="external-link">Blas M. Benito</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
