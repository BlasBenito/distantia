<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Two-Way Dissimilarity Plots of Time Series Lists — distantia_plot • distantia</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Two-Way Dissimilarity Plots of Time Series Lists — distantia_plot"><meta name="description" content="Plots two sequences, their distance or cost matrix, their least cost path, and all relevant values used to compute dissimilarity.
Unlike distantia(), this function does not accept vectors as inputs for the arguments to compute dissimilarity (distance, diagonal,  and weighted), and only plots a pair of sequences at once.
The argument lock_step is not available because this plot does not make sense in such a case."><meta property="og:description" content="Plots two sequences, their distance or cost matrix, their least cost path, and all relevant values used to compute dissimilarity.
Unlike distantia(), this function does not accept vectors as inputs for the arguments to compute dissimilarity (distance, diagonal,  and weighted), and only plots a pair of sequences at once.
The argument lock_step is not available because this plot does not make sense in such a case."><meta property="og:image" content="https://blasbenito.github.io/distantia/logo.png"><link rel="stylesheet" href="extra.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">distantia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/dynamic_time_warping_and_lock_step.html">Dynamic Time Warping vs Lock-Step</a></li>
    <li><a class="dropdown-item" href="../articles/time_series_lists.html">Handling Time Series Lists</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Original Paper</h6></li>
    <li><a class="external-link dropdown-item" href="https://nsojournals.onlinelibrary.wiley.com/doi/full/10.1111/ecog.04895">Benito &amp; Birks 2020 (Ecography)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BlasBenito/distantia/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Two-Way Dissimilarity Plots of Time Series Lists</h1>
      <small class="dont-index">Source: <a href="https://github.com/BlasBenito/distantia/blob/main/R/distantia_plot.R" class="external-link"><code>R/distantia_plot.R</code></a></small>
      <div class="d-none name"><code>distantia_plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots two sequences, their distance or cost matrix, their least cost path, and all relevant values used to compute dissimilarity.</p>
<p>Unlike <code><a href="distantia.html">distantia()</a></code>, this function does not accept vectors as inputs for the arguments to compute dissimilarity (<code>distance</code>, <code>diagonal</code>,  and <code>weighted</code>), and only plots a pair of sequences at once.</p>
<p>The argument <code>lock_step</code> is not available because this plot does not make sense in such a case.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">distantia_plot</span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  diagonal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bandwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  matrix_type <span class="op">=</span> <span class="st">"cost"</span>,</span>
<span>  matrix_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  path_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  path_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  diagonal_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  diagonal_color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  line_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  line_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  text_cex <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tsl">tsl<a class="anchor" aria-label="anchor" href="#arg-tsl"></a></dt>
<dd><p>(required, time series list) list of zoo time series. Default: NULL</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>(optional, character vector) name or abbreviation of the distance method. Valid values are in the columns "names" and "abbreviation" of the dataset <a href="distances.html">distances</a>. Default: "euclidean".</p></dd>


<dt id="arg-diagonal">diagonal<a class="anchor" aria-label="anchor" href="#arg-diagonal"></a></dt>
<dd><p>(optional, logical vector). If TRUE, diagonals are included in the dynamic time warping computation. Default: TRUE</p></dd>


<dt id="arg-bandwidth">bandwidth<a class="anchor" aria-label="anchor" href="#arg-bandwidth"></a></dt>
<dd><p>(optional, numeric) Proportion of space at each side of the cost matrix diagonal (aka <em>Itakura parallelogram</em>) defining a valid region for dynamic time warping, used to control the flexibility of the warping path. This method prevents degenerate alignments due to differences in magnitude between time series when the data is not properly scaled. If <code>1</code> (default), DTW is unconstrained. If <code>0</code>, DTW is fully constrained and the warping path follows the matrix diagonal. Recommended values may vary depending on the nature of the data. Ignored if <code>lock_step = TRUE</code>. Default: 1.</p></dd>


<dt id="arg-matrix-type">matrix_type<a class="anchor" aria-label="anchor" href="#arg-matrix-type"></a></dt>
<dd><p>(optional, character string): one of "cost" or "distance" (the abbreviation "dist" is accepted as well). Default: "cost".</p></dd>


<dt id="arg-matrix-color">matrix_color<a class="anchor" aria-label="anchor" href="#arg-matrix-color"></a></dt>
<dd><p>(optional, character vector) vector of colors for the distance or cost matrix. If NULL, uses the palette "Zissou 1" provided by the function <code><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">grDevices::hcl.colors()</a></code>. Default: NULL</p></dd>


<dt id="arg-path-width">path_width<a class="anchor" aria-label="anchor" href="#arg-path-width"></a></dt>
<dd><p>(optional, numeric) width of the least cost path. Default: 1</p></dd>


<dt id="arg-path-color">path_color<a class="anchor" aria-label="anchor" href="#arg-path-color"></a></dt>
<dd><p>(optional, character string) color of the least-cost path. Default: "black"</p></dd>


<dt id="arg-diagonal-width">diagonal_width<a class="anchor" aria-label="anchor" href="#arg-diagonal-width"></a></dt>
<dd><p>(optional, numeric) width of the diagonal. Set to 0 to remove the diagonal line. Default: 0.5</p></dd>


<dt id="arg-diagonal-color">diagonal_color<a class="anchor" aria-label="anchor" href="#arg-diagonal-color"></a></dt>
<dd><p>(optional, character string) color of the diagonal. Default: "white"</p></dd>


<dt id="arg-line-color">line_color<a class="anchor" aria-label="anchor" href="#arg-line-color"></a></dt>
<dd><p>(optional, character vector) Vector of colors for the time series plot. If not provided, defaults to a subset of <code>matrix_color</code>.</p></dd>


<dt id="arg-line-width">line_width<a class="anchor" aria-label="anchor" href="#arg-line-width"></a></dt>
<dd><p>(optional, numeric vector) Width of the time series plot. Default: 1</p></dd>


<dt id="arg-text-cex">text_cex<a class="anchor" aria-label="anchor" href="#arg-text-cex"></a></dt>
<dd><p>(optional, numeric) Multiplier of the text size. Default: 1</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A plot.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other dissimilarity_analysis:
<code><a href="distantia_aggregate.html">distantia_aggregate</a>()</code>,
<code><a href="distantia_boxplot.html">distantia_boxplot</a>()</code>,
<code><a href="distantia_cluster_hclust.html">distantia_cluster_hclust</a>()</code>,
<code><a href="distantia_cluster_kmeans.html">distantia_cluster_kmeans</a>()</code>,
<code><a href="distantia_matrix.html">distantia_matrix</a>()</code>,
<code><a href="distantia_to_sf.html">distantia_to_sf</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#three time series</span></span></span>
<span class="r-in"><span><span class="co">#climate and ndvi in Fagus sylvatica stands in Spain, Germany, and Sweden</span></span></span>
<span class="r-in"><span><span class="co">#convert to time series list</span></span></span>
<span class="r-in"><span><span class="co">#scale and center to neutralize effect of different scales in temperature, rainfall, and ndvi</span></span></span>
<span class="r-in"><span><span class="va">tsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="tsl_initialize.html">tsl_initialize</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">fagus_dynamics</span>,</span></span>
<span class="r-in"><span>  name_column <span class="op">=</span> <span class="st">"name"</span>,</span></span>
<span class="r-in"><span>  time_column <span class="op">=</span> <span class="st">"time"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tsl_transform.html">tsl_transform</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">f_scale_global</span> <span class="co">#see help(f_scale_global)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tsl_plot.html">tsl_plot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    tsl <span class="op">=</span> <span class="va">tsl</span>,</span></span>
<span class="r-in"><span>    guide_columns <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#visualize dynamic time warping</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#plot pair with cost matrix (default)</span></span></span>
<span class="r-in"><span>  <span class="fu">distantia_plot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    tsl <span class="op">=</span> <span class="va">tsl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spain"</span>, <span class="st">"Sweden"</span><span class="op">)</span><span class="op">]</span> <span class="co">#only two time series!</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#plot pair with distance matrix</span></span></span>
<span class="r-in"><span>  <span class="fu">distantia_plot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    tsl <span class="op">=</span> <span class="va">tsl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spain"</span>, <span class="st">"Sweden"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    matrix_type <span class="op">=</span> <span class="st">"distance"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#plot pair with different distance</span></span></span>
<span class="r-in"><span>  <span class="fu">distantia_plot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    tsl <span class="op">=</span> <span class="va">tsl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spain"</span>, <span class="st">"Sweden"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    distance <span class="op">=</span> <span class="st">"manhattan"</span>, <span class="co">#sed data(distances)</span></span></span>
<span class="r-in"><span>    matrix_type <span class="op">=</span> <span class="st">"distance"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#with different colors</span></span></span>
<span class="r-in"><span>  <span class="fu">distantia_plot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    tsl <span class="op">=</span> <span class="va">tsl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spain"</span>, <span class="st">"Sweden"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    matrix_type <span class="op">=</span> <span class="st">"distance"</span>,</span></span>
<span class="r-in"><span>    matrix_color <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      n <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>      palette <span class="op">=</span> <span class="st">"Inferno"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    path_color <span class="op">=</span> <span class="st">"white"</span>,</span></span>
<span class="r-in"><span>    path_width <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    line_color <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      n <span class="op">=</span> <span class="fl">3</span>, <span class="co">#same as variables in tsl</span></span></span>
<span class="r-in"><span>      palette <span class="op">=</span> <span class="st">"Inferno"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://blasbenito.com" class="external-link">Blas M. Benito</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

