<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Computation of Dissimilarity Between Multivariate Time Series • distantia</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Computation of Dissimilarity Between Multivariate Time Series">
<meta property="og:description" content='This R package provides tools to assess the dissimilarity between multivariate time series by using the psi measure described in "Numerical methods in Quaternary pollen analysis" (Birks and Gordon, 1985 &lt;doi:10.1002/jqs.3390020110&gt;). The algorithm computes a matrix of distances (euclidean, manhattan, chi) between all sample pairs, and minimizes the sum of distances while respecting the sample order.'>
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">distantia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="distantia" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#distantia" class="anchor"></a>distantia</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The package <strong>distantia</strong> allows to measure the dissimilarity between multivariate time-series (<em>sequences</em> hereafter). The package assumes that the target sequences are ordered along a given dimension, being depth and time the most common ones, but others such as latitude or elevation are also suitable. Furthermore, the target sequences can be regular or irregular, and have their samples aligned (same age/time/depth) or unaligned (different age/time/depth). The only requirement is that the sequences must have at least two (but ideally more) columns with the same name and units.</p>
<p>In this document I briefly explain the logics behind the method, show how to use it, and demonstrate how the <strong>distantia</strong> package introduces useful tools to compare multivariate time-series.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of distantia from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("distantia")</span></a></code></pre></div>
<p>And the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"devtools"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"BlasBenito/distantia"</span>)</a></code></pre></div>
<p>Loading the library, plus other helper libraries:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(distantia)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(viridis)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(kableExtra)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(qgraph)</a></code></pre></div>
</div>
<div id="working-with-two-irregular-and-unaligned-sequences" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-two-irregular-and-unaligned-sequences" class="anchor"></a>Working with two irregular and unaligned sequences</h2>
<div id="preparing-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#preparing-the-data" class="anchor"></a>Preparing the data</h3>
<p>This section assumes that the user wants to compare two sequences. The package provides two example datasets based on the Abernethy pollen core (Birks and Mathewes, 1978):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sequenceA)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sequenceB)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(sequenceA)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; 'data.frame':    49 obs. of  9 variables:</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;  $ betula: int  79 113 51 130 31 59 78 71 140 150 ...</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;  $ pinus : int  271 320 420 470 450 425 386 397 310 323 ...</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;  $ corylu: int  36 42 39 6 6 12 29 52 50 34 ...</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;  $ junipe: int  0 0 0 0 0 0 2 2 2 2 ...</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  $ empetr: int  4 4 2 0 3 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  $ gramin: int  7 3 1 2 2 2 0 6 4 11 ...</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  $ cypera: int  25 11 12 4 3 3 2 3 3 2 ...</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  $ artemi: int  0 0 0 0 0 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  $ rumex : int  0 0 0 0 0 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(sequenceB)</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; 'data.frame':    41 obs. of  8 variables:</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;  $ betula: int  19 18 30 26 31 24 23 48 29 23 ...</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;  $ pinus : int  175 119 99 101 99 97 105 112 108 110 ...</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;  $ corylu: int  NA 28 37 29 30 28 34 46 16 21 ...</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;  $ junipe: int  2 1 0 0 0 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt;  $ gramin: int  34 36 2 0 1 2 1 0 6 2 ...</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt;  $ cypera: int  39 44 20 18 10 9 6 12 3 11 ...</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt;  $ artemi: int  1 0 0 0 0 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt;  $ rumex : int  0 4 1 0 0 0 0 0 0 1 ...</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(sequenceA, <span class="dt">caption =</span> <span class="st">"Sequence A"</span>)</a></code></pre></div>
<table class="table table">
<caption>
Sequence A
</caption>
<thead><tr>
<th style="text-align:right;">
betula
</th>
<th style="text-align:right;">
pinus
</th>
<th style="text-align:right;">
corylu
</th>
<th style="text-align:right;">
junipe
</th>
<th style="text-align:right;">
empetr
</th>
<th style="text-align:right;">
gramin
</th>
<th style="text-align:right;">
cypera
</th>
<th style="text-align:right;">
artemi
</th>
<th style="text-align:right;">
rumex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
271
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
320
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
470
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
450
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
425
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
386
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
397
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
310
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
323
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
317
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
181
</td>
<td style="text-align:right;">
345
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
153
</td>
<td style="text-align:right;">
285
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
214
</td>
<td style="text-align:right;">
315
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
210
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
285
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
357
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
304
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
151
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
375
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
382
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
390
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
361
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
405
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
386
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
411
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
394
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
338
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
311
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
236
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
206
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
26
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
143
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
31
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
214
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
16
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
167
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
28
</td>
</tr>
<tr>
<td style="text-align:right;">
183
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
26
</td>
</tr>
<tr>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
97
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
36
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
35
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(sequenceB, <span class="dt">caption =</span> <span class="st">"Sequence B"</span>)</a></code></pre></div>
<table class="table table">
<caption>
Sequence B
</caption>
<thead><tr>
<th style="text-align:right;">
betula
</th>
<th style="text-align:right;">
pinus
</th>
<th style="text-align:right;">
corylu
</th>
<th style="text-align:right;">
junipe
</th>
<th style="text-align:right;">
gramin
</th>
<th style="text-align:right;">
cypera
</th>
<th style="text-align:right;">
artemi
</th>
<th style="text-align:right;">
rumex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
183
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
144
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
188
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
137
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
230
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
178
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
33
</td>
</tr>
<tr>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
73
</td>
</tr>
<tr>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
<p>Notice that <strong>sequenceB</strong> has a few NA values (that were introduced to serve as an example). The function <strong>prepareSequences</strong> gets them ready for analysis by matching colum names and handling empty data. It allows to merge two (or more) multivariate time-series into a single table ready for further analyses. Note that, since the data represents pollen abundances, a <em>Hellinger</em> transformation (square root of the relative proportions of each taxa) is applied.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/help">help</a></span>(prepareSequences)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">AB.sequences &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">sequence.A =</span> sequenceA,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="dt">sequence.A.name =</span> <span class="st">"A"</span>,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="dt">sequence.B =</span> sequenceB,</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  <span class="dt">sequence.B.name =</span> <span class="st">"B"</span>,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="dt">merge.mode =</span> <span class="st">"complete"</span>,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  <span class="dt">if.empty.cases =</span> <span class="st">"zero"</span>,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  <span class="dt">transformation =</span> <span class="st">"hellinger"</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB.sequences)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
betula
</th>
<th style="text-align:right;">
pinus
</th>
<th style="text-align:right;">
corylu
</th>
<th style="text-align:right;">
junipe
</th>
<th style="text-align:right;">
empetr
</th>
<th style="text-align:right;">
gramin
</th>
<th style="text-align:right;">
cypera
</th>
<th style="text-align:right;">
artemi
</th>
<th style="text-align:right;">
rumex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.4326704
</td>
<td style="text-align:right;">
0.8013611
</td>
<td style="text-align:right;">
0.2920753
</td>
<td style="text-align:right;">
0.0004868
</td>
<td style="text-align:right;">
0.0973584
</td>
<td style="text-align:right;">
0.1287931
</td>
<td style="text-align:right;">
0.2433961
</td>
<td style="text-align:right;">
0.0004868
</td>
<td style="text-align:right;">
0.0004868
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.4787575
</td>
<td style="text-align:right;">
0.8056592
</td>
<td style="text-align:right;">
0.2918778
</td>
<td style="text-align:right;">
0.0004504
</td>
<td style="text-align:right;">
0.0900754
</td>
<td style="text-align:right;">
0.0780076
</td>
<td style="text-align:right;">
0.1493732
</td>
<td style="text-align:right;">
0.0004504
</td>
<td style="text-align:right;">
0.0004504
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3116774
</td>
<td style="text-align:right;">
0.8944269
</td>
<td style="text-align:right;">
0.2725540
</td>
<td style="text-align:right;">
0.0004364
</td>
<td style="text-align:right;">
0.0617213
</td>
<td style="text-align:right;">
0.0436436
</td>
<td style="text-align:right;">
0.1511857
</td>
<td style="text-align:right;">
0.0004364
</td>
<td style="text-align:right;">
0.0004364
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.4608884
</td>
<td style="text-align:right;">
0.8763409
</td>
<td style="text-align:right;">
0.0990147
</td>
<td style="text-align:right;">
0.0004042
</td>
<td style="text-align:right;">
0.0004042
</td>
<td style="text-align:right;">
0.0571662
</td>
<td style="text-align:right;">
0.0808452
</td>
<td style="text-align:right;">
0.0004042
</td>
<td style="text-align:right;">
0.0004042
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2502523
</td>
<td style="text-align:right;">
0.9534623
</td>
<td style="text-align:right;">
0.1100963
</td>
<td style="text-align:right;">
0.0004495
</td>
<td style="text-align:right;">
0.0778499
</td>
<td style="text-align:right;">
0.0635642
</td>
<td style="text-align:right;">
0.0778499
</td>
<td style="text-align:right;">
0.0004495
</td>
<td style="text-align:right;">
0.0004495
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3431681
</td>
<td style="text-align:right;">
0.9210335
</td>
<td style="text-align:right;">
0.1547646
</td>
<td style="text-align:right;">
0.0004468
</td>
<td style="text-align:right;">
0.0004468
</td>
<td style="text-align:right;">
0.0631824
</td>
<td style="text-align:right;">
0.0773823
</td>
<td style="text-align:right;">
0.0004468
</td>
<td style="text-align:right;">
0.0004468
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3961585
</td>
<td style="text-align:right;">
0.8812828
</td>
<td style="text-align:right;">
0.2415576
</td>
<td style="text-align:right;">
0.0634361
</td>
<td style="text-align:right;">
0.0004486
</td>
<td style="text-align:right;">
0.0004486
</td>
<td style="text-align:right;">
0.0634361
</td>
<td style="text-align:right;">
0.0004486
</td>
<td style="text-align:right;">
0.0004486
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3656637
</td>
<td style="text-align:right;">
0.8646650
</td>
<td style="text-align:right;">
0.3129351
</td>
<td style="text-align:right;">
0.0613716
</td>
<td style="text-align:right;">
0.0004340
</td>
<td style="text-align:right;">
0.1062988
</td>
<td style="text-align:right;">
0.0751646
</td>
<td style="text-align:right;">
0.0004340
</td>
<td style="text-align:right;">
0.0004340
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5244511
</td>
<td style="text-align:right;">
0.7804082
</td>
<td style="text-align:right;">
0.3134195
</td>
<td style="text-align:right;">
0.0626839
</td>
<td style="text-align:right;">
0.0004432
</td>
<td style="text-align:right;">
0.0886484
</td>
<td style="text-align:right;">
0.0767718
</td>
<td style="text-align:right;">
0.0004432
</td>
<td style="text-align:right;">
0.0004432
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5360561
</td>
<td style="text-align:right;">
0.7866216
</td>
<td style="text-align:right;">
0.2552138
</td>
<td style="text-align:right;">
0.0618984
</td>
<td style="text-align:right;">
0.0004377
</td>
<td style="text-align:right;">
0.1451647
</td>
<td style="text-align:right;">
0.0618984
</td>
<td style="text-align:right;">
0.0004377
</td>
<td style="text-align:right;">
0.0004377
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5666575
</td>
<td style="text-align:right;">
0.7626605
</td>
<td style="text-align:right;">
0.2605568
</td>
<td style="text-align:right;">
0.0605782
</td>
<td style="text-align:right;">
0.0004284
</td>
<td style="text-align:right;">
0.1420686
</td>
<td style="text-align:right;">
0.0741929
</td>
<td style="text-align:right;">
0.0004284
</td>
<td style="text-align:right;">
0.0004284
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5649990
</td>
<td style="text-align:right;">
0.7800418
</td>
<td style="text-align:right;">
0.2222222
</td>
<td style="text-align:right;">
0.0727393
</td>
<td style="text-align:right;">
0.0004200
</td>
<td style="text-align:right;">
0.1111111
</td>
<td style="text-align:right;">
0.0727393
</td>
<td style="text-align:right;">
0.0004200
</td>
<td style="text-align:right;">
0.0004200
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5599326
</td>
<td style="text-align:right;">
0.7642095
</td>
<td style="text-align:right;">
0.2716072
</td>
<td style="text-align:right;">
0.0640184
</td>
<td style="text-align:right;">
0.0004527
</td>
<td style="text-align:right;">
0.1280369
</td>
<td style="text-align:right;">
0.0784062
</td>
<td style="text-align:right;">
0.0004527
</td>
<td style="text-align:right;">
0.0452679
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5952348
</td>
<td style="text-align:right;">
0.7221655
</td>
<td style="text-align:right;">
0.2990049
</td>
<td style="text-align:right;">
0.0575435
</td>
<td style="text-align:right;">
0.0406894
</td>
<td style="text-align:right;">
0.1467078
</td>
<td style="text-align:right;">
0.0909843
</td>
<td style="text-align:right;">
0.0004069
</td>
<td style="text-align:right;">
0.0004069
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.6516350
</td>
<td style="text-align:right;">
0.6677272
</td>
<td style="text-align:right;">
0.2950403
</td>
<td style="text-align:right;">
0.1128665
</td>
<td style="text-align:right;">
0.0004608
</td>
<td style="text-align:right;">
0.1457100
</td>
<td style="text-align:right;">
0.0921551
</td>
<td style="text-align:right;">
0.0004608
</td>
<td style="text-align:right;">
0.0004608
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.7824606
</td>
<td style="text-align:right;">
0.3933978
</td>
<td style="text-align:right;">
0.4225770
</td>
<td style="text-align:right;">
0.0922139
</td>
<td style="text-align:right;">
0.0004124
</td>
<td style="text-align:right;">
0.1844277
</td>
<td style="text-align:right;">
0.1091089
</td>
<td style="text-align:right;">
0.0004124
</td>
<td style="text-align:right;">
0.0004124
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.7958222
</td>
<td style="text-align:right;">
0.2403700
</td>
<td style="text-align:right;">
0.5163977
</td>
<td style="text-align:right;">
0.0471404
</td>
<td style="text-align:right;">
0.0471404
</td>
<td style="text-align:right;">
0.1699673
</td>
<td style="text-align:right;">
0.0942809
</td>
<td style="text-align:right;">
0.0004714
</td>
<td style="text-align:right;">
0.0004714
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8176424
</td>
<td style="text-align:right;">
0.2163711
</td>
<td style="text-align:right;">
0.4934021
</td>
<td style="text-align:right;">
0.0432742
</td>
<td style="text-align:right;">
0.0749532
</td>
<td style="text-align:right;">
0.1499063
</td>
<td style="text-align:right;">
0.1059998
</td>
<td style="text-align:right;">
0.0004327
</td>
<td style="text-align:right;">
0.0004327
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.7933468
</td>
<td style="text-align:right;">
0.1509116
</td>
<td style="text-align:right;">
0.5591325
</td>
<td style="text-align:right;">
0.0004550
</td>
<td style="text-align:right;">
0.0788110
</td>
<td style="text-align:right;">
0.1438886
</td>
<td style="text-align:right;">
0.0910031
</td>
<td style="text-align:right;">
0.0004550
</td>
<td style="text-align:right;">
0.0004550
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8131614
</td>
<td style="text-align:right;">
0.1276884
</td>
<td style="text-align:right;">
0.5212859
</td>
<td style="text-align:right;">
0.0004256
</td>
<td style="text-align:right;">
0.0851256
</td>
<td style="text-align:right;">
0.1855270
</td>
<td style="text-align:right;">
0.0951733
</td>
<td style="text-align:right;">
0.0004256
</td>
<td style="text-align:right;">
0.0004256
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8372182
</td>
<td style="text-align:right;">
0.1497661
</td>
<td style="text-align:right;">
0.4656419
</td>
<td style="text-align:right;">
0.0432338
</td>
<td style="text-align:right;">
0.0611418
</td>
<td style="text-align:right;">
0.1834253
</td>
<td style="text-align:right;">
0.1433902
</td>
<td style="text-align:right;">
0.0004323
</td>
<td style="text-align:right;">
0.0004323
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8191188
</td>
<td style="text-align:right;">
0.1286239
</td>
<td style="text-align:right;">
0.5036630
</td>
<td style="text-align:right;">
0.0958706
</td>
<td style="text-align:right;">
0.0606339
</td>
<td style="text-align:right;">
0.1868862
</td>
<td style="text-align:right;">
0.1050210
</td>
<td style="text-align:right;">
0.0004287
</td>
<td style="text-align:right;">
0.0004287
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8680159
</td>
<td style="text-align:right;">
0.1404417
</td>
<td style="text-align:right;">
0.4259807
</td>
<td style="text-align:right;">
0.0888231
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.1601281
</td>
<td style="text-align:right;">
0.0444116
</td>
<td style="text-align:right;">
0.0004441
</td>
<td style="text-align:right;">
0.0628074
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8570082
</td>
<td style="text-align:right;">
0.1503292
</td>
<td style="text-align:right;">
0.4296014
</td>
<td style="text-align:right;">
0.1227433
</td>
<td style="text-align:right;">
0.0751646
</td>
<td style="text-align:right;">
0.1623741
</td>
<td style="text-align:right;">
0.0970371
</td>
<td style="text-align:right;">
0.0004340
</td>
<td style="text-align:right;">
0.0433963
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8438195
</td>
<td style="text-align:right;">
0.1256148
</td>
<td style="text-align:right;">
0.3768445
</td>
<td style="text-align:right;">
0.2512297
</td>
<td style="text-align:right;">
0.1256148
</td>
<td style="text-align:right;">
0.1986145
</td>
<td style="text-align:right;">
0.0993073
</td>
<td style="text-align:right;">
0.0004441
</td>
<td style="text-align:right;">
0.0444116
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8799877
</td>
<td style="text-align:right;">
0.1514746
</td>
<td style="text-align:right;">
0.2659806
</td>
<td style="text-align:right;">
0.2434613
</td>
<td style="text-align:right;">
0.1236785
</td>
<td style="text-align:right;">
0.2097071
</td>
<td style="text-align:right;">
0.0874539
</td>
<td style="text-align:right;">
0.0004373
</td>
<td style="text-align:right;">
0.0757373
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8590981
</td>
<td style="text-align:right;">
0.1749078
</td>
<td style="text-align:right;">
0.1382767
</td>
<td style="text-align:right;">
0.3443063
</td>
<td style="text-align:right;">
0.1855177
</td>
<td style="text-align:right;">
0.1855177
</td>
<td style="text-align:right;">
0.1156906
</td>
<td style="text-align:right;">
0.0004373
</td>
<td style="text-align:right;">
0.1071087
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8403484
</td>
<td style="text-align:right;">
0.1899539
</td>
<td style="text-align:right;">
0.1172421
</td>
<td style="text-align:right;">
0.3074113
</td>
<td style="text-align:right;">
0.1310806
</td>
<td style="text-align:right;">
0.3074113
</td>
<td style="text-align:right;">
0.1550967
</td>
<td style="text-align:right;">
0.0004145
</td>
<td style="text-align:right;">
0.1172421
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.8494772
</td>
<td style="text-align:right;">
0.1543033
</td>
<td style="text-align:right;">
0.1482498
</td>
<td style="text-align:right;">
0.3423684
</td>
<td style="text-align:right;">
0.1419384
</td>
<td style="text-align:right;">
0.2495417
</td>
<td style="text-align:right;">
0.1543033
</td>
<td style="text-align:right;">
0.0004280
</td>
<td style="text-align:right;">
0.0956949
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.7687060
</td>
<td style="text-align:right;">
0.2048366
</td>
<td style="text-align:right;">
0.1024183
</td>
<td style="text-align:right;">
0.4730499
</td>
<td style="text-align:right;">
0.1254363
</td>
<td style="text-align:right;">
0.2804841
</td>
<td style="text-align:right;">
0.1672484
</td>
<td style="text-align:right;">
0.0004181
</td>
<td style="text-align:right;">
0.1024183
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.7380098
</td>
<td style="text-align:right;">
0.0836974
</td>
<td style="text-align:right;">
0.0418487
</td>
<td style="text-align:right;">
0.4808049
</td>
<td style="text-align:right;">
0.2330037
</td>
<td style="text-align:right;">
0.3695977
</td>
<td style="text-align:right;">
0.1449681
</td>
<td style="text-align:right;">
0.0418487
</td>
<td style="text-align:right;">
0.0418487
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.6610877
</td>
<td style="text-align:right;">
0.1290994
</td>
<td style="text-align:right;">
0.0962250
</td>
<td style="text-align:right;">
0.6176418
</td>
<td style="text-align:right;">
0.1875771
</td>
<td style="text-align:right;">
0.2886751
</td>
<td style="text-align:right;">
0.1551582
</td>
<td style="text-align:right;">
0.0004303
</td>
<td style="text-align:right;">
0.1138550
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.4379278
</td>
<td style="text-align:right;">
0.1532428
</td>
<td style="text-align:right;">
0.0989178
</td>
<td style="text-align:right;">
0.4597285
</td>
<td style="text-align:right;">
0.4886180
</td>
<td style="text-align:right;">
0.4639657
</td>
<td style="text-align:right;">
0.3096617
</td>
<td style="text-align:right;">
0.0004424
</td>
<td style="text-align:right;">
0.1170411
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2068350
</td>
<td style="text-align:right;">
0.1266601
</td>
<td style="text-align:right;">
0.0007313
</td>
<td style="text-align:right;">
0.0731272
</td>
<td style="text-align:right;">
0.1462544
</td>
<td style="text-align:right;">
0.6290642
</td>
<td style="text-align:right;">
0.4795273
</td>
<td style="text-align:right;">
0.3869529
</td>
<td style="text-align:right;">
0.3728771
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2321035
</td>
<td style="text-align:right;">
0.2659080
</td>
<td style="text-align:right;">
0.0580259
</td>
<td style="text-align:right;">
0.0005803
</td>
<td style="text-align:right;">
0.1160518
</td>
<td style="text-align:right;">
0.3230744
</td>
<td style="text-align:right;">
0.3935506
</td>
<td style="text-align:right;">
0.6938885
</td>
<td style="text-align:right;">
0.3432857
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2898854
</td>
<td style="text-align:right;">
0.2425355
</td>
<td style="text-align:right;">
0.0006482
</td>
<td style="text-align:right;">
0.0006482
</td>
<td style="text-align:right;">
0.1833396
</td>
<td style="text-align:right;">
0.2825453
</td>
<td style="text-align:right;">
0.2750094
</td>
<td style="text-align:right;">
0.7447291
</td>
<td style="text-align:right;">
0.3368164
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2700309
</td>
<td style="text-align:right;">
0.2700309
</td>
<td style="text-align:right;">
0.1020621
</td>
<td style="text-align:right;">
0.0721688
</td>
<td style="text-align:right;">
0.1443376
</td>
<td style="text-align:right;">
0.3145764
</td>
<td style="text-align:right;">
0.2282177
</td>
<td style="text-align:right;">
0.7107801
</td>
<td style="text-align:right;">
0.4018188
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2478577
</td>
<td style="text-align:right;">
0.1545664
</td>
<td style="text-align:right;">
0.0584206
</td>
<td style="text-align:right;">
0.0584206
</td>
<td style="text-align:right;">
0.1847422
</td>
<td style="text-align:right;">
0.2106386
</td>
<td style="text-align:right;">
0.2478577
</td>
<td style="text-align:right;">
0.8546200
</td>
<td style="text-align:right;">
0.1937593
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3248146
</td>
<td style="text-align:right;">
0.2246301
</td>
<td style="text-align:right;">
0.0677285
</td>
<td style="text-align:right;">
0.0006773
</td>
<td style="text-align:right;">
0.1915652
</td>
<td style="text-align:right;">
0.2952218
</td>
<td style="text-align:right;">
0.2534170
</td>
<td style="text-align:right;">
0.7722241
</td>
<td style="text-align:right;">
0.2346185
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2852296
</td>
<td style="text-align:right;">
0.0823387
</td>
<td style="text-align:right;">
0.0582223
</td>
<td style="text-align:right;">
0.1164445
</td>
<td style="text-align:right;">
0.1841149
</td>
<td style="text-align:right;">
0.2792241
</td>
<td style="text-align:right;">
0.2730866
</td>
<td style="text-align:right;">
0.8088494
</td>
<td style="text-align:right;">
0.2328890
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3429972
</td>
<td style="text-align:right;">
0.2018018
</td>
<td style="text-align:right;">
0.0672673
</td>
<td style="text-align:right;">
0.1165103
</td>
<td style="text-align:right;">
0.2127178
</td>
<td style="text-align:right;">
0.2853909
</td>
<td style="text-align:right;">
0.2690691
</td>
<td style="text-align:right;">
0.7786751
</td>
<td style="text-align:right;">
0.1345346
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5352097
</td>
<td style="text-align:right;">
0.2111798
</td>
<td style="text-align:right;">
0.1095758
</td>
<td style="text-align:right;">
0.3415232
</td>
<td style="text-align:right;">
0.4517927
</td>
<td style="text-align:right;">
0.4182788
</td>
<td style="text-align:right;">
0.3313261
</td>
<td style="text-align:right;">
0.0585707
</td>
<td style="text-align:right;">
0.2191516
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5737044
</td>
<td style="text-align:right;">
0.1038815
</td>
<td style="text-align:right;">
0.0848189
</td>
<td style="text-align:right;">
0.1529094
</td>
<td style="text-align:right;">
0.5997601
</td>
<td style="text-align:right;">
0.3522793
</td>
<td style="text-align:right;">
0.2907445
</td>
<td style="text-align:right;">
0.1199520
</td>
<td style="text-align:right;">
0.2162466
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.4653103
</td>
<td style="text-align:right;">
0.0957826
</td>
<td style="text-align:right;">
0.0741929
</td>
<td style="text-align:right;">
0.0004284
</td>
<td style="text-align:right;">
0.6088039
</td>
<td style="text-align:right;">
0.4672778
</td>
<td style="text-align:right;">
0.3583857
</td>
<td style="text-align:right;">
0.1133315
</td>
<td style="text-align:right;">
0.1962960
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.4419417
</td>
<td style="text-align:right;">
0.0441942
</td>
<td style="text-align:right;">
0.0441942
</td>
<td style="text-align:right;">
0.0004419
</td>
<td style="text-align:right;">
0.6091746
</td>
<td style="text-align:right;">
0.3977475
</td>
<td style="text-align:right;">
0.2651650
</td>
<td style="text-align:right;">
0.1082532
</td>
<td style="text-align:right;">
0.4352621
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2714482
</td>
<td style="text-align:right;">
0.1777046
</td>
<td style="text-align:right;">
0.0010260
</td>
<td style="text-align:right;">
0.1450952
</td>
<td style="text-align:right;">
0.1777046
</td>
<td style="text-align:right;">
0.6324552
</td>
<td style="text-align:right;">
0.3244427
</td>
<td style="text-align:right;">
0.1450952
</td>
<td style="text-align:right;">
0.5619512
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2041239
</td>
<td style="text-align:right;">
0.1666664
</td>
<td style="text-align:right;">
0.0011785
</td>
<td style="text-align:right;">
0.0011785
</td>
<td style="text-align:right;">
0.1178510
</td>
<td style="text-align:right;">
0.5400610
</td>
<td style="text-align:right;">
0.3118043
</td>
<td style="text-align:right;">
0.1666664
</td>
<td style="text-align:right;">
0.7071058
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3162276
</td>
<td style="text-align:right;">
0.3354100
</td>
<td style="text-align:right;">
0.1118033
</td>
<td style="text-align:right;">
0.0011180
</td>
<td style="text-align:right;">
0.2236067
</td>
<td style="text-align:right;">
0.4330124
</td>
<td style="text-align:right;">
0.3872981
</td>
<td style="text-align:right;">
0.1118033
</td>
<td style="text-align:right;">
0.6123721
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.1170411
</td>
<td style="text-align:right;">
0.1655211
</td>
<td style="text-align:right;">
0.1170411
</td>
<td style="text-align:right;">
0.0011704
</td>
<td style="text-align:right;">
0.1170411
</td>
<td style="text-align:right;">
0.3511232
</td>
<td style="text-align:right;">
0.5234236
</td>
<td style="text-align:right;">
0.2340821
</td>
<td style="text-align:right;">
0.6924243
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.2652740
</td>
<td style="text-align:right;">
0.8050760
</td>
<td style="text-align:right;">
0.0006086
</td>
<td style="text-align:right;">
0.0860662
</td>
<td style="text-align:right;">
0.0006086
</td>
<td style="text-align:right;">
0.3548602
</td>
<td style="text-align:right;">
0.3800583
</td>
<td style="text-align:right;">
0.0608580
</td>
<td style="text-align:right;">
0.0006086
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.2683280
</td>
<td style="text-align:right;">
0.6899273
</td>
<td style="text-align:right;">
0.3346639
</td>
<td style="text-align:right;">
0.0632455
</td>
<td style="text-align:right;">
0.0006325
</td>
<td style="text-align:right;">
0.3794732
</td>
<td style="text-align:right;">
0.4195234
</td>
<td style="text-align:right;">
0.0006325
</td>
<td style="text-align:right;">
0.1264911
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3984092
</td>
<td style="text-align:right;">
0.7237463
</td>
<td style="text-align:right;">
0.4424555
</td>
<td style="text-align:right;">
0.0007274
</td>
<td style="text-align:right;">
0.0007274
</td>
<td style="text-align:right;">
0.1028688
</td>
<td style="text-align:right;">
0.3252998
</td>
<td style="text-align:right;">
0.0007274
</td>
<td style="text-align:right;">
0.0727392
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3865551
</td>
<td style="text-align:right;">
0.7618780
</td>
<td style="text-align:right;">
0.4082477
</td>
<td style="text-align:right;">
0.0007581
</td>
<td style="text-align:right;">
0.0007581
</td>
<td style="text-align:right;">
0.0007581
</td>
<td style="text-align:right;">
0.3216333
</td>
<td style="text-align:right;">
0.0007581
</td>
<td style="text-align:right;">
0.0007581
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4257771
</td>
<td style="text-align:right;">
0.7608850
</td>
<td style="text-align:right;">
0.4188534
</td>
<td style="text-align:right;">
0.0007647
</td>
<td style="text-align:right;">
0.0007647
</td>
<td style="text-align:right;">
0.0764718
</td>
<td style="text-align:right;">
0.2418251
</td>
<td style="text-align:right;">
0.0007647
</td>
<td style="text-align:right;">
0.0007647
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3872979
</td>
<td style="text-align:right;">
0.7786196
</td>
<td style="text-align:right;">
0.4183295
</td>
<td style="text-align:right;">
0.0007906
</td>
<td style="text-align:right;">
0.0007906
</td>
<td style="text-align:right;">
0.1118033
</td>
<td style="text-align:right;">
0.2371705
</td>
<td style="text-align:right;">
0.0007906
</td>
<td style="text-align:right;">
0.0007906
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3689097
</td>
<td style="text-align:right;">
0.7882260
</td>
<td style="text-align:right;">
0.4485342
</td>
<td style="text-align:right;">
0.0007692
</td>
<td style="text-align:right;">
0.0007692
</td>
<td style="text-align:right;">
0.0769230
</td>
<td style="text-align:right;">
0.1884221
</td>
<td style="text-align:right;">
0.0007692
</td>
<td style="text-align:right;">
0.0007692
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4692366
</td>
<td style="text-align:right;">
0.7167707
</td>
<td style="text-align:right;">
0.4593568
</td>
<td style="text-align:right;">
0.0006773
</td>
<td style="text-align:right;">
0.0006773
</td>
<td style="text-align:right;">
0.0006773
</td>
<td style="text-align:right;">
0.2346183
</td>
<td style="text-align:right;">
0.0006773
</td>
<td style="text-align:right;">
0.0006773
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4230980
</td>
<td style="text-align:right;">
0.8164956
</td>
<td style="text-align:right;">
0.3142693
</td>
<td style="text-align:right;">
0.0007857
</td>
<td style="text-align:right;">
0.0007857
</td>
<td style="text-align:right;">
0.1924499
</td>
<td style="text-align:right;">
0.1360826
</td>
<td style="text-align:right;">
0.0007857
</td>
<td style="text-align:right;">
0.0007857
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3700061
</td>
<td style="text-align:right;">
0.8091729
</td>
<td style="text-align:right;">
0.3535531
</td>
<td style="text-align:right;">
0.0007715
</td>
<td style="text-align:right;">
0.0007715
</td>
<td style="text-align:right;">
0.1091088
</td>
<td style="text-align:right;">
0.2558829
</td>
<td style="text-align:right;">
0.0007715
</td>
<td style="text-align:right;">
0.0771516
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.1856951
</td>
<td style="text-align:right;">
0.9059180
</td>
<td style="text-align:right;">
0.3619864
</td>
<td style="text-align:right;">
0.0008305
</td>
<td style="text-align:right;">
0.0008305
</td>
<td style="text-align:right;">
0.0830454
</td>
<td style="text-align:right;">
0.0830454
</td>
<td style="text-align:right;">
0.0008305
</td>
<td style="text-align:right;">
0.0008305
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4457296
</td>
<td style="text-align:right;">
0.8338836
</td>
<td style="text-align:right;">
0.0008138
</td>
<td style="text-align:right;">
0.0008138
</td>
<td style="text-align:right;">
0.0008138
</td>
<td style="text-align:right;">
0.2441361
</td>
<td style="text-align:right;">
0.2153078
</td>
<td style="text-align:right;">
0.0008138
</td>
<td style="text-align:right;">
0.0008138
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3673813
</td>
<td style="text-align:right;">
0.8435963
</td>
<td style="text-align:right;">
0.3229462
</td>
<td style="text-align:right;">
0.0007833
</td>
<td style="text-align:right;">
0.0007833
</td>
<td style="text-align:right;">
0.0783259
</td>
<td style="text-align:right;">
0.2072310
</td>
<td style="text-align:right;">
0.0007833
</td>
<td style="text-align:right;">
0.0007833
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3813846
</td>
<td style="text-align:right;">
0.8348461
</td>
<td style="text-align:right;">
0.3481549
</td>
<td style="text-align:right;">
0.0007785
</td>
<td style="text-align:right;">
0.0007785
</td>
<td style="text-align:right;">
0.1100962
</td>
<td style="text-align:right;">
0.1556996
</td>
<td style="text-align:right;">
0.0007785
</td>
<td style="text-align:right;">
0.0007785
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3887960
</td>
<td style="text-align:right;">
0.8317803
</td>
<td style="text-align:right;">
0.3656782
</td>
<td style="text-align:right;">
0.0007625
</td>
<td style="text-align:right;">
0.0007625
</td>
<td style="text-align:right;">
0.1524983
</td>
<td style="text-align:right;">
0.0007625
</td>
<td style="text-align:right;">
0.0007625
</td>
<td style="text-align:right;">
0.0007625
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3077932
</td>
<td style="text-align:right;">
0.8271693
</td>
<td style="text-align:right;">
0.4412895
</td>
<td style="text-align:right;">
0.0007255
</td>
<td style="text-align:right;">
0.0007255
</td>
<td style="text-align:right;">
0.1025977
</td>
<td style="text-align:right;">
0.1256560
</td>
<td style="text-align:right;">
0.0007255
</td>
<td style="text-align:right;">
0.0007255
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3883782
</td>
<td style="text-align:right;">
0.8119214
</td>
<td style="text-align:right;">
0.3171095
</td>
<td style="text-align:right;">
0.0007474
</td>
<td style="text-align:right;">
0.0007474
</td>
<td style="text-align:right;">
0.1830833
</td>
<td style="text-align:right;">
0.2363595
</td>
<td style="text-align:right;">
0.0007474
</td>
<td style="text-align:right;">
0.0007474
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4314739
</td>
<td style="text-align:right;">
0.7293240
</td>
<td style="text-align:right;">
0.4495855
</td>
<td style="text-align:right;">
0.0007293
</td>
<td style="text-align:right;">
0.0007293
</td>
<td style="text-align:right;">
0.0007293
</td>
<td style="text-align:right;">
0.2824660
</td>
<td style="text-align:right;">
0.0007293
</td>
<td style="text-align:right;">
0.0007293
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3896564
</td>
<td style="text-align:right;">
0.7657586
</td>
<td style="text-align:right;">
0.2288141
</td>
<td style="text-align:right;">
0.0007236
</td>
<td style="text-align:right;">
0.0007236
</td>
<td style="text-align:right;">
0.3689517
</td>
<td style="text-align:right;">
0.2707365
</td>
<td style="text-align:right;">
0.0007236
</td>
<td style="text-align:right;">
0.0007236
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4359414
</td>
<td style="text-align:right;">
0.6793656
</td>
<td style="text-align:right;">
0.2605248
</td>
<td style="text-align:right;">
0.0006727
</td>
<td style="text-align:right;">
0.0006727
</td>
<td style="text-align:right;">
0.4756511
</td>
<td style="text-align:right;">
0.2330205
</td>
<td style="text-align:right;">
0.0006727
</td>
<td style="text-align:right;">
0.0006727
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4090604
</td>
<td style="text-align:right;">
0.6184412
</td>
<td style="text-align:right;">
0.3457191
</td>
<td style="text-align:right;">
0.0006312
</td>
<td style="text-align:right;">
0.0006312
</td>
<td style="text-align:right;">
0.5166545
</td>
<td style="text-align:right;">
0.2524776
</td>
<td style="text-align:right;">
0.0006312
</td>
<td style="text-align:right;">
0.0006312
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3980585
</td>
<td style="text-align:right;">
0.5783655
</td>
<td style="text-align:right;">
0.2517543
</td>
<td style="text-align:right;">
0.0593391
</td>
<td style="text-align:right;">
0.0005934
</td>
<td style="text-align:right;">
0.6166695
</td>
<td style="text-align:right;">
0.2446612
</td>
<td style="text-align:right;">
0.0005934
</td>
<td style="text-align:right;">
0.0005934
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.3072792
</td>
<td style="text-align:right;">
0.8666441
</td>
<td style="text-align:right;">
0.1604713
</td>
<td style="text-align:right;">
0.0655121
</td>
<td style="text-align:right;">
0.0006551
</td>
<td style="text-align:right;">
0.2929792
</td>
<td style="text-align:right;">
0.1965364
</td>
<td style="text-align:right;">
0.0006551
</td>
<td style="text-align:right;">
0.0006551
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.6166694
</td>
<td style="text-align:right;">
0.5263031
</td>
<td style="text-align:right;">
0.5263031
</td>
<td style="text-align:right;">
0.0685188
</td>
<td style="text-align:right;">
0.0006852
</td>
<td style="text-align:right;">
0.2055565
</td>
<td style="text-align:right;">
0.1370376
</td>
<td style="text-align:right;">
0.0006852
</td>
<td style="text-align:right;">
0.0006852
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.8514685
</td>
<td style="text-align:right;">
0.4183296
</td>
<td style="text-align:right;">
0.0007906
</td>
<td style="text-align:right;">
0.0790569
</td>
<td style="text-align:right;">
0.0007906
</td>
<td style="text-align:right;">
0.2622020
</td>
<td style="text-align:right;">
0.1118033
</td>
<td style="text-align:right;">
0.0007906
</td>
<td style="text-align:right;">
0.1118033
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.5943573
</td>
<td style="text-align:right;">
0.1950473
</td>
<td style="text-align:right;">
0.7390502
</td>
<td style="text-align:right;">
0.0521286
</td>
<td style="text-align:right;">
0.0005213
</td>
<td style="text-align:right;">
0.1950473
</td>
<td style="text-align:right;">
0.1474419
</td>
<td style="text-align:right;">
0.0005213
</td>
<td style="text-align:right;">
0.0005213
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.7013808
</td>
<td style="text-align:right;">
0.1719589
</td>
<td style="text-align:right;">
0.6434113
</td>
<td style="text-align:right;">
0.0518476
</td>
<td style="text-align:right;">
0.0005185
</td>
<td style="text-align:right;">
0.2199706
</td>
<td style="text-align:right;">
0.1159347
</td>
<td style="text-align:right;">
0.0005185
</td>
<td style="text-align:right;">
0.0005185
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.7227351
</td>
<td style="text-align:right;">
0.1494870
</td>
<td style="text-align:right;">
0.6342195
</td>
<td style="text-align:right;">
0.1057033
</td>
<td style="text-align:right;">
0.0005285
</td>
<td style="text-align:right;">
0.1752890
</td>
<td style="text-align:right;">
0.0915417
</td>
<td style="text-align:right;">
0.0005285
</td>
<td style="text-align:right;">
0.0528516
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.7236550
</td>
<td style="text-align:right;">
0.1396374
</td>
<td style="text-align:right;">
0.5224752
</td>
<td style="text-align:right;">
0.3031863
</td>
<td style="text-align:right;">
0.0005278
</td>
<td style="text-align:right;">
0.2300538
</td>
<td style="text-align:right;">
0.1750447
</td>
<td style="text-align:right;">
0.0005278
</td>
<td style="text-align:right;">
0.0914141
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.6691129
</td>
<td style="text-align:right;">
0.1714985
</td>
<td style="text-align:right;">
0.6314211
</td>
<td style="text-align:right;">
0.2061156
</td>
<td style="text-align:right;">
0.0005717
</td>
<td style="text-align:right;">
0.2425355
</td>
<td style="text-align:right;">
0.1143324
</td>
<td style="text-align:right;">
0.0005717
</td>
<td style="text-align:right;">
0.0990147
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.6392478
</td>
<td style="text-align:right;">
0.2881952
</td>
<td style="text-align:right;">
0.4991687
</td>
<td style="text-align:right;">
0.4196185
</td>
<td style="text-align:right;">
0.0005764
</td>
<td style="text-align:right;">
0.2445417
</td>
<td style="text-align:right;">
0.1152781
</td>
<td style="text-align:right;">
0.0576390
</td>
<td style="text-align:right;">
0.0815139
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.6217350
</td>
<td style="text-align:right;">
0.1833397
</td>
<td style="text-align:right;">
0.3643804
</td>
<td style="text-align:right;">
0.5469548
</td>
<td style="text-align:right;">
0.0004100
</td>
<td style="text-align:right;">
0.3067859
</td>
<td style="text-align:right;">
0.2319084
</td>
<td style="text-align:right;">
0.0004100
</td>
<td style="text-align:right;">
0.0004100
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.5618384
</td>
<td style="text-align:right;">
0.2139699
</td>
<td style="text-align:right;">
0.4578629
</td>
<td style="text-align:right;">
0.4834612
</td>
<td style="text-align:right;">
0.0004909
</td>
<td style="text-align:right;">
0.3865197
</td>
<td style="text-align:right;">
0.2139699
</td>
<td style="text-align:right;">
0.0004909
</td>
<td style="text-align:right;">
0.0004909
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.7091008
</td>
<td style="text-align:right;">
0.2254936
</td>
<td style="text-align:right;">
0.5207552
</td>
<td style="text-align:right;">
0.0007516
</td>
<td style="text-align:right;">
0.0007516
</td>
<td style="text-align:right;">
0.3444472
</td>
<td style="text-align:right;">
0.1503291
</td>
<td style="text-align:right;">
0.1841148
</td>
<td style="text-align:right;">
0.0007516
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4256280
</td>
<td style="text-align:right;">
0.3806932
</td>
<td style="text-align:right;">
0.2823296
</td>
<td style="text-align:right;">
0.2085143
</td>
<td style="text-align:right;">
0.0008513
</td>
<td style="text-align:right;">
0.3806932
</td>
<td style="text-align:right;">
0.3185108
</td>
<td style="text-align:right;">
0.5516769
</td>
<td style="text-align:right;">
0.0008513
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4554199
</td>
<td style="text-align:right;">
0.5741336
</td>
<td style="text-align:right;">
0.3103163
</td>
<td style="text-align:right;">
0.0006086
</td>
<td style="text-align:right;">
0.0006086
</td>
<td style="text-align:right;">
0.3800583
</td>
<td style="text-align:right;">
0.3103163
</td>
<td style="text-align:right;">
0.0608580
</td>
<td style="text-align:right;">
0.3496028
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4826535
</td>
<td style="text-align:right;">
0.2261334
</td>
<td style="text-align:right;">
0.3107907
</td>
<td style="text-align:right;">
0.2717786
</td>
<td style="text-align:right;">
0.0007538
</td>
<td style="text-align:right;">
0.4767312
</td>
<td style="text-align:right;">
0.3370998
</td>
<td style="text-align:right;">
0.2919370
</td>
<td style="text-align:right;">
0.3454245
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4472135
</td>
<td style="text-align:right;">
0.1804387
</td>
<td style="text-align:right;">
0.2362497
</td>
<td style="text-align:right;">
0.1181249
</td>
<td style="text-align:right;">
0.0006820
</td>
<td style="text-align:right;">
0.5540547
</td>
<td style="text-align:right;">
0.2893456
</td>
<td style="text-align:right;">
0.2261919
</td>
<td style="text-align:right;">
0.5057804
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.5340939
</td>
<td style="text-align:right;">
0.1698415
</td>
<td style="text-align:right;">
0.1497861
</td>
<td style="text-align:right;">
0.0800641
</td>
<td style="text-align:right;">
0.0005661
</td>
<td style="text-align:right;">
0.4935480
</td>
<td style="text-align:right;">
0.3797772
</td>
<td style="text-align:right;">
0.1877669
</td>
<td style="text-align:right;">
0.4837089
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.5644707
</td>
<td style="text-align:right;">
0.4142082
</td>
<td style="text-align:right;">
0.0007001
</td>
<td style="text-align:right;">
0.1212678
</td>
<td style="text-align:right;">
0.0007001
</td>
<td style="text-align:right;">
0.4200838
</td>
<td style="text-align:right;">
0.3770368
</td>
<td style="text-align:right;">
0.0700140
</td>
<td style="text-align:right;">
0.4142082
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.4264012
</td>
<td style="text-align:right;">
0.4954335
</td>
<td style="text-align:right;">
0.2860386
</td>
<td style="text-align:right;">
0.0953462
</td>
<td style="text-align:right;">
0.0009535
</td>
<td style="text-align:right;">
0.2860386
</td>
<td style="text-align:right;">
0.3437757
</td>
<td style="text-align:right;">
0.4954335
</td>
<td style="text-align:right;">
0.1906924
</td>
</tr>
</tbody>
</table>
</div>
<div id="computation-of-dissimilarity" class="section level3">
<h3 class="hasAnchor">
<a href="#computation-of-dissimilarity" class="anchor"></a>Computation of dissimilarity</h3>
<p>The computation of dissimlarity between two sequences requires several steps.</p>
<p><strong>1. Computation of a distance matrix</strong> among the samples of both sequences. It is computed by the <strong>distanceMatrix</strong> function, which allows the user to select a distance metric (so far the ones implemented are <em>manhattan</em>, <em>euclidean</em>, <em>chi</em>, and <em>hellinger</em>). The function <strong>plotMatrix</strong> allows an easy visualization of the distance matrix.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#computing distance matrix</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">AB.distance.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/distanceMatrix.html">distanceMatrix</a></span>(</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="dt">sequences =</span> AB.sequences,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">"manhattan"</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#plotting distance matrix</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw"><a href="reference/plotMatrix.html">plotMatrix</a></span>(</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">  <span class="dt">distance.matrix =</span> AB.distance.matrix,</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">  <span class="dt">color.palette =</span> <span class="st">"viridis"</span>)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-7-1.png" alt="Distance matrix of two irregular and unaligned multivariate sequences. Warmer colors indicate higher distance." width="100%"><p class="caption">
Distance matrix of two irregular and unaligned multivariate sequences. Warmer colors indicate higher distance.
</p>
</div>
<p><strong>2. Computation of the least-cost matrix within the distance matrix.</strong> This step uses a <em>dynamic programming algorithm</em> to find the least-cost when moving between the cell 1,1 of the matrix (lower left in the image above) and the last cell of the matrix (opposite corner). It does so by solving first every partial solution (in the neighborhood of every cell in the matrix), and then propagating the sum towards the opposite extreme of the matrix.</p>
<p>The value of the upper-right cell in the plotted matrix (actually, the lower-right cell in the actual data matrix, the matrix is rotated in the plot) is the sum of the minimum distance across all samples of both time-series.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">AB.least.cost.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/leastCostMatrix.html">leastCostMatrix</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="dt">distance.matrix =</span> AB.distance.matrix</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="reference/plotMatrix.html">plotMatrix</a></span>(</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">  <span class="dt">distance.matrix =</span> AB.least.cost.matrix,</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  <span class="dt">color.palette =</span> <span class="st">"viridis"</span>)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-8-1.png" alt="Least cumulative cost of moving between the lower-left cell and the upper-right cell. The value of the upper-right cell corresponds with the minimized sum of distances between the samples of both sequences." width="100%"><p class="caption">
Least cumulative cost of moving between the lower-left cell and the upper-right cell. The value of the upper-right cell corresponds with the minimized sum of distances between the samples of both sequences.
</p>
</div>
<p><strong>Optional</strong> In this optional step, the function <strong>leastCostPath</strong> finds the least-cost path in the matrix above. It returns a dataframe with the coordinates of the cells within the path, the distance between consecutive cells, and the cumulative distance of any given step in the path. It can be used to plot the path, which helps to better understand the alignmnet between both sequences.</p>
<p>This dataframe will be used later on to generate other products, such the <em>slotting</em> of both sequences (a unique sequences with the samples of both sequences in the order that minimizes the distance between consecutive samples), or to transfer attributes such as age/time/depth from one sequence with them to another without them. <strong>Note: these applications are not yet implemented</strong>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">AB.least.cost.path &lt;-<span class="st"> </span><span class="kw"><a href="reference/leastCostPath.html">leastCostPath</a></span>(</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="dt">distance.matrix =</span> AB.distance.matrix,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="dt">least.cost.matrix =</span> AB.least.cost.matrix</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  )</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB.least.cost.path)</a></code></pre></div>
<table class="table table kable_wrapper"><tbody><tr>
<td>
<table class="table table">
<thead><tr>
<th style="text-align:right;">
A
</th>
<th style="text-align:right;">
B
</th>
<th style="text-align:right;">
distance
</th>
<th style="text-align:right;">
cumulative.distance
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
2.0263492
</td>
<td style="text-align:right;">
77.494336
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
1.7065276
</td>
<td style="text-align:right;">
74.399857
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
1.0443439
</td>
<td style="text-align:right;">
72.693329
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
0.9960874
</td>
<td style="text-align:right;">
71.648985
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.0369063
</td>
<td style="text-align:right;">
70.652898
</td>
</tr>
<tr>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
0.9765942
</td>
<td style="text-align:right;">
69.615992
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.3499953
</td>
<td style="text-align:right;">
68.639397
</td>
</tr>
<tr>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.3158191
</td>
<td style="text-align:right;">
67.289402
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.4081556
</td>
<td style="text-align:right;">
65.973583
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.3128237
</td>
<td style="text-align:right;">
64.565427
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
1.5519266
</td>
<td style="text-align:right;">
63.252603
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
1.2133734
</td>
<td style="text-align:right;">
61.700677
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
1.6275515
</td>
<td style="text-align:right;">
60.487304
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.7976067
</td>
<td style="text-align:right;">
58.859752
</td>
</tr>
<tr>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.2858805
</td>
<td style="text-align:right;">
57.062145
</td>
</tr>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.5742973
</td>
<td style="text-align:right;">
55.776265
</td>
</tr>
<tr>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.4749082
</td>
<td style="text-align:right;">
54.201968
</td>
</tr>
<tr>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.6983496
</td>
<td style="text-align:right;">
52.727059
</td>
</tr>
<tr>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.4428394
</td>
<td style="text-align:right;">
51.028710
</td>
</tr>
<tr>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.6166027
</td>
<td style="text-align:right;">
49.585870
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.4730527
</td>
<td style="text-align:right;">
47.969268
</td>
</tr>
<tr>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.9813520
</td>
<td style="text-align:right;">
46.496215
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.9216889
</td>
<td style="text-align:right;">
44.514863
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
2.2909173
</td>
<td style="text-align:right;">
42.593174
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
1.3451792
</td>
<td style="text-align:right;">
40.302257
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
1.1371053
</td>
<td style="text-align:right;">
38.957077
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
0.8279288
</td>
<td style="text-align:right;">
37.819972
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
1.0698217
</td>
<td style="text-align:right;">
36.992044
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
0.8223396
</td>
<td style="text-align:right;">
35.922222
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
0.9538965
</td>
<td style="text-align:right;">
35.099882
</td>
</tr>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
1.0290695
</td>
<td style="text-align:right;">
34.145986
</td>
</tr>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
1.0087909
</td>
<td style="text-align:right;">
33.116916
</td>
</tr>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0.7399160
</td>
<td style="text-align:right;">
32.108125
</td>
</tr>
<tr>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0.8302675
</td>
<td style="text-align:right;">
31.368209
</td>
</tr>
<tr>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0.9006972
</td>
<td style="text-align:right;">
30.537942
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0.7312452
</td>
<td style="text-align:right;">
29.637245
</td>
</tr>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0.6111244
</td>
<td style="text-align:right;">
28.905999
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0.6857977
</td>
<td style="text-align:right;">
28.294875
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0.4593697
</td>
<td style="text-align:right;">
27.609077
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0.5281708
</td>
<td style="text-align:right;">
27.149708
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0.3953405
</td>
<td style="text-align:right;">
26.621537
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0.4491373
</td>
<td style="text-align:right;">
26.226196
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0.4692097
</td>
<td style="text-align:right;">
25.777059
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0.4695962
</td>
<td style="text-align:right;">
25.307849
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0.4281177
</td>
<td style="text-align:right;">
24.838253
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0.4738617
</td>
<td style="text-align:right;">
24.410135
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0.4129465
</td>
<td style="text-align:right;">
23.936274
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0.5993883
</td>
<td style="text-align:right;">
23.523327
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0.7922915
</td>
<td style="text-align:right;">
22.923939
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0.7214991
</td>
<td style="text-align:right;">
22.131647
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.4759934
</td>
<td style="text-align:right;">
21.410148
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.5574024
</td>
<td style="text-align:right;">
20.934155
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.6010333
</td>
<td style="text-align:right;">
20.376752
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
0.8712908
</td>
<td style="text-align:right;">
19.775719
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1.0541302
</td>
<td style="text-align:right;">
18.904428
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0.9654721
</td>
<td style="text-align:right;">
17.850298
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0.8089721
</td>
<td style="text-align:right;">
16.884826
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0.8187776
</td>
<td style="text-align:right;">
16.075854
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0.7563793
</td>
<td style="text-align:right;">
15.257076
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.5938869
</td>
<td style="text-align:right;">
14.500697
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.5861491
</td>
<td style="text-align:right;">
13.906810
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.6119543
</td>
<td style="text-align:right;">
13.320661
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.5480622
</td>
<td style="text-align:right;">
12.708707
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.5093333
</td>
<td style="text-align:right;">
12.160645
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.4881477
</td>
<td style="text-align:right;">
11.651311
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.3791765
</td>
<td style="text-align:right;">
11.163164
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0.3394337
</td>
<td style="text-align:right;">
10.783987
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0.2909565
</td>
<td style="text-align:right;">
10.444553
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.2267188
</td>
<td style="text-align:right;">
10.153597
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.2544728
</td>
<td style="text-align:right;">
9.926878
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.4331815
</td>
<td style="text-align:right;">
9.672405
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.4161701
</td>
<td style="text-align:right;">
9.239224
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.6620557
</td>
<td style="text-align:right;">
8.823054
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.4992449
</td>
<td style="text-align:right;">
8.160998
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.3096328
</td>
<td style="text-align:right;">
7.661753
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.3288486
</td>
<td style="text-align:right;">
7.352120
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.3224920
</td>
<td style="text-align:right;">
7.023272
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.5778002
</td>
<td style="text-align:right;">
6.700780
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.7251007
</td>
<td style="text-align:right;">
6.122979
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.3379461
</td>
<td style="text-align:right;">
5.397879
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.3153405
</td>
<td style="text-align:right;">
5.059933
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.5225844
</td>
<td style="text-align:right;">
4.744592
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.4376354
</td>
<td style="text-align:right;">
4.222008
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.3150628
</td>
<td style="text-align:right;">
3.784372
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.3254672
</td>
<td style="text-align:right;">
3.469310
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.5054572
</td>
<td style="text-align:right;">
3.143842
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.5394488
</td>
<td style="text-align:right;">
2.638385
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.0308067
</td>
<td style="text-align:right;">
2.098936
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.0681297
</td>
<td style="text-align:right;">
1.068130
</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody></table>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="reference/plotMatrix.html">plotMatrix</a></span>(</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="dt">distance.matrix =</span> AB.distance.matrix,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  <span class="dt">least.cost.path =</span> AB.least.cost.path,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  <span class="dt">color.palette =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">100</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">  )</a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-9-1.png" alt="least-cost path plotted on top of the distance matrix." width="100%"><p class="caption">
least-cost path plotted on top of the distance matrix.
</p>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="reference/plotMatrix.html">plotMatrix</a></span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  <span class="dt">distance.matrix =</span> AB.least.cost.matrix,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="dt">least.cost.path =</span> AB.least.cost.path,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">color.palette =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">100</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  )</a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-10-1.png" alt="Least-cost path plotted on top of the least-cost matrix." width="100%"><p class="caption">
Least-cost path plotted on top of the least-cost matrix.
</p>
</div>
<p><strong>3. Getting the least-cost value.</strong> The Upper right cell of the least-cost matrix in the image of the least-cost matrix (lower right cell in the actual data-matrix) holds the cumulative sum of the least-cost path. This value will be used later to compute dissimilarity.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">AB.least.cost &lt;-<span class="st"> </span><span class="kw"><a href="reference/leastCost.html">leastCost</a></span>(</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">  <span class="dt">least.cost.matrix =</span> AB.least.cost.matrix</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  )</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">AB.least.cost</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; [1] 77.49434</span></a></code></pre></div>
<p><strong>4. Autosum, or sum of the distances among adjacent samples on each sequence.</strong> This is another requirement to compute a normalized measure of dissimilarity. It just computes the distance between adjacent samples of each sequence and sums them up. Notice that the output is a list with named slots. Lists are the main output device of this package, I’ll explain later why.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">AB.autosum &lt;-<span class="st"> </span><span class="kw"><a href="reference/autoSum.html">autoSum</a></span>(</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">  <span class="dt">sequences =</span> AB.sequences,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">  <span class="dt">method =</span> <span class="st">"manhattan"</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">  )</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">AB.autosum</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; $A</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; [1] 22.64307</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt; $B</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; [1] 24.19666</span></a></code></pre></div>
<p><strong>5. Compute dissimilarity.</strong> The dissimilarity measure used in this package is named <strong>psi</strong>, that was first described in the book <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/gea.3340010406">“Numerical methods in Quaternary pollen analysis”</a> (Birks and Gordon, 1985). <strong>Psi</strong> is computed as follows:</p>
<p><span class="math display">\[\psi = \frac{LC - (\sum{A_{i-j}} + \sum{B_{i-j}})}{\sum{A_{i-j}} + \sum{B_{i-j}}} \]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(LC\)</span> is the least-cost computed by <strong>leastCostMatrix</strong>.</li>
<li>
<span class="math inline">\(\sum{A_{i-j}}\)</span> is the autosum of one of the sequences.</li>
<li>
<span class="math inline">\(\sum{B_{i-j}}\)</span> is the autosum of the other sequence.</li>
</ul>
<p>Which basically is the least-cost normalizado by the autosum of both sequences. The <strong>psi</strong> function only requires the least cost, and the autosum of both sequences, as follows. Notice that in the output list, the slot with the psi value is named after the two sequences separated by a vertical line (“A|B”). This convention will be followed by any function in the package that returns objects resulting from comparing two sequences.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">AB.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/psi.html">psi</a></span>(</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  <span class="dt">least.cost =</span> AB.least.cost,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  <span class="dt">autosum =</span> AB.autosum)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">AB.psi</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; $`A|B`</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; [1] 2.308914</span></a></code></pre></div>
<p>The output of <strong>psi</strong> is a list, that can be transformed to a dataframe or a matrix by using the <strong>formatPsi</strong> function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co">#to dataframe</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">AB.psi.dataframe &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">  <span class="dt">psi.values =</span> AB.psi,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"dataframe"</span>)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">AB.psi.dataframe</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt;   A B      psi</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; 1 A B 2.308914</span></a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">#to matrix</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">AB.psi.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  <span class="dt">psi.values =</span> AB.psi,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"matrix"</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">AB.psi.matrix</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt;          A        B</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; A 0.000000 2.308914</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt; B 2.308914 0.000000</span></a></code></pre></div>
<p>Or can also be transformed from matrix to dataframe, or from dataframe to matrix, as convenient.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">#from matrix to dataframe again</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">AB.psi.dataframe &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">  <span class="dt">psi.values =</span> AB.psi.matrix,</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"dataframe"</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">AB.psi.dataframe</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt;   A B      psi</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt; 1 A B 2.308914</span></a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">#or from dataframe to matrix</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">AB.psi.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  <span class="dt">psi.values =</span> AB.psi.dataframe,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"matrix"</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">AB.psi.matrix</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt;          A        B</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt; A 0.000000 2.308914</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; B 2.308914 0.000000</span></a></code></pre></div>
<p>All the steps required to compute <strong>psi</strong>, including the format options provided by <strong>formatPsi</strong> are wrapped together in the function <strong>workflowPsi</strong>, that works as follows:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">AB.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowPsi.html">workflowPsi</a></span>(</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">  <span class="dt">sequences =</span> AB.sequences,</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">  <span class="dt">format =</span> <span class="st">"dataframe"</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">AB.psi</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt;   A B      psi</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt; 1 A B 2.308914</span></a></code></pre></div>
</div>
</div>
</div>
<div id="workflow-to-compare-multiple-sequences" class="section level1">
<h1 class="hasAnchor">
<a href="#workflow-to-compare-multiple-sequences" class="anchor"></a>Workflow to compare multiple sequences</h1>
<p>The package can work seamlessly with any given number of sequences, as long as there is memory enough available. To do so, almost every function uses the package <a href="https://cran.r-project.org/web/packages/foreach/index.html">“foreach”</a>, that allows to parallelize the execution of the functions by using all the processors in your machine but one. This speeds up operations considerably.</p>
<div id="preparing-the-data-1" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-the-data-1" class="anchor"></a>Preparing the data</h2>
<p>The example dataset <em>sequencesMIS</em> contains 12 sections of the same sequence belonging to different marine isotopic stages identified by a column named “MIS”. MIS stages with odd numbers are interglacials, while the odd ones are glacials.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sequencesMIS)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sequencesMIS, <span class="dt">n=</span><span class="dv">15</span>))</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
MIS
</th>
<th style="text-align:right;">
Quercus
</th>
<th style="text-align:right;">
Betula
</th>
<th style="text-align:right;">
Pinus
</th>
<th style="text-align:right;">
Alnus
</th>
<th style="text-align:right;">
Tilia
</th>
<th style="text-align:right;">
Carpinus
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(sequencesMIS<span class="op">$</span>MIS)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co">#&gt;  [1] "MIS-1"  "MIS-2"  "MIS-3"  "MIS-4"  "MIS-5"  "MIS-6"  "MIS-7" </span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">#&gt;  [8] "MIS-8"  "MIS-9"  "MIS-10" "MIS-11" "MIS-12"</span></a></code></pre></div>
<p>The dataset is checked and prepared with <strong>prepareSequences</strong> (note the change in the argument <em>grouping.column</em>).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">MIS.sequences &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">  <span class="dt">sequences =</span> sequencesMIS,</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"MIS"</span>,</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">  <span class="dt">if.empty.cases =</span> <span class="st">"zero"</span>,</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">  <span class="dt">transformation =</span> <span class="st">"hellinger"</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6">)</a></code></pre></div>
<p>The dissimilarity measure <strong>psi</strong> can be computed for every combination of sequences through the function <strong>workflowPsi</strong> shown below. Note the argument <em>output</em> that allows to select either “dataframe” (ordered from lower to higher dissimilarity) or “matrix” to obtain an output with a given structure (if empty, the function returns a list).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">MIS.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowPsi.html">workflowPsi</a></span>(</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">  <span class="dt">sequences =</span> MIS.sequences,</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"MIS"</span>,</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">  <span class="dt">exclude.columns =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">  <span class="dt">diagonal =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb23-8" data-line-number="8">  <span class="dt">format =</span> <span class="st">"dataframe"</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb23-10" data-line-number="10"></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#ordered with lower psi on top</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(MIS.psi[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(MIS.psi<span class="op">$</span>psi), ])</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
psi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
65
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.4667271
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.5432846
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:right;">
0.5602375
</td>
</tr>
<tr>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.5636762
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.5699145
</td>
</tr>
<tr>
<td style="text-align:left;">
61
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.5773947
</td>
</tr>
<tr>
<td style="text-align:left;">
59
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.5838916
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:right;">
0.5877742
</td>
</tr>
<tr>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.5952427
</td>
</tr>
<tr>
<td style="text-align:left;">
60
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.6006657
</td>
</tr>
<tr>
<td style="text-align:left;">
63
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.6267211
</td>
</tr>
<tr>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.6508910
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:right;">
0.6860092
</td>
</tr>
<tr>
<td style="text-align:left;">
53
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.6873591
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.6984544
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.7235294
</td>
</tr>
<tr>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.7284802
</td>
</tr>
<tr>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.7366078
</td>
</tr>
<tr>
<td style="text-align:left;">
56
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.7384163
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.7449421
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
0.7628389
</td>
</tr>
<tr>
<td style="text-align:left;">
57
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.7639236
</td>
</tr>
<tr>
<td style="text-align:left;">
47
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
0.7647820
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.7758922
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.7868523
</td>
</tr>
<tr>
<td style="text-align:left;">
40
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
0.7902516
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.7912034
</td>
</tr>
<tr>
<td style="text-align:left;">
54
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.8145817
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.8206587
</td>
</tr>
<tr>
<td style="text-align:left;">
49
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.8257413
</td>
</tr>
<tr>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.8454800
</td>
</tr>
<tr>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.8889213
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.9059018
</td>
</tr>
<tr>
<td style="text-align:left;">
48
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.9506625
</td>
</tr>
<tr>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.9557674
</td>
</tr>
<tr>
<td style="text-align:left;">
55
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.9617040
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.9897336
</td>
</tr>
<tr>
<td style="text-align:left;">
52
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
1.0050436
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.0623644
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
1.0803557
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
1.1242697
</td>
</tr>
<tr>
<td style="text-align:left;">
50
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
1.1711241
</td>
</tr>
<tr>
<td style="text-align:left;">
46
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.2169510
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
1.2674807
</td>
</tr>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
1.2965870
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
1.4514057
</td>
</tr>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
1.4626439
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
1.4676454
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
1.4862577
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.7298180
</td>
</tr>
<tr>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
1.8146561
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
1.8200446
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.8870057
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
1.8990660
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.9890602
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
1.9980010
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
2.0262821
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
2.0382396
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
2.1064514
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
2.1596580
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
2.1720497
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:right;">
2.4299782
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
2.7390103
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
2.7447849
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:right;">
2.7456533
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:right;">
2.7725373
</td>
</tr>
</tbody>
</table>
<p>A dataframe like this can be plotted as an adjacency network with the <strong>qgraph</strong> package as follows:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co">#psi values to matrix</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">MIS.psi.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">  <span class="dt">psi.values =</span> MIS.psi,</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"matrix"</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb24-6" data-line-number="6"></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">#dissimilariy to distance</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8">MIS.distance &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>MIS.psi.matrix<span class="op">**</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">#plotting network</span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11">qgraph<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/qgraph/topics/qgraph">qgraph</a></span>(MIS.distance, </a>
<a class="sourceLine" id="cb24-12" data-line-number="12">       <span class="dt">layout=</span><span class="st">'spring'</span>, </a>
<a class="sourceLine" id="cb24-13" data-line-number="13">       <span class="dt">vsize=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb24-14" data-line-number="14">       <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(MIS.distance),</a>
<a class="sourceLine" id="cb24-15" data-line-number="15">       <span class="dt">colors =</span> viridis<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">2</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">direction =</span> <span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb24-16" data-line-number="16">       )</a>
<a class="sourceLine" id="cb24-17" data-line-number="17"><span class="co">#&gt; Warning in qgraph::qgraph(MIS.distance, layout = "spring", vsize =</span></a>
<a class="sourceLine" id="cb24-18" data-line-number="18"><span class="co">#&gt; 5, labels = colnames(MIS.distance), : The following arguments are not</span></a>
<a class="sourceLine" id="cb24-19" data-line-number="19"><span class="co">#&gt; documented and likely not arguments of qgraph and thus ignored: colors</span></a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-22-1.png" alt="Similarity between MIS sequences represented as a network. More similar sites are closer, and linked by a wider edge. Note that glacials are colored in blue and interglacials in green" width="100%"><p class="caption">
Similarity between MIS sequences represented as a network. More similar sites are closer, and linked by a wider edge. Note that glacials are colored in blue and interglacials in green
</p>
</div>
<p>Or as a matrix with <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co">#ordering factors to get a triangular matrix</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2">MIS.psi<span class="op">$</span>A &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(MIS.psi<span class="op">$</span>A, <span class="dt">levels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(sequencesMIS<span class="op">$</span>MIS))</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">MIS.psi<span class="op">$</span>B &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(MIS.psi<span class="op">$</span>B, <span class="dt">levels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(sequencesMIS<span class="op">$</span>MIS))</a>
<a class="sourceLine" id="cb25-4" data-line-number="4"></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="co">#plotting matrix</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="dt">data=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/na.fail">na.omit</a></span>(MIS.psi), <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>A, <span class="dt">y=</span>B, <span class="dt">size=</span>psi, <span class="dt">color=</span>psi)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="st">  </span>viridis<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/scale_viridis">scale_color_viridis</a></span>(<span class="dt">direction =</span> <span class="dv">-1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/guides">guides</a></span>(<span class="dt">size =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-23-1.png" alt="Dissimilarity between MIS sequences." width="100%"><p class="caption">
Dissimilarity between MIS sequences.
</p>
</div>
<p>The dataframe of dissimilarities between pairs of sequences can be also used to analyze the drivers of dissimilarity. To do so, attributes such as differences in time (when sequences represent different times) or distance (when sequences represent different sites) between sequences, or differences between physical/climatic attributes between sequences such as topography or climate can be added to the table, so models such as <span class="math inline">\(psi = A + B + C\)</span> (were A, B, and C are these attributes) can be fitted.</p>
</div>
</div>
<div id="working-with-aligned-multivariate-time-series" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-aligned-multivariate-time-series" class="anchor"></a>Working with aligned multivariate time-series</h1>
<p>This section assumes that the target multivariate time-series have the same number of samples/rows, and samples have the same time/depth/order if there is a time/age/depth column available. In this particular case, distances are computed only between samples with the same time/depth/order, and no distance matrix (nor least cost analysis) is required. When the argument <em>paired.samples</em> in <strong>prepareSequences</strong> is set to TRUE, the function checks if the sequences have the same number of rows, and, if <em>time.column</em> is provided, it selects the samples that have valid time/depth columns for every sequence in the dataset.</p>
<p>Here we test these ideas with the <strong>climate</strong> dataset included in the library. It represents simulated palaeoclimate over 200 ky. at four sites identified by the column <em>sequenceId</em>. Note that this time the transformation applied is “scaled”, which uses the <strong>scale</strong> function of R base to center and scale the data.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co">#loading sample data</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(climate)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co">#preparing sequences</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5">climate &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb26-8" data-line-number="8">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb26-9" data-line-number="9">  <span class="dt">paired.samples =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb26-10" data-line-number="10">  <span class="dt">transformation =</span> <span class="st">"scale"</span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11">  )</a></code></pre></div>
<p>The function <strong>distancePairedSamples</strong> computes the between paired samples</p>
<p>The result is a list, each slot named as the id of the given sequence according to <em>grouping.columns</em>, and containing a vector with pairwise distances. Each vector position is named after <em>time.column</em> if available.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">climate.distances &lt;-<span class="st"> </span><span class="kw"><a href="reference/distancePairedSamples.html">distancePairedSamples</a></span>(</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">  <span class="dt">exclude.columns =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">  <span class="dt">sum.distances =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb27-9" data-line-number="9"></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(climate.distances)</a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="co">#&gt; List of 6</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="co">#&gt;  $ 1|2: Named num [1:200] 6.13 6.15 5.76 4.97 4.04 ...</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="co">#&gt;  $ 1|3: Named num [1:200] 2.354 1.681 1.404 0.906 1.043 ...</span></a>
<a class="sourceLine" id="cb27-15" data-line-number="15"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb27-16" data-line-number="16"><span class="co">#&gt;  $ 1|4: Named num [1:200] 6.56 6.82 6.79 6.07 5.04 ...</span></a>
<a class="sourceLine" id="cb27-17" data-line-number="17"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb27-18" data-line-number="18"><span class="co">#&gt;  $ 2|3: Named num [1:200] 5.76 5.75 5.21 4.52 4.19 ...</span></a>
<a class="sourceLine" id="cb27-19" data-line-number="19"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb27-20" data-line-number="20"><span class="co">#&gt;  $ 2|4: Named num [1:200] 0.432 0.667 1.025 1.161 1.449 ...</span></a>
<a class="sourceLine" id="cb27-21" data-line-number="21"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb27-22" data-line-number="22"><span class="co">#&gt;  $ 3|4: Named num [1:200] 5.92 6.39 6.23 5.63 4.88 ...</span></a>
<a class="sourceLine" id="cb27-23" data-line-number="23"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a></code></pre></div>
<p>If the argument <em>sum.distances</em> is set to TRUE, it sums them up, doing in fact the same work done by <strong>distanceMatrix</strong>, <strong>leastCostMatrix</strong> and <strong>leastCost</strong> at once.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">climate.distances &lt;-<span class="st"> </span><span class="kw"><a href="reference/distancePairedSamples.html">distancePairedSamples</a></span>(</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">  <span class="dt">exclude.columns =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb28-7" data-line-number="7">  <span class="dt">sum.distances =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb28-9" data-line-number="9">climate.distances</a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="co">#&gt; $`1|2`</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="co">#&gt; [1] 859.1105</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="co">#&gt; $`1|3`</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14"><span class="co">#&gt; [1] 712.0338</span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="co">#&gt; $`1|4`</span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17"><span class="co">#&gt; [1] 1034.932</span></a>
<a class="sourceLine" id="cb28-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-19" data-line-number="19"><span class="co">#&gt; $`2|3`</span></a>
<a class="sourceLine" id="cb28-20" data-line-number="20"><span class="co">#&gt; [1] 819.8022</span></a>
<a class="sourceLine" id="cb28-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-22" data-line-number="22"><span class="co">#&gt; $`2|4`</span></a>
<a class="sourceLine" id="cb28-23" data-line-number="23"><span class="co">#&gt; [1] 669.1838</span></a>
<a class="sourceLine" id="cb28-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-25" data-line-number="25"><span class="co">#&gt; $`3|4`</span></a>
<a class="sourceLine" id="cb28-26" data-line-number="26"><span class="co">#&gt; [1] 755.5203</span></a></code></pre></div>
<p>Computing <em>psi</em> from there only requires the autosum of each sequence, and the application of the <strong>psi</strong> function.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co">#computing autosum</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">climate.autosum &lt;-<span class="st"> </span><span class="kw"><a href="reference/autoSum.html">autoSum</a></span>(</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb29-8" data-line-number="8"></a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="co">#computing psi</span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10">climate.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/psi.html">psi</a></span>(</a>
<a class="sourceLine" id="cb29-11" data-line-number="11">  <span class="dt">least.cost =</span> climate.distances,</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">  <span class="dt">autosum =</span> climate.autosum</a>
<a class="sourceLine" id="cb29-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb29-14" data-line-number="14"></a>
<a class="sourceLine" id="cb29-15" data-line-number="15">climate.psi</a>
<a class="sourceLine" id="cb29-16" data-line-number="16"><span class="co">#&gt; $`1|2`</span></a>
<a class="sourceLine" id="cb29-17" data-line-number="17"><span class="co">#&gt; [1] 3.378791</span></a>
<a class="sourceLine" id="cb29-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb29-19" data-line-number="19"><span class="co">#&gt; $`1|3`</span></a>
<a class="sourceLine" id="cb29-20" data-line-number="20"><span class="co">#&gt; [1] 2.767909</span></a>
<a class="sourceLine" id="cb29-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb29-22" data-line-number="22"><span class="co">#&gt; $`1|4`</span></a>
<a class="sourceLine" id="cb29-23" data-line-number="23"><span class="co">#&gt; [1] 4.043498</span></a>
<a class="sourceLine" id="cb29-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb29-25" data-line-number="25"><span class="co">#&gt; $`2|3`</span></a>
<a class="sourceLine" id="cb29-26" data-line-number="26"><span class="co">#&gt; [1] 3.761143</span></a>
<a class="sourceLine" id="cb29-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb29-28" data-line-number="28"><span class="co">#&gt; $`2|4`</span></a>
<a class="sourceLine" id="cb29-29" data-line-number="29"><span class="co">#&gt; [1] 2.551667</span></a>
<a class="sourceLine" id="cb29-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb29-31" data-line-number="31"><span class="co">#&gt; $`3|4`</span></a>
<a class="sourceLine" id="cb29-32" data-line-number="32"><span class="co">#&gt; [1] 3.169788</span></a></code></pre></div>
<p>These functions are wrapped together in the function <strong>workflowPsiPaired</strong>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">climate.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowPsiPairedSamples.html">workflowPsiPairedSamples</a></span>(</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">  <span class="dt">format =</span> <span class="st">"dataframe"</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(climate.psi)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
psi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
3.378792
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
2.767909
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
4.043498
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
3.761143
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
2.551667
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
3.169788
</td>
</tr>
</tbody>
</table>
</div>
<div id="variable-contribution-to-dissimilarity" class="section level1">
<h1 class="hasAnchor">
<a href="#variable-contribution-to-dissimilarity" class="anchor"></a>Variable contribution to dissimilarity</h1>
<p>The dissimilarity measure <em>psi</em> is computed from the common columns of two datasets. But the partial contribution of given columns to <em>psi</em> can be computed, in order to answer questions such as “what columns/variables make the sequences more similar/different?”</p>
</div>
<div id="finding-the-section-in-a-long-sequence-more-similar-to-a-given-short-sequence" class="section level1">
<h1 class="hasAnchor">
<a href="#finding-the-section-in-a-long-sequence-more-similar-to-a-given-short-sequence" class="anchor"></a>Finding the section in a long sequence more similar to a given short sequence</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Blas M. Benito <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Blas M. Benito.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
