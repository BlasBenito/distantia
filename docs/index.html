<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assessing Dissimilarity Between Multivariate Time Series • distantia</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Assessing Dissimilarity Between Multivariate Time Series">
<meta property="og:description" content='Provides tools to assess the dissimilarity between multivariate time-series. It is based on the psi measure described in "Numerical methods in Quaternary pollen analysis" (Birks and Gordon, 1985 &lt;doi:10.1002/jqs.3390020110&gt;), which computes dissimilarity constrained by sample order, but the original idea has been extended to work with any kind of multivariate time-series, no matter whether they are regular, irregular, aligned or unaligned. Furthermore, the package allows to assess the significance of dissimilarity values by applying a restricted permutation test, allows to measure the contribution of individual variables to dissimilarity, and offers tools to transfer attributes (generally time or age, but other are possible) between sequences based on the similarity of their samples.'>
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">distantia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="index_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<!-- badges: start -->
<!-- badges: end -->
<p>The package <strong>distantia</strong> allows to measure the dissimilarity between multivariate time-series (<em>sequences</em> hereafter). The package assumes that the target sequences are ordered along a given dimension, being depth and time the most common ones, but others such as latitude or elevation are also suitable. Furthermore, the target sequences can be regular or irregular, and have their samples aligned (same age/time/depth) or unaligned (different age/time/depth). The only requirement is that the sequences must have at least two (but ideally more) columns with the same name and units.</p>
<p>In this document I briefly explain the logics behind the method, show how to use it, and demonstrate how the <strong>distantia</strong> package introduces useful tools to compare multivariate time-series. The topics covered in this document are:</p>
<ul>
<li>Installation of the package.</li>
<li>Comparing two irregular non-aligned sequences.</li>
<li>Comparing multiple irregular non-aligned sequences.</li>
<li>Comparing regular aligned sequences.</li>
<li>Restricted permutation test to assess the significance of dissimilarity values.</li>
<li>Assessing the contribution of a variable to the dissimilarity between two sequences.</li>
<li>Finding the section in a long sequence more similar to a given short sequence (irregular sequences).</li>
<li>Finding the section in a long sequence more similar to a given short sequence (regular sequences).</li>
<li>Sequence slotting: combining samples of two sequences into a single composite sequence.</li>
<li>Tranferring an attribute from one sequence to another: direct and interpolated modes.</li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of distantia from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"distantia"</span>)</a></code></pre></div>
<p>And the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"devtools"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(devtools)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"BlasBenito/distantia"</span>)</a></code></pre></div>
<p>Loading the library, plus other helper libraries:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(distantia)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(viridis)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(kableExtra)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(qgraph)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)</a></code></pre></div>
</div>
<div id="comparing-two-irregular-non-aligned-sequences" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-two-irregular-non-aligned-sequences" class="anchor"></a>Comparing two irregular non-aligned sequences</h2>
<p>This section assumes that the user wants to compare two sequences. The package provides two example datasets based on the Abernethy pollen core (Birks and Mathewes, 1978):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sequenceA)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sequenceB)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(sequenceA)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; 'data.frame':    49 obs. of  9 variables:</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;  $ betula: int  79 113 51 130 31 59 78 71 140 150 ...</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;  $ pinus : int  271 320 420 470 450 425 386 397 310 323 ...</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;  $ corylu: int  36 42 39 6 6 12 29 52 50 34 ...</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;  $ junipe: int  0 0 0 0 0 0 2 2 2 2 ...</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  $ empetr: int  4 4 2 0 3 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  $ gramin: int  7 3 1 2 2 2 0 6 4 11 ...</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  $ cypera: int  25 11 12 4 3 3 2 3 3 2 ...</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  $ artemi: int  0 0 0 0 0 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  $ rumex : int  0 0 0 0 0 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(sequenceB)</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; 'data.frame':    41 obs. of  8 variables:</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;  $ betula: int  19 18 30 26 31 24 23 48 29 23 ...</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;  $ pinus : int  175 119 99 101 99 97 105 112 108 110 ...</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;  $ corylu: int  NA 28 37 29 30 28 34 46 16 21 ...</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;  $ junipe: int  2 1 0 0 0 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt;  $ gramin: int  34 36 2 0 1 2 1 0 6 2 ...</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt;  $ cypera: int  39 44 20 18 10 9 6 12 3 11 ...</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt;  $ artemi: int  1 0 0 0 0 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt;  $ rumex : int  0 4 1 0 0 0 0 0 0 1 ...</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(sequenceA[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ], <span class="dt">caption =</span> <span class="st">"Sequence A"</span>)</a></code></pre></div>
<table class="table table">
<caption>
Sequence A
</caption>
<thead><tr>
<th style="text-align:right;">
betula
</th>
<th style="text-align:right;">
pinus
</th>
<th style="text-align:right;">
corylu
</th>
<th style="text-align:right;">
junipe
</th>
<th style="text-align:right;">
empetr
</th>
<th style="text-align:right;">
gramin
</th>
<th style="text-align:right;">
cypera
</th>
<th style="text-align:right;">
artemi
</th>
<th style="text-align:right;">
rumex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
271
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
320
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
470
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
450
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
425
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
386
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
397
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
310
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
323
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
317
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
181
</td>
<td style="text-align:right;">
345
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
153
</td>
<td style="text-align:right;">
285
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
214
</td>
<td style="text-align:right;">
315
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
210
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(sequenceB[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ], <span class="dt">caption =</span> <span class="st">"Sequence B"</span>)</a></code></pre></div>
<table class="table table">
<caption>
Sequence B
</caption>
<thead><tr>
<th style="text-align:right;">
betula
</th>
<th style="text-align:right;">
pinus
</th>
<th style="text-align:right;">
corylu
</th>
<th style="text-align:right;">
junipe
</th>
<th style="text-align:right;">
gramin
</th>
<th style="text-align:right;">
cypera
</th>
<th style="text-align:right;">
artemi
</th>
<th style="text-align:right;">
rumex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Notice that <strong>sequenceB</strong> has a few NA values (that were introduced to serve as an example). The function <strong>prepareSequences</strong> gets them ready for analysis by matching colum names and handling empty data. It allows to merge two (or more) multivariate time-series into a single table ready for further analyses. Note that, since the data represents pollen abundances, a <em>Hellinger</em> transformation (square root of the relative proportions of each taxa) is applied.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/help">help</a></span>(prepareSequences)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">AB.sequences &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">sequence.A =</span> sequenceA,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="dt">sequence.A.name =</span> <span class="st">"A"</span>,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="dt">sequence.B =</span> sequenceB,</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  <span class="dt">sequence.B.name =</span> <span class="st">"B"</span>,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="dt">merge.mode =</span> <span class="st">"complete"</span>,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  <span class="dt">if.empty.cases =</span> <span class="st">"zero"</span>,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  <span class="dt">transformation =</span> <span class="st">"hellinger"</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB.sequences[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ], <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
betula
</th>
<th style="text-align:right;">
pinus
</th>
<th style="text-align:right;">
corylu
</th>
<th style="text-align:right;">
junipe
</th>
<th style="text-align:right;">
empetr
</th>
<th style="text-align:right;">
gramin
</th>
<th style="text-align:right;">
cypera
</th>
<th style="text-align:right;">
artemi
</th>
<th style="text-align:right;">
rumex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.4327
</td>
<td style="text-align:right;">
0.8014
</td>
<td style="text-align:right;">
0.2921
</td>
<td style="text-align:right;">
0.0002
</td>
<td style="text-align:right;">
0.0974
</td>
<td style="text-align:right;">
0.1288
</td>
<td style="text-align:right;">
0.2434
</td>
<td style="text-align:right;">
2e-04
</td>
<td style="text-align:right;">
0.0002
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.4788
</td>
<td style="text-align:right;">
0.8057
</td>
<td style="text-align:right;">
0.2919
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0901
</td>
<td style="text-align:right;">
0.0780
</td>
<td style="text-align:right;">
0.1494
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3117
</td>
<td style="text-align:right;">
0.8944
</td>
<td style="text-align:right;">
0.2726
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0617
</td>
<td style="text-align:right;">
0.0436
</td>
<td style="text-align:right;">
0.1512
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.4609
</td>
<td style="text-align:right;">
0.8763
</td>
<td style="text-align:right;">
0.0990
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0572
</td>
<td style="text-align:right;">
0.0808
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.2503
</td>
<td style="text-align:right;">
0.9535
</td>
<td style="text-align:right;">
0.1101
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0778
</td>
<td style="text-align:right;">
0.0636
</td>
<td style="text-align:right;">
0.0778
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3432
</td>
<td style="text-align:right;">
0.9210
</td>
<td style="text-align:right;">
0.1548
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0632
</td>
<td style="text-align:right;">
0.0774
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3962
</td>
<td style="text-align:right;">
0.8813
</td>
<td style="text-align:right;">
0.2416
</td>
<td style="text-align:right;">
0.0634
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0634
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.3657
</td>
<td style="text-align:right;">
0.8647
</td>
<td style="text-align:right;">
0.3129
</td>
<td style="text-align:right;">
0.0614
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.1063
</td>
<td style="text-align:right;">
0.0752
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5245
</td>
<td style="text-align:right;">
0.7804
</td>
<td style="text-align:right;">
0.3134
</td>
<td style="text-align:right;">
0.0627
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.0886
</td>
<td style="text-align:right;">
0.0768
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5361
</td>
<td style="text-align:right;">
0.7866
</td>
<td style="text-align:right;">
0.2552
</td>
<td style="text-align:right;">
0.0619
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.1452
</td>
<td style="text-align:right;">
0.0619
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5667
</td>
<td style="text-align:right;">
0.7627
</td>
<td style="text-align:right;">
0.2606
</td>
<td style="text-align:right;">
0.0606
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.1421
</td>
<td style="text-align:right;">
0.0742
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5650
</td>
<td style="text-align:right;">
0.7800
</td>
<td style="text-align:right;">
0.2222
</td>
<td style="text-align:right;">
0.0727
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.1111
</td>
<td style="text-align:right;">
0.0727
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5599
</td>
<td style="text-align:right;">
0.7642
</td>
<td style="text-align:right;">
0.2716
</td>
<td style="text-align:right;">
0.0640
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.1280
</td>
<td style="text-align:right;">
0.0784
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0453
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.5952
</td>
<td style="text-align:right;">
0.7222
</td>
<td style="text-align:right;">
0.2990
</td>
<td style="text-align:right;">
0.0575
</td>
<td style="text-align:right;">
0.0407
</td>
<td style="text-align:right;">
0.1467
</td>
<td style="text-align:right;">
0.0910
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.6516
</td>
<td style="text-align:right;">
0.6677
</td>
<td style="text-align:right;">
0.2950
</td>
<td style="text-align:right;">
0.1129
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.1457
</td>
<td style="text-align:right;">
0.0922
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
</tbody>
</table>
<p>The computation of dissimlarity between two sequences requires several steps.</p>
<p><strong>1. Computation of a distance matrix</strong> among the samples of both sequences. It is computed by the <strong>distanceMatrix</strong> function, which allows the user to select a distance metric (so far the ones implemented are <em>manhattan</em>, <em>euclidean</em>, <em>chi</em>, and <em>hellinger</em>). The function <strong>plotMatrix</strong> allows an easy visualization of the distance matrix.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#computing distance matrix</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">AB.distance.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/distanceMatrix.html">distanceMatrix</a></span>(</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="dt">sequences =</span> AB.sequences,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">"manhattan"</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#plotting distance matrix</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw"><a href="reference/plotMatrix.html">plotMatrix</a></span>(</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">  <span class="dt">distance.matrix =</span> AB.distance.matrix,</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">  <span class="dt">color.palette =</span> <span class="st">"viridis"</span>)</a></code></pre></div>
<p><strong>2. Computation of the least-cost path within the distance matrix.</strong> This step uses a <em>dynamic programming algorithm</em> to find the least-cost when moving between the cell 1,1 of the matrix (lower left in the image above) and the last cell of the matrix (opposite corner). It does so by solving first every partial solution (in the neighborhood of every cell in the matrix), and then propagating the sum towards the opposite extreme of the matrix.</p>
<p>The value of the upper-right cell in the plotted matrix (actually, the lower-right cell in the actual data matrix, the matrix is rotated in the plot) is the sum of the minimum distance across all samples of both time-series.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">AB.least.cost.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/leastCostMatrix.html">leastCostMatrix</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="dt">distance.matrix =</span> AB.distance.matrix</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="reference/plotMatrix.html">plotMatrix</a></span>(</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">  <span class="dt">distance.matrix =</span> AB.least.cost.matrix,</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  <span class="dt">color.palette =</span> <span class="st">"viridis"</span>)</a></code></pre></div>
<p><strong>Optional</strong> In this optional step, the function <strong>leastCostPath</strong> finds the least-cost path in the matrix above. It returns a dataframe with the coordinates of the cells within the path, the distance between consecutive cells, and the cumulative distance of any given step in the path. It can be used to plot the path, which helps to better understand the alignmnet between both sequences.</p>
<p>This dataframe will be used later on to generate other products, such the <em>slotting</em> of both sequences (a unique sequences with the samples of both sequences in the order that minimizes the distance between consecutive samples), or to transfer attributes such as age/time/depth from one sequence with them to another without them. <strong>Note: these applications are not yet implemented</strong>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">AB.least.cost.path &lt;-<span class="st"> </span><span class="kw"><a href="reference/leastCostPath.html">leastCostPath</a></span>(</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="dt">distance.matrix =</span> AB.distance.matrix,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="dt">least.cost.matrix =</span> AB.least.cost.matrix</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  )</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB.least.cost.path[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ], <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:right;">
A
</th>
<th style="text-align:right;">
B
</th>
<th style="text-align:right;">
distance
</th>
<th style="text-align:right;">
cumulative.distance
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
2.0278
</td>
<td style="text-align:right;">
77.5398
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
1.7083
</td>
<td style="text-align:right;">
74.4425
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
1.0461
</td>
<td style="text-align:right;">
72.7342
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
0.9972
</td>
<td style="text-align:right;">
71.6881
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.0389
</td>
<td style="text-align:right;">
70.6909
</td>
</tr>
<tr>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
0.9777
</td>
<td style="text-align:right;">
69.6520
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.3507
</td>
<td style="text-align:right;">
68.6743
</td>
</tr>
<tr>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.3165
</td>
<td style="text-align:right;">
67.3236
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.4085
</td>
<td style="text-align:right;">
66.0071
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.3132
</td>
<td style="text-align:right;">
64.5986
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
1.5524
</td>
<td style="text-align:right;">
63.2853
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
1.2139
</td>
<td style="text-align:right;">
61.7329
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
1.6284
</td>
<td style="text-align:right;">
60.5191
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.7988
</td>
<td style="text-align:right;">
58.8907
</td>
</tr>
<tr>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.2870
</td>
<td style="text-align:right;">
57.0919
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="reference/plotMatrix.html">plotMatrix</a></span>(</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="dt">distance.matrix =</span> AB.distance.matrix,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  <span class="dt">least.cost.path =</span> AB.least.cost.path,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  <span class="dt">color.palette =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">100</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">  )</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="reference/plotMatrix.html">plotMatrix</a></span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  <span class="dt">distance.matrix =</span> AB.least.cost.matrix,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="dt">least.cost.path =</span> AB.least.cost.path,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">color.palette =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">100</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  )</a></code></pre></div>
<p><strong>Optional: least cost path using diagonals</strong>.</p>
<p>The least cost path can be computed also in diagonal, which allows to pair together these samples with the higher similarity that contribute to minimize the overall cost of the least cost path.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">#computing the least cost using diagonals</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">diagonal.least.cost &lt;-<span class="st"> </span><span class="kw"><a href="reference/leastCostMatrix.html">leastCostMatrix</a></span>(</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  <span class="dt">distance.matrix =</span> AB.distance.matrix,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  <span class="dt">diagonal =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#computing least cost path using diagonals</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">diagonal.least.cost.path &lt;-<span class="st"> </span><span class="kw"><a href="reference/leastCostPath.html">leastCostPath</a></span>(</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">  <span class="dt">distance.matrix =</span> AB.distance.matrix,</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">  <span class="dt">least.cost.matrix =</span> AB.least.cost.matrix,</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">  <span class="dt">diagonal =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12">  )</a>
<a class="sourceLine" id="cb12-13" data-line-number="13"></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="kw"><a href="reference/plotMatrix.html">plotMatrix</a></span>(</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">  <span class="dt">distance.matrix =</span> diagonal.least.cost,</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">  <span class="dt">least.cost.path =</span> diagonal.least.cost.path,</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">  <span class="dt">color.palette =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">100</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">  )</a></code></pre></div>
<p>Using diagonals is useful when the goal is to transfer attributes (time, age, depth, etc) from one sequence with them to another sequence without them. This will be shown later <strong>NOTE: not implemented yet</strong>.</p>
<p><strong>3. Getting the least-cost value.</strong> The Upper right cell of the least-cost matrix in the image of the least-cost matrix (lower right cell in the actual data-matrix) holds the cumulative sum of the least-cost path. This value will be used later to compute dissimilarity.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">AB.least.cost &lt;-<span class="st"> </span><span class="kw"><a href="reference/leastCost.html">leastCost</a></span>(</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">  <span class="dt">least.cost.matrix =</span> AB.least.cost.matrix</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">  )</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">AB.least.cost</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; $`A|B`</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; [1] 77.53981</span></a></code></pre></div>
<p><strong>4. Autosum, or sum of the distances among adjacent samples on each sequence.</strong> This is another requirement to compute a normalized measure of dissimilarity. It just computes the distance between adjacent samples of each sequence and sums them up. Notice that the output is a list with named slots. Lists are the main output device of this package, I’ll explain later why.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">AB.autosum &lt;-<span class="st"> </span><span class="kw"><a href="reference/autoSum.html">autoSum</a></span>(</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  <span class="dt">sequences =</span> AB.sequences,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  <span class="dt">method =</span> <span class="st">"manhattan"</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">  )</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">AB.autosum</a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; $A</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; [1] 22.6535</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; $B</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; [1] 24.20855</span></a></code></pre></div>
<p><strong>5. Compute dissimilarity.</strong> The dissimilarity measure used in this package is named <strong>psi</strong>, that was first described in the book <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/gea.3340010406">“Numerical methods in Quaternary pollen analysis”</a> (Birks and Gordon, 1985). <strong>Psi</strong> is computed as follows:</p>
<p><span class="math display">\[\psi = \frac{LC - (\sum{A_{i-j}} + \sum{B_{i-j}})}{\sum{A_{i-j}} + \sum{B_{i-j}}} \]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(LC\)</span> is the least-cost computed by <strong>leastCostMatrix</strong>.</li>
<li>
<span class="math inline">\(\sum{A_{i-j}}\)</span> is the autosum of one of the sequences.</li>
<li>
<span class="math inline">\(\sum{B_{i-j}}\)</span> is the autosum of the other sequence.</li>
</ul>
<p>Which basically is the least-cost normalizado by the autosum of both sequences. The <strong>psi</strong> function only requires the least cost, and the autosum of both sequences, as follows. Notice that in the output list, the slot with the psi value is named after the two sequences separated by a vertical line (“A|B”). This convention will be followed by any function in the package that returns objects resulting from comparing two sequences.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">AB.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/psi.html">psi</a></span>(</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  <span class="dt">least.cost =</span> AB.least.cost,</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">  <span class="dt">autosum =</span> AB.autosum</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  )</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">AB.psi</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; $`A|B`</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; [1] 2.309279</span></a></code></pre></div>
<p>The output of <strong>psi</strong> is a list, that can be transformed to a dataframe or a matrix by using the <strong>formatPsi</strong> function.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">#to dataframe</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">AB.psi.dataframe &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  <span class="dt">psi.values =</span> AB.psi,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"dataframe"</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB.psi.dataframe, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
psi
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2.3093
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">#to matrix</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">AB.psi.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">  <span class="dt">psi.values =</span> AB.psi,</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"matrix"</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB.psi.matrix, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
A
</th>
<th style="text-align:right;">
B
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
2.3093
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2.3093
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
</tbody>
</table>
<p>Or can also be transformed from matrix to dataframe, or from dataframe to matrix, as convenient.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">#from matrix to dataframe again</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">AB.psi.dataframe &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  <span class="dt">psi.values =</span> AB.psi.matrix,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"dataframe"</span>)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB.psi.dataframe, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
psi
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2.3093
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">#or from dataframe to matrix</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">AB.psi.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">  <span class="dt">psi.values =</span> AB.psi.dataframe,</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"matrix"</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB.psi.matrix, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
A
</th>
<th style="text-align:right;">
B
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
2.3093
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2.3093
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
</tbody>
</table>
<p>All the steps required to compute <strong>psi</strong>, including the format options provided by <strong>formatPsi</strong> are wrapped together in the function <strong>workflowPsi</strong>, that works as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">AB.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowPsi.html">workflowPsi</a></span>(</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">  <span class="dt">sequences =</span> AB.sequences,</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">  <span class="dt">format =</span> <span class="st">"dataframe"</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">AB.psi</a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt;   A B      psi</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; 1 A B 2.309279</span></a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co">#cleaning environment for next example</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(AB.autosum, AB.distance.matrix, AB.least.cost, AB.least.cost.matrix, AB.least.cost.path, AB.psi, AB.psi.dataframe, AB.psi.matrix, AB.sequences, sequenceA, sequenceB, diagonal.least.cost, diagonal.least.cost.path)</a></code></pre></div>
</div>
<div id="comparing-multiple-irregular-non-aligned-sequences" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#comparing-multiple-irregular-non-aligned-sequences" class="anchor"></a>Comparing multiple irregular non-aligned sequences</h1></div>
<p>The package can work seamlessly with any given number of sequences, as long as there is memory enough available. To do so, almost every function uses the package <a href="https://CRAN.R-project.org/package=foreach">“foreach”</a>, that allows to parallelize the execution of the functions by using all the processors in your machine but one. This speeds up operations considerably.</p>
<p>The example dataset <em>sequencesMIS</em> contains 12 sections of the same sequence belonging to different marine isotopic stages identified by a column named “MIS”. MIS stages with odd numbers are generally interpreted as warm periods (interglacials), while the odd ones are interpreted as cold periods (glacials). In any case, this interpretation is not important to illustrate this capability of the library.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sequencesMIS)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sequencesMIS, <span class="dt">n=</span><span class="dv">15</span>), <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
MIS
</th>
<th style="text-align:right;">
Quercus
</th>
<th style="text-align:right;">
Betula
</th>
<th style="text-align:right;">
Pinus
</th>
<th style="text-align:right;">
Alnus
</th>
<th style="text-align:right;">
Tilia
</th>
<th style="text-align:right;">
Carpinus
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(sequencesMIS<span class="op">$</span>MIS)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt;  [1] "MIS-1"  "MIS-2"  "MIS-3"  "MIS-4"  "MIS-5"  "MIS-6"  "MIS-7" </span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt;  [8] "MIS-8"  "MIS-9"  "MIS-10" "MIS-11" "MIS-12"</span></a></code></pre></div>
<p>The dataset is checked and prepared with <strong>prepareSequences</strong> (note the change in the argument <em>grouping.column</em>).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">MIS.sequences &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">  <span class="dt">sequences =</span> sequencesMIS,</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"MIS"</span>,</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">  <span class="dt">if.empty.cases =</span> <span class="st">"zero"</span>,</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">  <span class="dt">transformation =</span> <span class="st">"hellinger"</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6">)</a></code></pre></div>
<p>The dissimilarity measure <strong>psi</strong> can be computed for every combination of sequences through the function <strong>workflowPsi</strong> shown below. Note the argument <em>output</em> that allows to select either “dataframe” (ordered from lower to higher dissimilarity) or “matrix” to obtain an output with a given structure (if empty, the function returns a list).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">MIS.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowPsi.html">workflowPsi</a></span>(</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">  <span class="dt">sequences =</span> MIS.sequences,</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"MIS"</span>,</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">  <span class="dt">exclude.columns =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">  <span class="dt">diagonal =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb25-8" data-line-number="8">  <span class="dt">format =</span> <span class="st">"dataframe"</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb25-10" data-line-number="10"></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="co">#ordered with lower psi on top</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(MIS.psi[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(MIS.psi<span class="op">$</span>psi), ], <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
psi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
65
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.4656
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.5412
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:right;">
0.5560
</td>
</tr>
<tr>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.5639
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.5686
</td>
</tr>
<tr>
<td style="text-align:left;">
61
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.5772
</td>
</tr>
<tr>
<td style="text-align:left;">
59
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.5841
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:right;">
0.5843
</td>
</tr>
<tr>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.5949
</td>
</tr>
<tr>
<td style="text-align:left;">
60
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.6004
</td>
</tr>
<tr>
<td style="text-align:left;">
63
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.6266
</td>
</tr>
<tr>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.6487
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:right;">
0.6830
</td>
</tr>
<tr>
<td style="text-align:left;">
53
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.6877
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.6964
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.7231
</td>
</tr>
<tr>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.7274
</td>
</tr>
<tr>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.7361
</td>
</tr>
<tr>
<td style="text-align:left;">
56
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.7378
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.7444
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
0.7621
</td>
</tr>
<tr>
<td style="text-align:left;">
47
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
0.7630
</td>
</tr>
<tr>
<td style="text-align:left;">
57
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.7648
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.7737
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.7884
</td>
</tr>
<tr>
<td style="text-align:left;">
40
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
0.7900
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.7912
</td>
</tr>
<tr>
<td style="text-align:left;">
54
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.8147
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.8182
</td>
</tr>
<tr>
<td style="text-align:left;">
49
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.8244
</td>
</tr>
<tr>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.8452
</td>
</tr>
<tr>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
0.8882
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.9065
</td>
</tr>
<tr>
<td style="text-align:left;">
48
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
0.9500
</td>
</tr>
<tr>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.9556
</td>
</tr>
<tr>
<td style="text-align:left;">
55
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
0.9618
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
0.9874
</td>
</tr>
<tr>
<td style="text-align:left;">
52
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
1.0042
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.0658
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
1.0807
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
1.1241
</td>
</tr>
<tr>
<td style="text-align:left;">
50
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
1.1681
</td>
</tr>
<tr>
<td style="text-align:left;">
46
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.2160
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
1.2658
</td>
</tr>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
1.2964
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
1.4517
</td>
</tr>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
1.4584
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
1.4667
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
1.4832
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.7293
</td>
</tr>
<tr>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
1.8136
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
1.8177
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.8869
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-9
</td>
<td style="text-align:right;">
1.8992
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-7
</td>
<td style="text-align:right;">
1.9877
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-11
</td>
<td style="text-align:right;">
1.9949
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-8
</td>
<td style="text-align:right;">
2.0264
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
2.0409
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
2.1046
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
2.1585
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-12
</td>
<td style="text-align:right;">
2.1738
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-3
</td>
<td style="text-align:right;">
2.4295
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-10
</td>
<td style="text-align:right;">
2.7392
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
2.7452
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:right;">
2.7457
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
MIS-1
</td>
<td style="text-align:left;">
MIS-2
</td>
<td style="text-align:right;">
2.7670
</td>
</tr>
</tbody>
</table>
<p>A dataframe like this can be plotted as an adjacency network with the <strong>qgraph</strong> package as follows:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co">#psi values to matrix</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">MIS.psi.matrix &lt;-<span class="st"> </span><span class="kw"><a href="reference/formatPsi.html">formatPsi</a></span>(</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">  <span class="dt">psi.values =</span> MIS.psi,</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">  <span class="dt">to =</span> <span class="st">"matrix"</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb26-6" data-line-number="6"></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co">#dissimilariy to distance</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8">MIS.distance &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>MIS.psi.matrix<span class="op">**</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="co">#plotting network</span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11">qgraph<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/qgraph/topics/qgraph">qgraph</a></span>(MIS.distance, </a>
<a class="sourceLine" id="cb26-12" data-line-number="12">       <span class="dt">layout=</span><span class="st">'spring'</span>, </a>
<a class="sourceLine" id="cb26-13" data-line-number="13">       <span class="dt">vsize=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb26-14" data-line-number="14">       <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(MIS.distance),</a>
<a class="sourceLine" id="cb26-15" data-line-number="15">       <span class="dt">colors =</span> viridis<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">2</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">direction =</span> <span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb26-16" data-line-number="16">       )</a>
<a class="sourceLine" id="cb26-17" data-line-number="17"><span class="co">#&gt; Warning in qgraph::qgraph(MIS.distance, layout = "spring", vsize =</span></a>
<a class="sourceLine" id="cb26-18" data-line-number="18"><span class="co">#&gt; 5, labels = colnames(MIS.distance), : The following arguments are not</span></a>
<a class="sourceLine" id="cb26-19" data-line-number="19"><span class="co">#&gt; documented and likely not arguments of qgraph and thus ignored: colors</span></a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-24-1.png" alt="Similarity between MIS sequences represented as a network. More similar sites are closer, and linked by a wider edge. Note that glacials are colored in blue and interglacials in green" width="100%"><p class="caption">
Similarity between MIS sequences represented as a network. More similar sites are closer, and linked by a wider edge. Note that glacials are colored in blue and interglacials in green
</p>
</div>
<p>Or as a matrix with <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co">#ordering factors to get a triangular matrix</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">MIS.psi<span class="op">$</span>A &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(MIS.psi<span class="op">$</span>A, <span class="dt">levels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(sequencesMIS<span class="op">$</span>MIS))</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">MIS.psi<span class="op">$</span>B &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(MIS.psi<span class="op">$</span>B, <span class="dt">levels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(sequencesMIS<span class="op">$</span>MIS))</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">#plotting matrix</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/na.fail">na.omit</a></span>(MIS.psi), <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>A, <span class="dt">y=</span>B, <span class="dt">size=</span>psi, <span class="dt">color=</span>psi)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="st">  </span>viridis<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/scale_viridis">scale_color_viridis</a></span>(<span class="dt">direction =</span> <span class="dv">-1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(<span class="dt">size =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-25-1.png" alt="Dissimilarity between MIS sequences. Darker colors indicate a higher dissimilarity." width="100%"><p class="caption">
Dissimilarity between MIS sequences. Darker colors indicate a higher dissimilarity.
</p>
</div>
<p>The dataframe of dissimilarities between pairs of sequences can be also used to analyze the drivers of dissimilarity. To do so, attributes such as differences in time (when sequences represent different times) or distance (when sequences represent different sites) between sequences, or differences between physical/climatic attributes between sequences such as topography or climate can be added to the table, so models such as <span class="math inline">\(psi = A + B + C\)</span> (were A, B, and C are these attributes) can be fitted.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co">#cleaning environment for next example</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(MIS.distance, MIS.psi, MIS.psi.matrix, MIS.sequences, sequencesMIS)</a></code></pre></div>
</div>
<div id="comparing-regular-aligned-sequences" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-regular-aligned-sequences" class="anchor"></a>Comparing regular aligned sequences</h1>
<p>This section assumes that the target multivariate time-series have the same number of samples/rows, and samples have the same time/depth/order if there is a time/age/depth column available. In this particular case, distances are computed only between samples with the same time/depth/order, and no distance matrix (nor least cost analysis) is required. When the argument <em>paired.samples</em> in <strong>prepareSequences</strong> is set to TRUE, the function checks if the sequences have the same number of rows, and, if <em>time.column</em> is provided, it selects the samples that have valid time/depth columns for every sequence in the dataset.</p>
<p>Here we test these ideas with the <strong>climate</strong> dataset included in the library. It represents simulated palaeoclimate over 200 ky. at four sites identified by the column <em>sequenceId</em>. Note that this time the transformation applied is “scaled”, which uses the <strong>scale</strong> function of R base to center and scale the data.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co">#loading sample data</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(climate)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co">#preparing sequences</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">climate &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">  <span class="dt">paired.samples =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">  <span class="dt">transformation =</span> <span class="st">"scale"</span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11">  )</a></code></pre></div>
<p>The function <strong>distancePairedSamples</strong> computes the between paired samples (same order/time/age/depth), and therefore does not use the least cost algorithm to minimize the distances between sequences shown above. If the argument <em>time.column</em> is not provided, or if it’s provided but <em>same.time</em> is false, the samples are paired by their order (first sample of one sequence vs. the first sample of the other sequence, the second against the second, and so on), and samples that only have an age for one of the sequences are removed from the comparison. This is useful to compare subsets of the same sequence, or subsets of different sequences belonging to different times.</p>
<p>If there is a <em>time.column</em> and <em>same.time</em> is set to true, only samples with the same time/age/depth are compared. This is useful to compare sequences taken at the same time in different sites.</p>
<p>The result is a list, each slot named as the id of the given sequence according to <em>grouping.columns</em>, and containing a vector with pairwise distances. Each vector position is named after <em>time.column</em> if available.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">climate.distances &lt;-<span class="st"> </span><span class="kw"><a href="reference/distancePairedSamples.html">distancePairedSamples</a></span>(</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">  <span class="dt">same.time =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">  <span class="dt">exclude.columns =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb30-8" data-line-number="8">  <span class="dt">sum.distances =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb30-10" data-line-number="10"></a>
<a class="sourceLine" id="cb30-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(climate.distances)</a>
<a class="sourceLine" id="cb30-12" data-line-number="12"><span class="co">#&gt; List of 6</span></a>
<a class="sourceLine" id="cb30-13" data-line-number="13"><span class="co">#&gt;  $ 1|2: Named num [1:200] 6.13 6.15 5.76 4.97 4.04 ...</span></a>
<a class="sourceLine" id="cb30-14" data-line-number="14"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb30-15" data-line-number="15"><span class="co">#&gt;  $ 1|3: Named num [1:200] 2.354 1.681 1.404 0.906 1.043 ...</span></a>
<a class="sourceLine" id="cb30-16" data-line-number="16"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb30-17" data-line-number="17"><span class="co">#&gt;  $ 1|4: Named num [1:200] 6.56 6.82 6.79 6.07 5.04 ...</span></a>
<a class="sourceLine" id="cb30-18" data-line-number="18"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb30-19" data-line-number="19"><span class="co">#&gt;  $ 2|3: Named num [1:200] 5.76 5.75 5.21 4.52 4.19 ...</span></a>
<a class="sourceLine" id="cb30-20" data-line-number="20"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb30-21" data-line-number="21"><span class="co">#&gt;  $ 2|4: Named num [1:200] 0.432 0.667 1.025 1.161 1.449 ...</span></a>
<a class="sourceLine" id="cb30-22" data-line-number="22"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a>
<a class="sourceLine" id="cb30-23" data-line-number="23"><span class="co">#&gt;  $ 3|4: Named num [1:200] 5.92 6.39 6.23 5.63 4.88 ...</span></a>
<a class="sourceLine" id="cb30-24" data-line-number="24"><span class="co">#&gt;   ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...</span></a></code></pre></div>
<p>If the argument <em>sum.distances</em> is set to TRUE, it sums them up, doing in fact the same work done by <strong>distanceMatrix</strong>, <strong>leastCostMatrix</strong> and <strong>leastCost</strong> at once.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">climate.distances &lt;-<span class="st"> </span><span class="kw"><a href="reference/distancePairedSamples.html">distancePairedSamples</a></span>(</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">  <span class="dt">exclude.columns =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb31-6" data-line-number="6">  <span class="dt">same.time =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb31-7" data-line-number="7">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb31-8" data-line-number="8">  <span class="dt">sum.distances =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb31-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb31-10" data-line-number="10">climate.distances</a>
<a class="sourceLine" id="cb31-11" data-line-number="11"><span class="co">#&gt; $`1|2`</span></a>
<a class="sourceLine" id="cb31-12" data-line-number="12"><span class="co">#&gt; [1] 859.1105</span></a>
<a class="sourceLine" id="cb31-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-14" data-line-number="14"><span class="co">#&gt; $`1|3`</span></a>
<a class="sourceLine" id="cb31-15" data-line-number="15"><span class="co">#&gt; [1] 712.0338</span></a>
<a class="sourceLine" id="cb31-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-17" data-line-number="17"><span class="co">#&gt; $`1|4`</span></a>
<a class="sourceLine" id="cb31-18" data-line-number="18"><span class="co">#&gt; [1] 1034.932</span></a>
<a class="sourceLine" id="cb31-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-20" data-line-number="20"><span class="co">#&gt; $`2|3`</span></a>
<a class="sourceLine" id="cb31-21" data-line-number="21"><span class="co">#&gt; [1] 819.8022</span></a>
<a class="sourceLine" id="cb31-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-23" data-line-number="23"><span class="co">#&gt; $`2|4`</span></a>
<a class="sourceLine" id="cb31-24" data-line-number="24"><span class="co">#&gt; [1] 669.1838</span></a>
<a class="sourceLine" id="cb31-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-26" data-line-number="26"><span class="co">#&gt; $`3|4`</span></a>
<a class="sourceLine" id="cb31-27" data-line-number="27"><span class="co">#&gt; [1] 755.5203</span></a></code></pre></div>
<p>Computing <em>psi</em> from there only requires the autosum of each sequence, and the application of the <strong>psi</strong> function.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co">#computing autosum</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2">climate.autosum &lt;-<span class="st"> </span><span class="kw"><a href="reference/autoSum.html">autoSum</a></span>(</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span></a>
<a class="sourceLine" id="cb32-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb32-8" data-line-number="8"></a>
<a class="sourceLine" id="cb32-9" data-line-number="9"><span class="co">#computing psi</span></a>
<a class="sourceLine" id="cb32-10" data-line-number="10">climate.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/psi.html">psi</a></span>(</a>
<a class="sourceLine" id="cb32-11" data-line-number="11">  <span class="dt">least.cost =</span> climate.distances,</a>
<a class="sourceLine" id="cb32-12" data-line-number="12">  <span class="dt">autosum =</span> climate.autosum</a>
<a class="sourceLine" id="cb32-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb32-14" data-line-number="14"></a>
<a class="sourceLine" id="cb32-15" data-line-number="15">climate.psi</a>
<a class="sourceLine" id="cb32-16" data-line-number="16"><span class="co">#&gt; $`1|2`</span></a>
<a class="sourceLine" id="cb32-17" data-line-number="17"><span class="co">#&gt; [1] 3.378791</span></a>
<a class="sourceLine" id="cb32-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-19" data-line-number="19"><span class="co">#&gt; $`1|3`</span></a>
<a class="sourceLine" id="cb32-20" data-line-number="20"><span class="co">#&gt; [1] 2.767909</span></a>
<a class="sourceLine" id="cb32-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-22" data-line-number="22"><span class="co">#&gt; $`1|4`</span></a>
<a class="sourceLine" id="cb32-23" data-line-number="23"><span class="co">#&gt; [1] 4.043498</span></a>
<a class="sourceLine" id="cb32-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-25" data-line-number="25"><span class="co">#&gt; $`2|3`</span></a>
<a class="sourceLine" id="cb32-26" data-line-number="26"><span class="co">#&gt; [1] 3.761143</span></a>
<a class="sourceLine" id="cb32-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-28" data-line-number="28"><span class="co">#&gt; $`2|4`</span></a>
<a class="sourceLine" id="cb32-29" data-line-number="29"><span class="co">#&gt; [1] 2.551667</span></a>
<a class="sourceLine" id="cb32-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb32-31" data-line-number="31"><span class="co">#&gt; $`3|4`</span></a>
<a class="sourceLine" id="cb32-32" data-line-number="32"><span class="co">#&gt; [1] 3.169788</span></a></code></pre></div>
<p>The function <strong>workflowPsi</strong> executes this sequences when the argument <em>paired.samples</em> is set to TRUE, as follows.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">climate.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowPsi.html">workflowPsi</a></span>(</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">  <span class="dt">sequences =</span> climate,</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"sequenceId"</span>,</a>
<a class="sourceLine" id="cb33-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="st">"time"</span>,</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb33-6" data-line-number="6">  <span class="dt">paired.samples =</span> <span class="ot">TRUE</span>, <span class="co">#this bit is important</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7">  <span class="dt">format =</span> <span class="st">"dataframe"</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb33-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(climate.psi, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
psi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
3.3788
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
2.7679
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
4.0435
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
3.7611
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
2.5517
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
3.1698
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co">#cleaning workspace for next example</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(climate, climate.autosum, climate.distances, climate.psi)</a></code></pre></div>
</div>
<div id="restricted-permutation-test-to-assess-the-significance-of-dissimilarity-values" class="section level1">
<h1 class="hasAnchor">
<a href="#restricted-permutation-test-to-assess-the-significance-of-dissimilarity-values" class="anchor"></a>Restricted permutation test to assess the significance of dissimilarity values</h1>
<p>One question that may arise when comparing time series is “to what extent are dissimilarity values random?”. Answering this question requires to compare a given dissimilarity value (<em>psi</em>) with a distribution of dissimilarity values resulting from chance. However… how do we simulate chance in a multivariate time-series? The natural answer is “permutation”. Since samples in a multivariate time-series are ordered, re-shuffling samples is out of the question, but it is possible to re-shuffle the values of the variables within each sample. This kind of permutation is named “restricted permutation”.</p>
<p>A restricted permutation test on <em>psi</em> values requires the following steps:</p>
<ul>
<li>Compute the <em>real psi</em> on two given sequences A and B.</li>
<li>Repeat the following steps several times (99 to 999):
<ul>
<li>For each case of each column of A and B, randomly apply one of these actions:
<ul>
<li>Leave it as is.</li>
<li>Replace it with the previous case.</li>
<li>Replace it with the next case.</li>
</ul>
</li>
<li>Compute <em>randomized psi</em> between A and B and store the value.</li>
</ul>
</li>
<li>Add <em>real psi</em> to the pool of <em>randomized psi</em>.</li>
<li>Compute the proportion of <em>randomized psi</em> that is equal or lower than <em>real psi</em>.</li>
</ul>
<p>Such a proportion represents the probability of obtaining a value lower than <em>real psi</em> by chance.</p>
<p>Since the restricted permutation only happens at a local scale within each column of each sequence, the probability values returned are <strong>very conservative</strong> and shouldn’t be interpreted in the same way p-values are interpreted.</p>
<p>The process described above has been implemented in the <strong>workflowNullPsi</strong> function. We will apply it to three groups of the <em>sequencesMIS</em> dataset.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co">#getting example data</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sequencesMIS)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co">#working with 3 groups (to make this fast)</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5">sequencesMIS &lt;-<span class="st"> </span>sequencesMIS[sequencesMIS<span class="op">$</span>MIS <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"MIS-4"</span>, <span class="st">"MIS-5"</span>, <span class="st">"MIS-6"</span>),]</a>
<a class="sourceLine" id="cb35-6" data-line-number="6"></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="co">#preparing sequences</span></a>
<a class="sourceLine" id="cb35-8" data-line-number="8">sequencesMIS &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb35-9" data-line-number="9">  <span class="dt">sequences =</span> sequencesMIS,</a>
<a class="sourceLine" id="cb35-10" data-line-number="10">  <span class="dt">grouping.column =</span> <span class="st">"MIS"</span>,</a>
<a class="sourceLine" id="cb35-11" data-line-number="11">  <span class="dt">transformation =</span> <span class="st">"hellinger"</span></a>
<a class="sourceLine" id="cb35-12" data-line-number="12">)</a></code></pre></div>
<p>The computation of the null psi values goes as follows:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">random.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowNullPsi.html">workflowNullPsi</a></span>(</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">  <span class="dt">sequences =</span> sequencesMIS,</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"MIS"</span>,</a>
<a class="sourceLine" id="cb36-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">  <span class="dt">paired.samples =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb36-6" data-line-number="6">  <span class="dt">repetitions =</span> <span class="dv">9</span> <span class="co">#recommended values: 99, 999</span></a>
<a class="sourceLine" id="cb36-7" data-line-number="7">)</a></code></pre></div>
<p>Note that the number of repetitions has been set to 9 in order to speed-up execution. The actual number should be 99, and ideally, 999.</p>
<p>The output is a list with two dataframes, <strong>psi</strong> and <strong>p</strong>.</p>
<p>The dataframe <strong>psi</strong> contains the real and random psi values. The column <em>psi</em> contains the dissimilarity between the sequences in the columns <em>A</em> and <em>B</em>. The columns <em>r1</em> to <em>r9</em> contain the psi values obtained from permutations of the sequences.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(random.psi<span class="op">$</span>psi, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
psi
</th>
<th style="text-align:right;">
r1
</th>
<th style="text-align:right;">
r2
</th>
<th style="text-align:right;">
r3
</th>
<th style="text-align:right;">
r4
</th>
<th style="text-align:right;">
r5
</th>
<th style="text-align:right;">
r6
</th>
<th style="text-align:right;">
r7
</th>
<th style="text-align:right;">
r8
</th>
<th style="text-align:right;">
r9
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
2.7452
</td>
<td style="text-align:right;">
3.5801
</td>
<td style="text-align:right;">
1.0108
</td>
<td style="text-align:right;">
2.0398
</td>
<td style="text-align:right;">
3.5858
</td>
<td style="text-align:right;">
1.2728
</td>
<td style="text-align:right;">
2.0929
</td>
<td style="text-align:right;">
3.9632
</td>
<td style="text-align:right;">
1.0159
</td>
<td style="text-align:right;">
2.1560
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.6964
</td>
<td style="text-align:right;">
3.4371
</td>
<td style="text-align:right;">
1.0574
</td>
<td style="text-align:right;">
1.9265
</td>
<td style="text-align:right;">
3.6948
</td>
<td style="text-align:right;">
1.1597
</td>
<td style="text-align:right;">
1.9834
</td>
<td style="text-align:right;">
3.4991
</td>
<td style="text-align:right;">
1.0731
</td>
<td style="text-align:right;">
1.9729
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
1.4667
</td>
<td style="text-align:right;">
3.5061
</td>
<td style="text-align:right;">
1.1663
</td>
<td style="text-align:right;">
2.1745
</td>
<td style="text-align:right;">
3.8673
</td>
<td style="text-align:right;">
1.1517
</td>
<td style="text-align:right;">
2.4507
</td>
<td style="text-align:right;">
3.7685
</td>
<td style="text-align:right;">
1.0278
</td>
<td style="text-align:right;">
2.0605
</td>
</tr>
</tbody>
</table>
<p>The information in this dataframe can be easily plotted as follows:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co">#extracting the dataframe</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2">psi &lt;-<span class="st"> </span>random.psi[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="co">#colors</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5">cols &lt;-<span class="st"> </span>viridis<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">2</span>, <span class="dt">begin =</span> <span class="fl">0.2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb38-6" data-line-number="6"></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="co">#multipanel plot</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(psi)){</a>
<a class="sourceLine" id="cb38-10" data-line-number="10">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/density">density</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(psi[i, <span class="dv">3</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(psi)]), <span class="dt">from =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb38-11" data-line-number="11">       <span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(psi[i, <span class="dv">1</span>], <span class="st">" vs. "</span>,  psi[i, <span class="dv">2</span>], <span class="dt">sep=</span><span class="st">""</span>),</a>
<a class="sourceLine" id="cb38-12" data-line-number="12">       <span class="dt">xlab =</span> <span class="st">"Psi"</span>,</a>
<a class="sourceLine" id="cb38-13" data-line-number="13">       <span class="dt">col =</span> cols[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb38-14" data-line-number="14">       <span class="dt">lwd =</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb38-15" data-line-number="15">       )</a>
<a class="sourceLine" id="cb38-16" data-line-number="16">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> psi[i, <span class="dv">3</span>], </a>
<a class="sourceLine" id="cb38-17" data-line-number="17">         <span class="dt">col =</span> cols[<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb38-18" data-line-number="18">         <span class="dt">lwd=</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb38-19" data-line-number="19">         )</a>
<a class="sourceLine" id="cb38-20" data-line-number="20">}</a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-36-1.png" alt="Real psi values versus psi values computed from randomized sequences. Real psi values are represented by the green vertical line." width="100%"><p class="caption">
Real psi values versus psi values computed from randomized sequences. Real psi values are represented by the green vertical line.
</p>
</div>
<p>According to this data, the psi value obtained for MIS-4 and MIS-6 is more robust (less likely obtained by chance) the the other two. The dataframe <em>p</em> contains the probability of obtaining the real <em>psi</em> value by chance for each combination of sequences.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(random.psi<span class="op">$</span>p)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
p
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
0.7
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.4
</td>
</tr>
</tbody>
</table>
</div>
<div id="assessing-the-contribution-of-a-variable-to-the-dissimilarity-between-two-sequences" class="section level1">
<h1 class="hasAnchor">
<a href="#assessing-the-contribution-of-a-variable-to-the-dissimilarity-between-two-sequences" class="anchor"></a>Assessing the contribution of a variable to the dissimilarity between two sequences</h1>
<p><em>What variables are more important in explaining the dissimilarity between two sequences?</em>, or in other words, <em>what variables contribute the most to the dissimilarity between two sequences?</em> One reasonable answer is: the one that reduces dissimilarity the most when removed from the data.</p>
<p>This section explains how to use the function <strong>workflowImportance</strong> to evaluate the importance of given variables in explaining differences between sequences.</p>
<p>First, we prepare the data. It is again <em>sequencesMIS</em>, but with only three groups selected (MIS 4 to 6) to simplify the analysis.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co">#getting example data</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sequencesMIS)</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="co">#getting three groups only to simplify</span></a>
<a class="sourceLine" id="cb40-5" data-line-number="5">sequencesMIS &lt;-<span class="st"> </span>sequencesMIS[sequencesMIS<span class="op">$</span>MIS <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"MIS-4"</span>, <span class="st">"MIS-5"</span>, <span class="st">"MIS-6"</span>),]</a>
<a class="sourceLine" id="cb40-6" data-line-number="6"></a>
<a class="sourceLine" id="cb40-7" data-line-number="7"><span class="co">#preparing sequences</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8">sequences &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb40-9" data-line-number="9">  <span class="dt">sequences =</span> sequencesMIS,</a>
<a class="sourceLine" id="cb40-10" data-line-number="10">  <span class="dt">grouping.column =</span> <span class="st">"MIS"</span>,</a>
<a class="sourceLine" id="cb40-11" data-line-number="11">  <span class="dt">time.column =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb40-12" data-line-number="12">  <span class="dt">merge.mode =</span> <span class="st">"complete"</span>,</a>
<a class="sourceLine" id="cb40-13" data-line-number="13">  <span class="dt">exclude.columns =</span> <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb40-14" data-line-number="14">)</a></code></pre></div>
<p>The workflow function is pretty similar to the ones explained above. It allows to work with paired samples (aligned time-series) or with unaligned ones by switching between <strong>workflowPsi</strong> and <strong>workflowPsiPairedSamples</strong> as requested by the user through the argument <em>paired.samples</em>. Unlike the other functions in the package, that parallelize the execution of combinations of sequences, this one parallelizes the computation of <em>psi</em> on combinations of columns, removing one column each time.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">psi.importance &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowImportance.html">workflowImportance</a></span>(</a>
<a class="sourceLine" id="cb41-2" data-line-number="2">  <span class="dt">sequences =</span> sequencesMIS,</a>
<a class="sourceLine" id="cb41-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"MIS"</span>,</a>
<a class="sourceLine" id="cb41-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">  <span class="dt">exclude.columns =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb41-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb41-7" data-line-number="7">  <span class="dt">diagonal =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb41-8" data-line-number="8">  <span class="dt">parallel.execution =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb41-9" data-line-number="9">  <span class="dt">paired.samples =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb41-10" data-line-number="10">  )</a></code></pre></div>
<p>The output is a list with two slots named <em>psi</em> and <em>psi.drop</em>.</p>
<p>The dataframe <strong>psi</strong> contains psi values for each combination of variables (named in the coluns <em>A</em> and <em>B</em>) computed for all columns in the column <em>All variables</em>, and one column per variable named <em>Without variable_name</em> containing the psi value when that variable is removed from the compared sequences.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(psi.importance<span class="op">$</span>psi, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
All variables
</th>
<th style="text-align:right;">
Without Carpinus
</th>
<th style="text-align:right;">
Without Tilia
</th>
<th style="text-align:right;">
Without Alnus
</th>
<th style="text-align:right;">
Without Pinus
</th>
<th style="text-align:right;">
Without Betula
</th>
<th style="text-align:right;">
Without Quercus
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
2.2093
</td>
<td style="text-align:right;">
2.2259
</td>
<td style="text-align:right;">
2.2257
</td>
<td style="text-align:right;">
2.2786
</td>
<td style="text-align:right;">
2.8885
</td>
<td style="text-align:right;">
2.2505
</td>
<td style="text-align:right;">
0.9186
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.7145
</td>
<td style="text-align:right;">
0.7070
</td>
<td style="text-align:right;">
0.7139
</td>
<td style="text-align:right;">
0.6955
</td>
<td style="text-align:right;">
0.7377
</td>
<td style="text-align:right;">
0.7045
</td>
<td style="text-align:right;">
0.6033
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
1.4622
</td>
<td style="text-align:right;">
1.4546
</td>
<td style="text-align:right;">
1.4714
</td>
<td style="text-align:right;">
1.4858
</td>
<td style="text-align:right;">
1.7097
</td>
<td style="text-align:right;">
1.5020
</td>
<td style="text-align:right;">
0.7573
</td>
</tr>
</tbody>
</table>
<p>This table can be plotted as a bar plot as follows:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co">#extracting object</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2">psi.df &lt;-<span class="st"> </span>psi.importance<span class="op">$</span>psi</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="co">#to long format</span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5">psi.df.long &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(psi.df, variable, psi, <span class="dv">3</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(psi.df))</a>
<a class="sourceLine" id="cb43-6" data-line-number="6"></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="co">#creating column with names of the sequences</span></a>
<a class="sourceLine" id="cb43-8" data-line-number="8">psi.df.long<span class="op">$</span>name &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(psi.df.long<span class="op">$</span>A, psi.df.long<span class="op">$</span>B, <span class="dt">sep=</span><span class="st">" - "</span>)</a>
<a class="sourceLine" id="cb43-9" data-line-number="9"></a>
<a class="sourceLine" id="cb43-10" data-line-number="10"><span class="co">#plot</span></a>
<a class="sourceLine" id="cb43-11" data-line-number="11"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data=</span>psi.df.long, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>psi, <span class="dt">fill=</span>psi)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="st">"name"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-15" data-line-number="15"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/scale_viridis">scale_fill_viridis</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb43-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Contribution of separated variables to dissimilarity."</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">fill =</span> <span class="st">"Psi"</span>)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-41-1.png" alt="Variable importance analysis of three combinations of sequences. The plot suggest that MIS-4 and MIS-6 are more similar (both are glacial periods), and that the column Quercus is the one with a higher contribution to dissimilarity between sequences." width="100%"><p class="caption">
Variable importance analysis of three combinations of sequences. The plot suggest that MIS-4 and MIS-6 are more similar (both are glacial periods), and that the column Quercus is the one with a higher contribution to dissimilarity between sequences.
</p>
</div>
<p>The second table, named <strong>psi.drop</strong> contains the drop in psi values, in percentage, when the given variable is removed from the analysis. Large positive numbers indicate that dissimilarity drops (increase in similarity) when the given variable is removed, confirming that the variable is important to explain the dissimilarity between both sequences. Negative values indicate an increase in dissimilarity between the sequences when the variable is dropped.</p>
<p>In summary:</p>
<ul>
<li>High psi-drop value: variable contributes to dissimilarity.</li>
<li>Low or negative psi-drop value: variable contributes to similarity.</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(psi.importance<span class="op">$</span>psi.drop)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
<th style="text-align:right;">
Carpinus
</th>
<th style="text-align:right;">
Tilia
</th>
<th style="text-align:right;">
Alnus
</th>
<th style="text-align:right;">
Pinus
</th>
<th style="text-align:right;">
Betula
</th>
<th style="text-align:right;">
Quercus
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:right;">
-0.75
</td>
<td style="text-align:right;">
-0.74
</td>
<td style="text-align:right;">
-3.13
</td>
<td style="text-align:right;">
-30.74
</td>
<td style="text-align:right;">
-1.86
</td>
<td style="text-align:right;">
58.42
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-4
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
1.04
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
2.66
</td>
<td style="text-align:right;">
-3.25
</td>
<td style="text-align:right;">
1.40
</td>
<td style="text-align:right;">
15.56
</td>
</tr>
<tr>
<td style="text-align:left;">
MIS-5
</td>
<td style="text-align:left;">
MIS-6
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
-0.63
</td>
<td style="text-align:right;">
-1.61
</td>
<td style="text-align:right;">
-16.93
</td>
<td style="text-align:right;">
-2.72
</td>
<td style="text-align:right;">
48.21
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co">#extracting object</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2">psi.drop.df &lt;-<span class="st"> </span>psi.importance<span class="op">$</span>psi.drop</a>
<a class="sourceLine" id="cb45-3" data-line-number="3"></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="co">#to long format</span></a>
<a class="sourceLine" id="cb45-5" data-line-number="5">psi.drop.df.long &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(psi.drop.df, variable, psi, <span class="dv">3</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(psi.drop.df))</a>
<a class="sourceLine" id="cb45-6" data-line-number="6"></a>
<a class="sourceLine" id="cb45-7" data-line-number="7"><span class="co">#creating column with names of the sequences</span></a>
<a class="sourceLine" id="cb45-8" data-line-number="8">psi.drop.df.long<span class="op">$</span>name &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(psi.drop.df.long<span class="op">$</span>A, psi.drop.df.long<span class="op">$</span>B, <span class="dt">sep=</span><span class="st">" - "</span>)</a>
<a class="sourceLine" id="cb45-9" data-line-number="9"></a>
<a class="sourceLine" id="cb45-10" data-line-number="10"><span class="co">#plot</span></a>
<a class="sourceLine" id="cb45-11" data-line-number="11"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data=</span>psi.drop.df.long, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>psi, <span class="dt">fill=</span>psi)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="st">"name"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-15" data-line-number="15"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/scale_viridis">scale_fill_viridis</a></span>(<span class="dt">direction =</span> <span class="dv">-1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Drop in dissimilarity when variables are removed."</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Drop in dissimilarity (%)"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">fill =</span> <span class="st">"Psi drop (%)"</span>)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-43-1.png" alt="Drop in psi values, represented as percentage, when a variable is removed from the analysis. Negative values indicate a contribution to similarity, while positive values indicate a contribution to dissimilarity. The plot suggest that Quercus is the variable with a higher contribution to dissimilarity, while Pinus has the higher contribution to similarity." width="100%"><p class="caption">
Drop in psi values, represented as percentage, when a variable is removed from the analysis. Negative values indicate a contribution to similarity, while positive values indicate a contribution to dissimilarity. The plot suggest that Quercus is the variable with a higher contribution to dissimilarity, while Pinus has the higher contribution to similarity.
</p>
</div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co">#cleaning environment for next example</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(psi.df, psi.df.long, psi.drop.df, psi.drop.df.long, psi.importance, sequences, sequencesMIS)</a></code></pre></div>
</div>
<div id="finding-the-section-in-a-long-sequence-more-similar-to-a-given-short-sequence-irregular-time-series" class="section level1">
<h1 class="hasAnchor">
<a href="#finding-the-section-in-a-long-sequence-more-similar-to-a-given-short-sequence-irregular-time-series" class="anchor"></a>Finding the section in a long sequence more similar to a given short sequence (irregular time-series)</h1>
<p>In this scenario the user has one short and one long sequence, and the goal is to find the section in the long sequence that better matches the short one. To recreate this scenario we will use the dataset <em>sequencesMIS</em>. We will extract the first 10 samples as short sequence, and the first 40 samples as long sequence. These small subsets are selected to speed-up the execution time of this example.</p>
<p>A more realistic example would be to select, for example, the group “MIS-5” as short sequence, and the complete sequence as long sequence, in order to find what segments in <em>sequencesMIS</em> is more similar to the “MIS-5” group.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="co">#loading the data</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(sequencesMIS)</a>
<a class="sourceLine" id="cb47-3" data-line-number="3"></a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="co">#removing grouping column</span></a>
<a class="sourceLine" id="cb47-5" data-line-number="5">sequencesMIS<span class="op">$</span>MIS &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb47-6" data-line-number="6"></a>
<a class="sourceLine" id="cb47-7" data-line-number="7"><span class="co">#subsetting to get the short sequence</span></a>
<a class="sourceLine" id="cb47-8" data-line-number="8">MIS.short &lt;-<span class="st"> </span>sequencesMIS[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]</a>
<a class="sourceLine" id="cb47-9" data-line-number="9"></a>
<a class="sourceLine" id="cb47-10" data-line-number="10"><span class="co">#subsetting to get the long sequence</span></a>
<a class="sourceLine" id="cb47-11" data-line-number="11">MIS.long &lt;-<span class="st"> </span>sequencesMIS[<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>, ]</a></code></pre></div>
<p>The sequences have to be prepared and transformed. For simplicity, the sequences are named <em>short</em> and <em>long</em>, and the grouping column is named <em>id</em>, but the user can name them at will. Since the data represents community composition, a Hellinger transformation is applied.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">MIS.short.long &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">  <span class="dt">sequence.A =</span> MIS.short,</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">  <span class="dt">sequence.A.name =</span> <span class="st">"short"</span>,</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">  <span class="dt">sequence.B =</span> MIS.long,</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">  <span class="dt">sequence.B.name =</span> <span class="st">"long"</span>,</a>
<a class="sourceLine" id="cb48-6" data-line-number="6">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb48-7" data-line-number="7">  <span class="dt">transformation =</span> <span class="st">"hellinger"</span></a>
<a class="sourceLine" id="cb48-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb48-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(MIS.short.long, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
Quercus
</th>
<th style="text-align:right;">
Betula
</th>
<th style="text-align:right;">
Pinus
</th>
<th style="text-align:right;">
Alnus
</th>
<th style="text-align:right;">
Tilia
</th>
<th style="text-align:right;">
Carpinus
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.8680
</td>
<td style="text-align:right;">
0.1170
</td>
<td style="text-align:right;">
0.2617
</td>
<td style="text-align:right;">
0.2027
</td>
<td style="text-align:right;">
0.2341
</td>
<td style="text-align:right;">
0.2617
</td>
</tr>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.7331
</td>
<td style="text-align:right;">
0.3623
</td>
<td style="text-align:right;">
0.4677
</td>
<td style="text-align:right;">
0.2236
</td>
<td style="text-align:right;">
0.0002
</td>
<td style="text-align:right;">
0.2500
</td>
</tr>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.9097
</td>
<td style="text-align:right;">
0.3216
</td>
<td style="text-align:right;">
0.2349
</td>
<td style="text-align:right;">
0.0830
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.0830
</td>
</tr>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.8855
</td>
<td style="text-align:right;">
0.3015
</td>
<td style="text-align:right;">
0.2611
</td>
<td style="text-align:right;">
0.1846
</td>
<td style="text-align:right;">
0.0754
</td>
<td style="text-align:right;">
0.1306
</td>
</tr>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.8931
</td>
<td style="text-align:right;">
0.2713
</td>
<td style="text-align:right;">
0.3229
</td>
<td style="text-align:right;">
0.1108
</td>
<td style="text-align:right;">
0.0783
</td>
<td style="text-align:right;">
0.0783
</td>
</tr>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.9494
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.2056
</td>
<td style="text-align:right;">
0.1678
</td>
<td style="text-align:right;">
0.1187
</td>
<td style="text-align:right;">
0.1187
</td>
</tr>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.9022
</td>
<td style="text-align:right;">
0.0002
</td>
<td style="text-align:right;">
0.3324
</td>
<td style="text-align:right;">
0.2287
</td>
<td style="text-align:right;">
0.1525
</td>
<td style="text-align:right;">
0.0002
</td>
</tr>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.8768
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.3194
</td>
<td style="text-align:right;">
0.2857
</td>
<td style="text-align:right;">
0.1166
</td>
<td style="text-align:right;">
0.1844
</td>
</tr>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.8716
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.4575
</td>
<td style="text-align:right;">
0.1245
</td>
<td style="text-align:right;">
0.1245
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
short
</td>
<td style="text-align:right;">
0.8793
</td>
<td style="text-align:right;">
0.0917
</td>
<td style="text-align:right;">
0.3667
</td>
<td style="text-align:right;">
0.2425
</td>
<td style="text-align:right;">
0.1588
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8680
</td>
<td style="text-align:right;">
0.1170
</td>
<td style="text-align:right;">
0.2617
</td>
<td style="text-align:right;">
0.2027
</td>
<td style="text-align:right;">
0.2341
</td>
<td style="text-align:right;">
0.2617
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.7331
</td>
<td style="text-align:right;">
0.3623
</td>
<td style="text-align:right;">
0.4677
</td>
<td style="text-align:right;">
0.2236
</td>
<td style="text-align:right;">
0.0002
</td>
<td style="text-align:right;">
0.2500
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9097
</td>
<td style="text-align:right;">
0.3216
</td>
<td style="text-align:right;">
0.2349
</td>
<td style="text-align:right;">
0.0830
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.0830
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8855
</td>
<td style="text-align:right;">
0.3015
</td>
<td style="text-align:right;">
0.2611
</td>
<td style="text-align:right;">
0.1846
</td>
<td style="text-align:right;">
0.0754
</td>
<td style="text-align:right;">
0.1306
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8931
</td>
<td style="text-align:right;">
0.2713
</td>
<td style="text-align:right;">
0.3229
</td>
<td style="text-align:right;">
0.1108
</td>
<td style="text-align:right;">
0.0783
</td>
<td style="text-align:right;">
0.0783
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9494
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.2056
</td>
<td style="text-align:right;">
0.1678
</td>
<td style="text-align:right;">
0.1187
</td>
<td style="text-align:right;">
0.1187
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9022
</td>
<td style="text-align:right;">
0.0002
</td>
<td style="text-align:right;">
0.3324
</td>
<td style="text-align:right;">
0.2287
</td>
<td style="text-align:right;">
0.1525
</td>
<td style="text-align:right;">
0.0002
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8768
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.3194
</td>
<td style="text-align:right;">
0.2857
</td>
<td style="text-align:right;">
0.1166
</td>
<td style="text-align:right;">
0.1844
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8716
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.4575
</td>
<td style="text-align:right;">
0.1245
</td>
<td style="text-align:right;">
0.1245
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8793
</td>
<td style="text-align:right;">
0.0917
</td>
<td style="text-align:right;">
0.3667
</td>
<td style="text-align:right;">
0.2425
</td>
<td style="text-align:right;">
0.1588
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8502
</td>
<td style="text-align:right;">
0.1723
</td>
<td style="text-align:right;">
0.4667
</td>
<td style="text-align:right;">
0.1723
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8601
</td>
<td style="text-align:right;">
0.0902
</td>
<td style="text-align:right;">
0.4132
</td>
<td style="text-align:right;">
0.1562
</td>
<td style="text-align:right;">
0.2386
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9170
</td>
<td style="text-align:right;">
0.0754
</td>
<td style="text-align:right;">
0.3536
</td>
<td style="text-align:right;">
0.0754
</td>
<td style="text-align:right;">
0.1508
</td>
<td style="text-align:right;">
0.0002
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9358
</td>
<td style="text-align:right;">
0.0002
</td>
<td style="text-align:right;">
0.0769
</td>
<td style="text-align:right;">
0.2035
</td>
<td style="text-align:right;">
0.2774
</td>
<td style="text-align:right;">
0.0002
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9620
</td>
<td style="text-align:right;">
0.0788
</td>
<td style="text-align:right;">
0.1115
</td>
<td style="text-align:right;">
0.1762
</td>
<td style="text-align:right;">
0.1576
</td>
<td style="text-align:right;">
0.0002
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8692
</td>
<td style="text-align:right;">
0.0005
</td>
<td style="text-align:right;">
0.4714
</td>
<td style="text-align:right;">
0.1491
</td>
<td style="text-align:right;">
0.0005
</td>
<td style="text-align:right;">
0.0005
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9315
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.2227
</td>
<td style="text-align:right;">
0.0909
</td>
<td style="text-align:right;">
0.2727
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8919
</td>
<td style="text-align:right;">
0.1508
</td>
<td style="text-align:right;">
0.3482
</td>
<td style="text-align:right;">
0.1741
</td>
<td style="text-align:right;">
0.1741
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8722
</td>
<td style="text-align:right;">
0.2265
</td>
<td style="text-align:right;">
0.2615
</td>
<td style="text-align:right;">
0.2615
</td>
<td style="text-align:right;">
0.2265
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8882
</td>
<td style="text-align:right;">
0.3496
</td>
<td style="text-align:right;">
0.2108
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.2108
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.7977
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
0.4264
</td>
<td style="text-align:right;">
0.4264
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
0.0010
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9295
</td>
<td style="text-align:right;">
0.1549
</td>
<td style="text-align:right;">
0.1549
</td>
<td style="text-align:right;">
0.2828
</td>
<td style="text-align:right;">
0.0894
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9225
</td>
<td style="text-align:right;">
0.1786
</td>
<td style="text-align:right;">
0.1031
</td>
<td style="text-align:right;">
0.3262
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.9010
</td>
<td style="text-align:right;">
0.1407
</td>
<td style="text-align:right;">
0.2814
</td>
<td style="text-align:right;">
0.1990
</td>
<td style="text-align:right;">
0.2225
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8898
</td>
<td style="text-align:right;">
0.3819
</td>
<td style="text-align:right;">
0.2500
</td>
<td style="text-align:right;">
0.0005
</td>
<td style="text-align:right;">
0.0005
</td>
<td style="text-align:right;">
0.0005
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8935
</td>
<td style="text-align:right;">
0.2593
</td>
<td style="text-align:right;">
0.3550
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.0917
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.8452
</td>
<td style="text-align:right;">
0.3780
</td>
<td style="text-align:right;">
0.3780
</td>
<td style="text-align:right;">
0.0008
</td>
<td style="text-align:right;">
0.0008
</td>
<td style="text-align:right;">
0.0008
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.6070
</td>
<td style="text-align:right;">
0.3244
</td>
<td style="text-align:right;">
0.6489
</td>
<td style="text-align:right;">
0.0007
</td>
<td style="text-align:right;">
0.3244
</td>
<td style="text-align:right;">
0.0007
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
0.5222
</td>
<td style="text-align:right;">
0.8528
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
0.0010
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.0011
</td>
<td style="text-align:right;">
0.4714
</td>
<td style="text-align:right;">
0.8819
</td>
<td style="text-align:right;">
0.0011
</td>
<td style="text-align:right;">
0.0011
</td>
<td style="text-align:right;">
0.0011
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.5000
</td>
<td style="text-align:right;">
0.6124
</td>
<td style="text-align:right;">
0.6124
</td>
<td style="text-align:right;">
0.0011
</td>
<td style="text-align:right;">
0.0011
</td>
<td style="text-align:right;">
0.0011
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
0.4472
</td>
<td style="text-align:right;">
0.8944
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
0.0010
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.0006
</td>
<td style="text-align:right;">
0.3922
</td>
<td style="text-align:right;">
0.8987
</td>
<td style="text-align:right;">
0.1961
</td>
<td style="text-align:right;">
0.0006
</td>
<td style="text-align:right;">
0.0006
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.0007
</td>
<td style="text-align:right;">
0.3086
</td>
<td style="text-align:right;">
0.9512
</td>
<td style="text-align:right;">
0.0007
</td>
<td style="text-align:right;">
0.0007
</td>
<td style="text-align:right;">
0.0007
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.2041
</td>
<td style="text-align:right;">
0.2887
</td>
<td style="text-align:right;">
0.9129
</td>
<td style="text-align:right;">
0.2041
</td>
<td style="text-align:right;">
0.0005
</td>
<td style="text-align:right;">
0.0005
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.0007
</td>
<td style="text-align:right;">
0.3162
</td>
<td style="text-align:right;">
0.9220
</td>
<td style="text-align:right;">
0.2236
</td>
<td style="text-align:right;">
0.0007
</td>
<td style="text-align:right;">
0.0007
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.2611
</td>
<td style="text-align:right;">
0.3371
</td>
<td style="text-align:right;">
0.8919
</td>
<td style="text-align:right;">
0.1508
</td>
<td style="text-align:right;">
0.0005
</td>
<td style="text-align:right;">
0.0005
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.0006
</td>
<td style="text-align:right;">
0.3536
</td>
<td style="text-align:right;">
0.9186
</td>
<td style="text-align:right;">
0.1768
</td>
<td style="text-align:right;">
0.0006
</td>
<td style="text-align:right;">
0.0006
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.1104
</td>
<td style="text-align:right;">
0.2469
</td>
<td style="text-align:right;">
0.9627
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
long
</td>
<td style="text-align:right;">
0.0004
</td>
<td style="text-align:right;">
0.1796
</td>
<td style="text-align:right;">
0.9837
</td>
<td style="text-align:right;">
0.0004
</td>
<td style="text-align:right;">
0.0004
</td>
<td style="text-align:right;">
0.0004
</td>
</tr>
</tbody>
</table>
<p>The function <strong>workflowPartialMatch</strong> shown below is going to subset the long sequence in sizes between <em>min.length</em> and <em>max.length</em>. In the example below this search space is reduced to the minimum (the rows of <em>MIS.short</em> plus and minus one) to speed-up the execution of this example. If left empty, the length of the segment in the long sequence to be matched will have the same number of samples as the short sequence. In the example below we look for segments of the same length, two samples shorter, and two samples longer than the shorter sequence.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">MIS.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowPartialMatch.html">workflowPartialMatch</a></span>(</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">  <span class="dt">sequences =</span> MIS.short.long,</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb49-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb49-5" data-line-number="5">  <span class="dt">paired.samples =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb49-6" data-line-number="6">  <span class="dt">min.length =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(MIS.short) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb49-7" data-line-number="7">  <span class="dt">max.length =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(MIS.short) <span class="op">+</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb49-8" data-line-number="8">)</a></code></pre></div>
<p>The function returns a dataframe with three columns: <em>first.row</em> (first row of the matched segment of the long sequence), <em>last.row</em> (last row of the matched segment of the long sequence), and <em>psi</em> (ordered from lower to higher). In this case, since the long sequence contains the short sequence, the first row shows a perfect match.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(MIS.psi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ], <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:right;">
first.row
</th>
<th style="text-align:right;">
last.row
</th>
<th style="text-align:right;">
psi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.0419
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.0490
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.0540
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.1168
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.3338
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.3408
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.3507
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.3514
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.3603
</td>
</tr>
</tbody>
</table>
<p>Subsetting the long sequence to obtain the segment best matching with the short sequence goes as follows.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="co">#indices of the best matching segment</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2">best.match.indices &lt;-<span class="st"> </span>MIS.psi[<span class="dv">1</span>, <span class="st">"first.row"</span>]<span class="op">:</span>MIS.psi[<span class="dv">1</span>, <span class="st">"last.row"</span>]</a>
<a class="sourceLine" id="cb51-3" data-line-number="3"></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"><span class="co">#subsetting by these indices</span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5">best.match &lt;-<span class="st"> </span>MIS.long[best.match.indices, ]</a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="co">#cleaning workspace</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(best.match, MIS.long, MIS.psi, MIS.short, MIS.short.long, sequencesMIS, best.match.indices)</a></code></pre></div>
</div>
<div id="finding-the-section-in-a-long-sequence-more-similar-to-a-given-short-sequence-regular-time-series-paired-samples" class="section level1">
<h1 class="hasAnchor">
<a href="#finding-the-section-in-a-long-sequence-more-similar-to-a-given-short-sequence-regular-time-series-paired-samples" class="anchor"></a>Finding the section in a long sequence more similar to a given short sequence (regular time-series, paired samples)</h1>
<p>When regular time-series are provided, and the analysis needs to be done comparing only aligned samples, the argument <em>paired.samples</em> can be set to TRUE, and instead of the least-cost algorithm to find the minimized distance between sequences, the function <strong>distancePairedSamples</strong> (shown above) is used to compute the distance between sequences of the same length (short sequence versus subsets of the long sequence). In such a case, the arguments <em>min.length</em> and <em>max.length</em> are irrelevant, and the sample-size of the matching segments in the long sequence have equals the sample-size of the short sequence. This application is ideal when the user has regular time-series.</p>
<p>The example below shows how it is done with the <em>climateShort</em> and <em>climateLong</em> datasets. The goal is to find the subset in <em>climateLong</em> better matching <em>climateShort</em>, with the same number of rows (11) as <em>climateShort</em>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co">#loading sample data</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(climateLong) <span class="co">#has "age" column</span></a>
<a class="sourceLine" id="cb53-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(climateShort) <span class="co">#no "age" column</span></a>
<a class="sourceLine" id="cb53-4" data-line-number="4"></a>
<a class="sourceLine" id="cb53-5" data-line-number="5"><span class="co">#merging and scaling both datasets</span></a>
<a class="sourceLine" id="cb53-6" data-line-number="6">climate.short.long &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb53-7" data-line-number="7">  <span class="dt">sequence.A =</span> climateShort,</a>
<a class="sourceLine" id="cb53-8" data-line-number="8">  <span class="dt">sequence.A.name =</span> <span class="st">"short"</span>,</a>
<a class="sourceLine" id="cb53-9" data-line-number="9">  <span class="dt">sequence.B =</span> climateLong,</a>
<a class="sourceLine" id="cb53-10" data-line-number="10">  <span class="dt">sequence.B.name =</span> <span class="st">"long"</span>,</a>
<a class="sourceLine" id="cb53-11" data-line-number="11">  <span class="dt">time.column =</span> <span class="st">"age"</span>,</a>
<a class="sourceLine" id="cb53-12" data-line-number="12">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb53-13" data-line-number="13">  <span class="dt">transformation =</span> <span class="st">"scale"</span></a>
<a class="sourceLine" id="cb53-14" data-line-number="14">)</a>
<a class="sourceLine" id="cb53-15" data-line-number="15"><span class="co">#&gt; Warning in prepareSequences(sequence.A = climateShort, sequence.A.name</span></a>
<a class="sourceLine" id="cb53-16" data-line-number="16"><span class="co">#&gt; = "short", : I couldn't find 'time.column' in 'sequenceA'. Added one and</span></a>
<a class="sourceLine" id="cb53-17" data-line-number="17"><span class="co">#&gt; filled it with NA.</span></a>
<a class="sourceLine" id="cb53-18" data-line-number="18"></a>
<a class="sourceLine" id="cb53-19" data-line-number="19"><span class="co">#computing psi</span></a>
<a class="sourceLine" id="cb53-20" data-line-number="20">climate.psi &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowPartialMatch.html">workflowPartialMatch</a></span>(</a>
<a class="sourceLine" id="cb53-21" data-line-number="21">  <span class="dt">sequences =</span> climate.short.long,</a>
<a class="sourceLine" id="cb53-22" data-line-number="22">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb53-23" data-line-number="23">  <span class="dt">time.column =</span> <span class="st">"age"</span>,</a>
<a class="sourceLine" id="cb53-24" data-line-number="24">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb53-25" data-line-number="25">  <span class="dt">paired.samples =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb53-26" data-line-number="26">)</a>
<a class="sourceLine" id="cb53-27" data-line-number="27"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(climate.psi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ], <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:right;">
first.row
</th>
<th style="text-align:right;">
last.row
</th>
<th style="text-align:right;">
psi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0.0660
</td>
</tr>
<tr>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
0.0885
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0.1180
</td>
</tr>
<tr>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
144
</td>
<td style="text-align:right;">
0.2601
</td>
</tr>
<tr>
<td style="text-align:right;">
629
</td>
<td style="text-align:right;">
639
</td>
<td style="text-align:right;">
0.4431
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0.4562
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0.4565
</td>
</tr>
<tr>
<td style="text-align:right;">
136
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
0.4902
</td>
</tr>
<tr>
<td style="text-align:right;">
631
</td>
<td style="text-align:right;">
641
</td>
<td style="text-align:right;">
0.4972
</td>
</tr>
</tbody>
</table>
<p>Since <em>climateShort</em> is a subset of <em>climateLong</em>, there is a perfect match from the rows 17 to 27.</p>
<p>In this case the solutions are computed among sequences of the same length, and with distances computed only between aligned samples.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="co">#cleaning workspace</span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(climateLong, climateShort, climate.short.long, climate.psi)</a></code></pre></div>
</div>
<div id="sequence-slotting-combining-samples-of-two-sequences-into-a-single-composite-sequence" class="section level1">
<h1 class="hasAnchor">
<a href="#sequence-slotting-combining-samples-of-two-sequences-into-a-single-composite-sequence" class="anchor"></a>Sequence slotting: combining samples of two sequences into a single composite sequence</h1>
<p>Under this scenario, the objective is to combine two sequences in order to obtain a single composite sequence. The basic assumption followed by the algorithm building the composite sequence is <em>most similar samples should go together, but respecting the original ordering of the sequences</em>. Therefore, the output will contain the samples in both sequences ordered in a way that minimizes the multivariate distance between consecutive samples. This scenario assumes that at least one of the sequences do not have a time/age/depth column, or that the values in such a column are uncertain. In any case, time/age/depth is not considered as a factor in the generation of the composite sequence.</p>
<p>The example below uses the <strong>pollenGP</strong> dataset, which contains 200 samples, with 40 pollen types each. To create a smalle case study, the code below separates the first 20 samples of the sequence into two different sequences with 10 randomly selected samples each. Even though this scenario assumes that these sequences do not have depth or age, these columns will be kept so the result can be assessed. That is why these columns are added to the <em>exclude.columns</em> argument. Also, note that the argument <em>transformation</em> is set to “none”, so the output is not transformed, and the outcome can be easily interpreted. This will give more weight to the most abundant taxa, which will in fact guide the slotting.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="co">#loading the data</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(pollenGP)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"></a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="co">#getting first 20 samples</span></a>
<a class="sourceLine" id="cb55-5" data-line-number="5">pollenGP &lt;-<span class="st"> </span>pollenGP[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, ]</a>
<a class="sourceLine" id="cb55-6" data-line-number="6"></a>
<a class="sourceLine" id="cb55-7" data-line-number="7"><span class="co">#sampling indices</span></a>
<a class="sourceLine" id="cb55-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">10</span>) <span class="co">#to get same result every time</span></a>
<a class="sourceLine" id="cb55-9" data-line-number="9">sampling.indices &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb55-10" data-line-number="10"></a>
<a class="sourceLine" id="cb55-11" data-line-number="11"><span class="co">#subsetting the sequence</span></a>
<a class="sourceLine" id="cb55-12" data-line-number="12">A &lt;-<span class="st"> </span>pollenGP[sampling.indices, ]</a>
<a class="sourceLine" id="cb55-13" data-line-number="13">B &lt;-<span class="st"> </span>pollenGP[<span class="op">-</span>sampling.indices, ]</a>
<a class="sourceLine" id="cb55-14" data-line-number="14"></a>
<a class="sourceLine" id="cb55-15" data-line-number="15"><span class="co">#preparing the sequences</span></a>
<a class="sourceLine" id="cb55-16" data-line-number="16">AB &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb55-17" data-line-number="17">  <span class="dt">sequence.A =</span> A,</a>
<a class="sourceLine" id="cb55-18" data-line-number="18">  <span class="dt">sequence.A.name =</span> <span class="st">"A"</span>,</a>
<a class="sourceLine" id="cb55-19" data-line-number="19">  <span class="dt">sequence.B =</span> B,</a>
<a class="sourceLine" id="cb55-20" data-line-number="20">  <span class="dt">sequence.B.name =</span> <span class="st">"B"</span>,</a>
<a class="sourceLine" id="cb55-21" data-line-number="21">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb55-22" data-line-number="22">  <span class="dt">exclude.columns =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"depth"</span>, <span class="st">"age"</span>),</a>
<a class="sourceLine" id="cb55-23" data-line-number="23">  <span class="dt">transformation =</span> <span class="st">"none"</span></a>
<a class="sourceLine" id="cb55-24" data-line-number="24">)</a>
<a class="sourceLine" id="cb55-25" data-line-number="25"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ], <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
depth
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
Abies
</th>
<th style="text-align:right;">
Juniperus
</th>
<th style="text-align:right;">
Hedera
</th>
<th style="text-align:right;">
Plantago
</th>
<th style="text-align:right;">
Boraginaceae
</th>
<th style="text-align:right;">
Crassulaceae
</th>
<th style="text-align:right;">
Pinus
</th>
<th style="text-align:right;">
Ranunculaceae
</th>
<th style="text-align:right;">
Rhamnus
</th>
<th style="text-align:right;">
Caryophyllaceae
</th>
<th style="text-align:right;">
Dipsacaceae
</th>
<th style="text-align:right;">
Betula
</th>
<th style="text-align:right;">
Acer
</th>
<th style="text-align:right;">
Armeria
</th>
<th style="text-align:right;">
Tilia
</th>
<th style="text-align:right;">
Hippophae
</th>
<th style="text-align:right;">
Salix
</th>
<th style="text-align:right;">
Thalictrum
</th>
<th style="text-align:right;">
Labiatae
</th>
<th style="text-align:right;">
Valeriana
</th>
<th style="text-align:right;">
Nymphaea
</th>
<th style="text-align:right;">
Umbelliferae
</th>
<th style="text-align:right;">
Sanguisorba_minor
</th>
<th style="text-align:right;">
Plantago.lanceolata
</th>
<th style="text-align:right;">
Campanulaceae
</th>
<th style="text-align:right;">
Asteroideae
</th>
<th style="text-align:right;">
Gentiana
</th>
<th style="text-align:right;">
Fraxinus
</th>
<th style="text-align:right;">
Cichorioideae
</th>
<th style="text-align:right;">
Taxus
</th>
<th style="text-align:right;">
Rumex
</th>
<th style="text-align:right;">
Cedrus
</th>
<th style="text-align:right;">
Ranunculus.subgen..Batrachium
</th>
<th style="text-align:right;">
Cyperaceae
</th>
<th style="text-align:right;">
Corylus
</th>
<th style="text-align:right;">
Myriophyllum
</th>
<th style="text-align:right;">
Filipendula
</th>
<th style="text-align:right;">
Vitis
</th>
<th style="text-align:right;">
Rubiaceae
</th>
<th style="text-align:right;">
Polypodium
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.97
</td>
<td style="text-align:right;">
11243
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4.05
</td>
<td style="text-align:right;">
11459
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4.07
</td>
<td style="text-align:right;">
11514
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
4.10
</td>
<td style="text-align:right;">
11595
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
155
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4.17
</td>
<td style="text-align:right;">
11784
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4.20
</td>
<td style="text-align:right;">
11865
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
4.22
</td>
<td style="text-align:right;">
11919
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
4.25
</td>
<td style="text-align:right;">
12000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
4.32
</td>
<td style="text-align:right;">
12189
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
4.35
</td>
<td style="text-align:right;">
12270
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.92
</td>
<td style="text-align:right;">
11108
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.95
</td>
<td style="text-align:right;">
11189
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
11324
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4.02
</td>
<td style="text-align:right;">
11378
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
4.27
</td>
<td style="text-align:right;">
12054
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(sampling.indices)</a></code></pre></div>
<p>Once the sequences are prepared, the function <strong>workflowSlotting</strong> will allow to combine (slot) them. The function computes a distance matrix between the samples in both sequences according to the <em>method</em> argument, computes the least cost matrix, and generates the least cost path.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">AB.combined &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowSlotting.html">workflowSlotting</a></span>(</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">  <span class="dt">sequences =</span> AB,</a>
<a class="sourceLine" id="cb57-3" data-line-number="3">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb57-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="st">"age"</span>, </a>
<a class="sourceLine" id="cb57-5" data-line-number="5">  <span class="dt">exclude.columns =</span> <span class="st">"depth"</span>,</a>
<a class="sourceLine" id="cb57-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb57-7" data-line-number="7">  <span class="dt">plot =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb57-8" data-line-number="8">)</a></code></pre></div>
<p>The function reads the least cost path in order to find the combination of samples of both sequences that minimizes dissimilarity, constrained by the order of the samples on each sequence. The output dataframe has a column named <em>original.index</em>, which has the index of each sample in the original datasets.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(AB.combined[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">format =</span> <span class="st">"html"</span>, <span class="dt">digits =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/row_spec">row_spec</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>), <span class="dt">bold =</span> T)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
original.index
</th>
<th style="text-align:right;">
depth
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
Abies
</th>
<th style="text-align:right;">
Juniperus
</th>
<th style="text-align:right;">
Hedera
</th>
<th style="text-align:right;">
Plantago
</th>
<th style="text-align:right;">
Boraginaceae
</th>
<th style="text-align:right;">
Crassulaceae
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.92
</td>
<td style="text-align:right;">
11108
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.95
</td>
<td style="text-align:right;">
11189
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
47
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
11324
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
65
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:left;font-weight: bold;">
A
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
3
</td>
<td style="text-align:right;font-weight: bold;">
3.97
</td>
<td style="text-align:right;font-weight: bold;">
11243
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
5
</td>
<td style="text-align:right;font-weight: bold;">
12
</td>
<td style="text-align:right;font-weight: bold;">
21
</td>
<td style="text-align:right;font-weight: bold;">
95
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4.05
</td>
<td style="text-align:right;">
11459
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
14
</td>
<td style="text-align:left;font-weight: bold;">
B
</td>
<td style="text-align:right;font-weight: bold;">
4
</td>
<td style="text-align:right;font-weight: bold;">
5
</td>
<td style="text-align:right;font-weight: bold;">
4.02
</td>
<td style="text-align:right;font-weight: bold;">
11378
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
44
</td>
<td style="text-align:right;font-weight: bold;">
76
</td>
<td style="text-align:right;font-weight: bold;">
110
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4.07
</td>
<td style="text-align:right;">
11514
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
4.10
</td>
<td style="text-align:right;">
11595
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
155
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4.17
</td>
<td style="text-align:right;">
11784
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
4.27
</td>
<td style="text-align:right;">
12054
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
6
</td>
<td style="text-align:left;font-weight: bold;">
A
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
10
</td>
<td style="text-align:right;font-weight: bold;">
4.20
</td>
<td style="text-align:right;font-weight: bold;">
11865
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
35
</td>
<td style="text-align:right;font-weight: bold;">
30
</td>
<td style="text-align:right;font-weight: bold;">
112
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
7
</td>
<td style="text-align:left;font-weight: bold;">
A
</td>
<td style="text-align:right;font-weight: bold;">
7
</td>
<td style="text-align:right;font-weight: bold;">
11
</td>
<td style="text-align:right;font-weight: bold;">
4.22
</td>
<td style="text-align:right;font-weight: bold;">
11919
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
30
</td>
<td style="text-align:right;font-weight: bold;">
45
</td>
<td style="text-align:right;font-weight: bold;">
150
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
8
</td>
<td style="text-align:left;font-weight: bold;">
A
</td>
<td style="text-align:right;font-weight: bold;">
8
</td>
<td style="text-align:right;font-weight: bold;">
12
</td>
<td style="text-align:right;font-weight: bold;">
4.25
</td>
<td style="text-align:right;font-weight: bold;">
12000
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
44
</td>
<td style="text-align:right;font-weight: bold;">
35
</td>
<td style="text-align:right;font-weight: bold;">
150
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
4.30
</td>
<td style="text-align:right;">
12135
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
4.32
</td>
<td style="text-align:right;">
12189
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Note that several samples (highlighted in bold) show inverted ages with respect to the previous samples. This is expected, since the slotting algorithm only takes into account distance/dissimilarity between adjacent samples to generate the ordering.</p>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-56-1.png" alt="Sequences A (green) and B (blue) with their ordered samples (upper panel), and the composite sequence resulting from them (lower panel) after applying the sequence slotting algorithm. Notice that the slotting takes into account all columns in both datasets, and therefore, a single column, as shown in the plot, might not be totally representative of the slotting solution." width="100%"><p class="caption">
Sequences A (green) and B (blue) with their ordered samples (upper panel), and the composite sequence resulting from them (lower panel) after applying the sequence slotting algorithm. Notice that the slotting takes into account all columns in both datasets, and therefore, a single column, as shown in the plot, might not be totally representative of the slotting solution.
</p>
</div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="co">#cleaning workspace</span></a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(A, B, AB, AB.combined, pollenGP, cols, taxon, y.lim)</a></code></pre></div>
</div>
<div id="transferring-an-attribute-from-one-sequence-to-another" class="section level1">
<h1 class="hasAnchor">
<a href="#transferring-an-attribute-from-one-sequence-to-another" class="anchor"></a>Transferring an attribute from one sequence to another</h1>
<p>This scenario assumes that the user has two multivariate sequences, one of them with a given attribute (age/time) that needs to be transferred to the other sequence by using similarity/dissimilarity (constrained by sample order) as a transfer criterion.</p>
<p>The code below prepares the data for the example. The sequence <strong>pollenGP</strong> is the reference sequence, and contains the column <em>age</em>. The sequence <strong>pollenX</strong> is the target sequence, without an <em>age</em> column. We generate it by taking 40 random samples between the samples 50 and 100 of <strong>pollenGP</strong>. The sequences are prepared with <em>prepareSequences</em>, as usual, with the identificators “GP” and “X”</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="co">#loading sample dataset</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(pollenGP)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3"></a>
<a class="sourceLine" id="cb60-4" data-line-number="4"><span class="co">#subset pollenGP to make a shorter dataset</span></a>
<a class="sourceLine" id="cb60-5" data-line-number="5">pollenGP &lt;-<span class="st"> </span>pollenGP[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, ]</a>
<a class="sourceLine" id="cb60-6" data-line-number="6"></a>
<a class="sourceLine" id="cb60-7" data-line-number="7"><span class="co">#generating a subset of pollenGP </span></a>
<a class="sourceLine" id="cb60-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb60-9" data-line-number="9">pollenX &lt;-<span class="st"> </span>pollenGP[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="dv">40</span>)), ]</a>
<a class="sourceLine" id="cb60-10" data-line-number="10"></a>
<a class="sourceLine" id="cb60-11" data-line-number="11"><span class="co">#we separate the age column</span></a>
<a class="sourceLine" id="cb60-12" data-line-number="12">pollenX.age &lt;-<span class="st"> </span>pollenX<span class="op">$</span>age</a>
<a class="sourceLine" id="cb60-13" data-line-number="13"></a>
<a class="sourceLine" id="cb60-14" data-line-number="14"><span class="co">#and remove the age values from pollenX</span></a>
<a class="sourceLine" id="cb60-15" data-line-number="15">pollenX<span class="op">$</span>age &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb60-16" data-line-number="16">pollenX<span class="op">$</span>depth &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb60-17" data-line-number="17"></a>
<a class="sourceLine" id="cb60-18" data-line-number="18"><span class="co">#removing some samples from pollenGP</span></a>
<a class="sourceLine" id="cb60-19" data-line-number="19"><span class="co">#so pollenX is not a perfect subset of pollenGP</span></a>
<a class="sourceLine" id="cb60-20" data-line-number="20">pollenGP &lt;-<span class="st"> </span>pollenGP[<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="dv">10</span>), ]</a>
<a class="sourceLine" id="cb60-21" data-line-number="21"></a>
<a class="sourceLine" id="cb60-22" data-line-number="22"><span class="co">#prepare sequences</span></a>
<a class="sourceLine" id="cb60-23" data-line-number="23">GP.X &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb60-24" data-line-number="24">  <span class="dt">sequence.A =</span> pollenGP,</a>
<a class="sourceLine" id="cb60-25" data-line-number="25">  <span class="dt">sequence.A.name =</span> <span class="st">"GP"</span>,</a>
<a class="sourceLine" id="cb60-26" data-line-number="26">  <span class="dt">sequence.B =</span> pollenX,</a>
<a class="sourceLine" id="cb60-27" data-line-number="27">  <span class="dt">sequence.B.name =</span> <span class="st">"X"</span>,</a>
<a class="sourceLine" id="cb60-28" data-line-number="28">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb60-29" data-line-number="29">  <span class="dt">time.column =</span> <span class="st">"age"</span>,</a>
<a class="sourceLine" id="cb60-30" data-line-number="30">  <span class="dt">exclude.columns =</span> <span class="st">"depth"</span>,</a>
<a class="sourceLine" id="cb60-31" data-line-number="31">  <span class="dt">transformation =</span> <span class="st">"none"</span></a>
<a class="sourceLine" id="cb60-32" data-line-number="32">)</a></code></pre></div>
<p>The transfer of “age” values from <em>GP</em> to <em>X</em> can be done in two ways, both constrained by sample order:</p>
<ul>
<li>
<strong>Direct</strong>: each sample in <em>X</em> gets the age of its most similar sample in <em>GP</em>.</li>
<li>
<strong>Interpolated</strong>: each sample in <em>X</em> gets an age interpolated from the ages of the two most similar samples in <em>GP</em>. The interpolation is weighted by the similarity between the samples.</li>
</ul>
<div id="direct-transfer" class="section level2">
<h2 class="hasAnchor">
<a href="#direct-transfer" class="anchor"></a>Direct transfer</h2>
<p><strong>THIS SECTION IS A WORK IN PROGRESS</strong></p>
<p>A direct transfer of an attribute from the samples of one sequence to the samples of another requires to compute a distance matrix between samples, the least cost matrix and its least cost path (both with the option <em>diagonal</em> activated), and to parse the least cost path file to assign attribute values. This is done by the function <strong>workflowTransfer</strong> with the option <span class="math inline">\(mode = TRUE\)</span>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="co">#parameters</span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2">X.new &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowTransfer.html">workflowTransfer</a></span>(</a>
<a class="sourceLine" id="cb61-3" data-line-number="3">  <span class="dt">sequences =</span> GP.X,</a>
<a class="sourceLine" id="cb61-4" data-line-number="4">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb61-5" data-line-number="5">  <span class="dt">time.column =</span> <span class="st">"age"</span>,</a>
<a class="sourceLine" id="cb61-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb61-7" data-line-number="7">  <span class="dt">transfer.what =</span> <span class="st">"age"</span>,</a>
<a class="sourceLine" id="cb61-8" data-line-number="8">  <span class="dt">transfer.from =</span> <span class="st">"GP"</span>,</a>
<a class="sourceLine" id="cb61-9" data-line-number="9">  <span class="dt">transfer.to =</span> <span class="st">"X"</span>,</a>
<a class="sourceLine" id="cb61-10" data-line-number="10">  <span class="dt">mode =</span> <span class="st">"direct"</span></a>
<a class="sourceLine" id="cb61-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb61-12" data-line-number="12"></a>
<a class="sourceLine" id="cb61-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(X.new[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ], <span class="dt">digits =</span> <span class="dv">4</span>)  <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/row_spec">row_spec</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>), <span class="dt">bold =</span> T)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
depth
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
Abies
</th>
<th style="text-align:right;">
Juniperus
</th>
<th style="text-align:right;">
Hedera
</th>
<th style="text-align:right;">
Plantago
</th>
<th style="text-align:right;">
Boraginaceae
</th>
<th style="text-align:right;">
Crassulaceae
</th>
<th style="text-align:right;">
Pinus
</th>
<th style="text-align:right;">
Ranunculaceae
</th>
<th style="text-align:right;">
Rhamnus
</th>
<th style="text-align:right;">
Caryophyllaceae
</th>
<th style="text-align:right;">
Dipsacaceae
</th>
<th style="text-align:right;">
Betula
</th>
<th style="text-align:right;">
Acer
</th>
<th style="text-align:right;">
Armeria
</th>
<th style="text-align:right;">
Tilia
</th>
<th style="text-align:right;">
Hippophae
</th>
<th style="text-align:right;">
Salix
</th>
<th style="text-align:right;">
Thalictrum
</th>
<th style="text-align:right;">
Labiatae
</th>
<th style="text-align:right;">
Valeriana
</th>
<th style="text-align:right;">
Nymphaea
</th>
<th style="text-align:right;">
Umbelliferae
</th>
<th style="text-align:right;">
Sanguisorba_minor
</th>
<th style="text-align:right;">
Plantago.lanceolata
</th>
<th style="text-align:right;">
Campanulaceae
</th>
<th style="text-align:right;">
Asteroideae
</th>
<th style="text-align:right;">
Gentiana
</th>
<th style="text-align:right;">
Fraxinus
</th>
<th style="text-align:right;">
Cichorioideae
</th>
<th style="text-align:right;">
Taxus
</th>
<th style="text-align:right;">
Rumex
</th>
<th style="text-align:right;">
Cedrus
</th>
<th style="text-align:right;">
Ranunculus.subgen..Batrachium
</th>
<th style="text-align:right;">
Cyperaceae
</th>
<th style="text-align:right;">
Corylus
</th>
<th style="text-align:right;">
Myriophyllum
</th>
<th style="text-align:right;">
Filipendula
</th>
<th style="text-align:right;">
Vitis
</th>
<th style="text-align:right;">
Rubiaceae
</th>
<th style="text-align:right;">
Polypodium
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.92
</td>
<td style="text-align:right;">
11108
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
11324
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.02
</td>
<td style="text-align:right;">
11378
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.05
</td>
<td style="text-align:right;">
11459
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
45
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4.07
</td>
<td style="text-align:right;font-weight: bold;">
11514
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
20
</td>
<td style="text-align:right;font-weight: bold;">
80
</td>
<td style="text-align:right;font-weight: bold;">
100
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
10
</td>
<td style="text-align:right;font-weight: bold;">
4
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
3
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
8
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
46
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4.07
</td>
<td style="text-align:right;font-weight: bold;">
11595
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
34
</td>
<td style="text-align:right;font-weight: bold;">
80
</td>
<td style="text-align:right;font-weight: bold;">
155
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
13
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
47
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.17
</td>
<td style="text-align:right;">
11784
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
48
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.20
</td>
<td style="text-align:right;">
11865
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
49
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.22
</td>
<td style="text-align:right;">
11919
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
50
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4.25
</td>
<td style="text-align:right;font-weight: bold;">
12000
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
44
</td>
<td style="text-align:right;font-weight: bold;">
35
</td>
<td style="text-align:right;font-weight: bold;">
150
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
8
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
3
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
5
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
3
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
51
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4.25
</td>
<td style="text-align:right;font-weight: bold;">
12054
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
37
</td>
<td style="text-align:right;font-weight: bold;">
30
</td>
<td style="text-align:right;font-weight: bold;">
150
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
10
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
7
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
7
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
3
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
52
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4.32
</td>
<td style="text-align:right;font-weight: bold;">
12135
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
50
</td>
<td style="text-align:right;font-weight: bold;">
10
</td>
<td style="text-align:right;font-weight: bold;">
120
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
7
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
8
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
8
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
53
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4.32
</td>
<td style="text-align:right;font-weight: bold;">
12189
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
43
</td>
<td style="text-align:right;font-weight: bold;">
17
</td>
<td style="text-align:right;font-weight: bold;">
120
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
15
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
5
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
54
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4.40
</td>
<td style="text-align:right;font-weight: bold;">
12324
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
50
</td>
<td style="text-align:right;font-weight: bold;">
11
</td>
<td style="text-align:right;font-weight: bold;">
86
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
15
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
4
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
5
</td>
<td style="text-align:right;font-weight: bold;">
3
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
5
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
3
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
55
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4.40
</td>
<td style="text-align:right;font-weight: bold;">
12405
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
51
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
70
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
16
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
5
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
3
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
</tr>
</tbody>
</table>
<p>The algorithm finds the most similar samples, and transfers attribute values directly between them. This can result in duplicated attribute values, as highlighted in the table above. The Pearson correlation between the original ages (stored in <em>pollenX.age</em>) and the assigned ones is 0.9996, so it can be concluded that in spite of its simplicity, this algorithm yields accurate results.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="co">#cleaning workspace</span></a>
<a class="sourceLine" id="cb62-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(GP.X, pollenX, X.new, pollenX.age)</a></code></pre></div>
</div>
<div id="interpolated-transfer" class="section level2">
<h2 class="hasAnchor">
<a href="#interpolated-transfer" class="anchor"></a>Interpolated transfer</h2>
<p>If we consider:</p>
<ul>
<li>Two samples <span class="math inline">\(A_{i}\)</span> and <span class="math inline">\(A_{j}\)</span> of the sequence <span class="math inline">\(A\)</span>.</li>
<li>Each one with a value the attribute <span class="math inline">\(t\)</span>, <span class="math inline">\(At_{i}\)</span> and <span class="math inline">\(At_{j}\)</span>.</li>
<li>One sample <span class="math inline">\(B_{k}\)</span> of the sequence <span class="math inline">\(B\)</span>.</li>
<li>With an <strong>unknown attribute</strong> <span class="math inline">\(Bt_{k}\)</span>.</li>
<li>The multivariate distance <span class="math inline">\(D_{B_{k}A_{i}}\)</span> between the samples <span class="math inline">\(A_{i}\)</span> and <span class="math inline">\(B_{k}\)</span>.</li>
<li>The multivariate distance <span class="math inline">\(D_{B_{k}A_{j}}\)</span> between the samples <span class="math inline">\(A_{j}\)</span> and <span class="math inline">\(B_{k}\)</span>.</li>
<li>The weight <span class="math inline">\(w_{i}\)</span>, computed as <span class="math inline">\(D_{B_{k}A_{i}} / (D_{B_{k}A_{i}} + D_{B_{k}A_{j}})\)</span>
</li>
<li>The weight <span class="math inline">\(w_{j}\)</span>, computed as <span class="math inline">\(D_{B_{k}A_{j}} / (D_{B_{k}A_{i}} + D_{B_{k}A_{j}})\)</span>
</li>
</ul>
<p>The unknwon value <span class="math inline">\(Bt_{k}\)</span> is computed as:</p>
<p><span class="math display">\[Bt_{k} = w_{i} \times At_{i} + w_{j} \times At_{j}\]</span></p>
<p>The code below exemplifies the operation, using the samples 1 and 4 of the dataset <em>pollenGP</em> as <span class="math inline">\(Ai\)</span> and <span class="math inline">\(Aj\)</span>, and the sample 3 as <span class="math inline">\(Bk\)</span>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="co">#loading data</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(pollenGP)</a>
<a class="sourceLine" id="cb63-3" data-line-number="3"></a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="co">#samples in A</span></a>
<a class="sourceLine" id="cb63-5" data-line-number="5">Ai &lt;-<span class="st"> </span>pollenGP[<span class="dv">1</span>, <span class="dv">3</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(pollenGP)]</a>
<a class="sourceLine" id="cb63-6" data-line-number="6">Aj &lt;-<span class="st"> </span>pollenGP[<span class="dv">4</span>, <span class="dv">3</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(pollenGP)]</a>
<a class="sourceLine" id="cb63-7" data-line-number="7"></a>
<a class="sourceLine" id="cb63-8" data-line-number="8"><span class="co">#ages of the samples in A</span></a>
<a class="sourceLine" id="cb63-9" data-line-number="9">Ati &lt;-<span class="st"> </span>pollenGP[<span class="dv">1</span>, <span class="st">"age"</span>]</a>
<a class="sourceLine" id="cb63-10" data-line-number="10">Atj &lt;-<span class="st"> </span>pollenGP[<span class="dv">4</span>, <span class="st">"age"</span>]</a>
<a class="sourceLine" id="cb63-11" data-line-number="11"></a>
<a class="sourceLine" id="cb63-12" data-line-number="12"><span class="co">#sample in B</span></a>
<a class="sourceLine" id="cb63-13" data-line-number="13">Bk &lt;-<span class="st"> </span>pollenGP[<span class="dv">2</span>, <span class="dv">3</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(pollenGP)]</a>
<a class="sourceLine" id="cb63-14" data-line-number="14"></a>
<a class="sourceLine" id="cb63-15" data-line-number="15"><span class="co">#computing distances between Bk, Ai, and Aj</span></a>
<a class="sourceLine" id="cb63-16" data-line-number="16">DBkAi &lt;-<span class="st"> </span><span class="kw"><a href="reference/distance.html">distance</a></span>(Bk, Ai)</a>
<a class="sourceLine" id="cb63-17" data-line-number="17">DBkAj &lt;-<span class="st"> </span><span class="kw"><a href="reference/distance.html">distance</a></span>(Bk, Aj)</a>
<a class="sourceLine" id="cb63-18" data-line-number="18"></a>
<a class="sourceLine" id="cb63-19" data-line-number="19"><span class="co">#normalizing the distances to 1</span></a>
<a class="sourceLine" id="cb63-20" data-line-number="20">wi &lt;-<span class="st"> </span>DBkAi <span class="op">/</span><span class="st"> </span>(DBkAi <span class="op">+</span><span class="st"> </span>DBkAj)</a>
<a class="sourceLine" id="cb63-21" data-line-number="21">wj &lt;-<span class="st"> </span>DBkAj <span class="op">/</span><span class="st"> </span>(DBkAi <span class="op">+</span><span class="st"> </span>DBkAj)</a>
<a class="sourceLine" id="cb63-22" data-line-number="22"></a>
<a class="sourceLine" id="cb63-23" data-line-number="23"><span class="co">#computing  Btk</span></a>
<a class="sourceLine" id="cb63-24" data-line-number="24">Btk &lt;-<span class="st"> </span>wi <span class="op">*</span><span class="st"> </span>Ati <span class="op">+</span><span class="st"> </span>wj <span class="op">*</span><span class="st"> </span>Atj</a></code></pre></div>
<p>The table below shows the observed versus the predicted values for <span class="math inline">\(Btk\)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">temp.df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Observed =</span> pollenGP[<span class="dv">3</span>, <span class="st">"age"</span>], <span class="dt">Predicted =</span> Btk)</a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(temp.df), <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table class="table table"><tbody>
<tr>
<td style="text-align:left;">
Observed
</td>
<td style="text-align:right;">
3.9700
</td>
</tr>
<tr>
<td style="text-align:left;">
Predicted
</td>
<td style="text-align:right;">
3.9735
</td>
</tr>
</tbody></table>
<p>Below we create some example data, where a subset of <em>pollenGP</em> will be the donor of age values, and another subset of it, named <em>pollenX</em> will be the receiver of the age values.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="co">#loading sample dataset</span></a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(pollenGP)</a>
<a class="sourceLine" id="cb65-3" data-line-number="3"></a>
<a class="sourceLine" id="cb65-4" data-line-number="4"><span class="co">#subset pollenGP to make a shorter dataset</span></a>
<a class="sourceLine" id="cb65-5" data-line-number="5">pollenGP &lt;-<span class="st"> </span>pollenGP[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, ]</a>
<a class="sourceLine" id="cb65-6" data-line-number="6"></a>
<a class="sourceLine" id="cb65-7" data-line-number="7"><span class="co">#generating a subset of pollenGP </span></a>
<a class="sourceLine" id="cb65-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb65-9" data-line-number="9">pollenX &lt;-<span class="st"> </span>pollenGP[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="dv">40</span>)), ]</a>
<a class="sourceLine" id="cb65-10" data-line-number="10"></a>
<a class="sourceLine" id="cb65-11" data-line-number="11"><span class="co">#we separate the age column</span></a>
<a class="sourceLine" id="cb65-12" data-line-number="12">pollenX.age &lt;-<span class="st"> </span>pollenX<span class="op">$</span>age</a>
<a class="sourceLine" id="cb65-13" data-line-number="13"></a>
<a class="sourceLine" id="cb65-14" data-line-number="14"><span class="co">#and remove the age values from pollenX</span></a>
<a class="sourceLine" id="cb65-15" data-line-number="15">pollenX<span class="op">$</span>age &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb65-16" data-line-number="16">pollenX<span class="op">$</span>depth &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb65-17" data-line-number="17"></a>
<a class="sourceLine" id="cb65-18" data-line-number="18"><span class="co">#removing some samples from pollenGP</span></a>
<a class="sourceLine" id="cb65-19" data-line-number="19"><span class="co">#so pollenX is not a perfect subset of pollenGP</span></a>
<a class="sourceLine" id="cb65-20" data-line-number="20">pollenGP &lt;-<span class="st"> </span>pollenGP[<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="dv">10</span>), ]</a>
<a class="sourceLine" id="cb65-21" data-line-number="21"></a>
<a class="sourceLine" id="cb65-22" data-line-number="22"><span class="co">#prepare sequences</span></a>
<a class="sourceLine" id="cb65-23" data-line-number="23">GP.X &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepareSequences.html">prepareSequences</a></span>(</a>
<a class="sourceLine" id="cb65-24" data-line-number="24">  <span class="dt">sequence.A =</span> pollenGP,</a>
<a class="sourceLine" id="cb65-25" data-line-number="25">  <span class="dt">sequence.A.name =</span> <span class="st">"GP"</span>,</a>
<a class="sourceLine" id="cb65-26" data-line-number="26">  <span class="dt">sequence.B =</span> pollenX,</a>
<a class="sourceLine" id="cb65-27" data-line-number="27">  <span class="dt">sequence.B.name =</span> <span class="st">"X"</span>,</a>
<a class="sourceLine" id="cb65-28" data-line-number="28">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb65-29" data-line-number="29">  <span class="dt">time.column =</span> <span class="st">"age"</span>,</a>
<a class="sourceLine" id="cb65-30" data-line-number="30">  <span class="dt">exclude.columns =</span> <span class="st">"depth"</span>,</a>
<a class="sourceLine" id="cb65-31" data-line-number="31">  <span class="dt">transformation =</span> <span class="st">"none"</span></a>
<a class="sourceLine" id="cb65-32" data-line-number="32">)</a></code></pre></div>
<p>To transfer attributes from <em>GP</em> to <em>X</em> we use the <strong>workflowTransfer</strong> function with the option <em>mode = “interpolate”</em>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="co">#parameters</span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2">X.new &lt;-<span class="st"> </span><span class="kw"><a href="reference/workflowTransfer.html">workflowTransfer</a></span>(</a>
<a class="sourceLine" id="cb66-3" data-line-number="3">  <span class="dt">sequences =</span> GP.X,</a>
<a class="sourceLine" id="cb66-4" data-line-number="4">  <span class="dt">grouping.column =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb66-5" data-line-number="5">  <span class="dt">time.column =</span> <span class="st">"age"</span>,</a>
<a class="sourceLine" id="cb66-6" data-line-number="6">  <span class="dt">method =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb66-7" data-line-number="7">  <span class="dt">transfer.what =</span> <span class="st">"age"</span>,</a>
<a class="sourceLine" id="cb66-8" data-line-number="8">  <span class="dt">transfer.from =</span> <span class="st">"GP"</span>,</a>
<a class="sourceLine" id="cb66-9" data-line-number="9">  <span class="dt">transfer.to =</span> <span class="st">"X"</span>,</a>
<a class="sourceLine" id="cb66-10" data-line-number="10">  <span class="dt">mode =</span> <span class="st">"interpolated"</span></a>
<a class="sourceLine" id="cb66-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb66-12" data-line-number="12"></a>
<a class="sourceLine" id="cb66-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(X.new[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ], <span class="dt">digits =</span> <span class="dv">4</span>)  <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/row_spec">row_spec</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">8</span>, <span class="dv">13</span>), <span class="dt">bold =</span> T)</a></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
depth
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
Abies
</th>
<th style="text-align:right;">
Juniperus
</th>
<th style="text-align:right;">
Hedera
</th>
<th style="text-align:right;">
Plantago
</th>
<th style="text-align:right;">
Boraginaceae
</th>
<th style="text-align:right;">
Crassulaceae
</th>
<th style="text-align:right;">
Pinus
</th>
<th style="text-align:right;">
Ranunculaceae
</th>
<th style="text-align:right;">
Rhamnus
</th>
<th style="text-align:right;">
Caryophyllaceae
</th>
<th style="text-align:right;">
Dipsacaceae
</th>
<th style="text-align:right;">
Betula
</th>
<th style="text-align:right;">
Acer
</th>
<th style="text-align:right;">
Armeria
</th>
<th style="text-align:right;">
Tilia
</th>
<th style="text-align:right;">
Hippophae
</th>
<th style="text-align:right;">
Salix
</th>
<th style="text-align:right;">
Thalictrum
</th>
<th style="text-align:right;">
Labiatae
</th>
<th style="text-align:right;">
Valeriana
</th>
<th style="text-align:right;">
Nymphaea
</th>
<th style="text-align:right;">
Umbelliferae
</th>
<th style="text-align:right;">
Sanguisorba_minor
</th>
<th style="text-align:right;">
Plantago.lanceolata
</th>
<th style="text-align:right;">
Campanulaceae
</th>
<th style="text-align:right;">
Asteroideae
</th>
<th style="text-align:right;">
Gentiana
</th>
<th style="text-align:right;">
Fraxinus
</th>
<th style="text-align:right;">
Cichorioideae
</th>
<th style="text-align:right;">
Taxus
</th>
<th style="text-align:right;">
Rumex
</th>
<th style="text-align:right;">
Cedrus
</th>
<th style="text-align:right;">
Ranunculus.subgen..Batrachium
</th>
<th style="text-align:right;">
Cyperaceae
</th>
<th style="text-align:right;">
Corylus
</th>
<th style="text-align:right;">
Myriophyllum
</th>
<th style="text-align:right;">
Filipendula
</th>
<th style="text-align:right;">
Vitis
</th>
<th style="text-align:right;">
Rubiaceae
</th>
<th style="text-align:right;">
Polypodium
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.9498
</td>
<td style="text-align:right;">
11108
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.9705
</td>
<td style="text-align:right;">
11324
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.0003
</td>
<td style="text-align:right;">
11378
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.0212
</td>
<td style="text-align:right;">
11459
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.0512
</td>
<td style="text-align:right;">
11514
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
46
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.1308
</td>
<td style="text-align:right;">
11595
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
155
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
47
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.1985
</td>
<td style="text-align:right;">
11784
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
48
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
NA
</td>
<td style="text-align:right;font-weight: bold;">
11865
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
35
</td>
<td style="text-align:right;font-weight: bold;">
30
</td>
<td style="text-align:right;font-weight: bold;">
112
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
4
</td>
<td style="text-align:right;font-weight: bold;">
8
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
7
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
10
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
49
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.2014
</td>
<td style="text-align:right;">
11919
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
50
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.2223
</td>
<td style="text-align:right;">
12000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.2301
</td>
<td style="text-align:right;">
12054
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
52
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.2726
</td>
<td style="text-align:right;">
12135
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
53
</td>
<td style="text-align:left;font-weight: bold;">
X
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
NA
</td>
<td style="text-align:right;font-weight: bold;">
12189
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
43
</td>
<td style="text-align:right;font-weight: bold;">
17
</td>
<td style="text-align:right;font-weight: bold;">
120
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
15
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
5
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
2
</td>
<td style="text-align:right;font-weight: bold;">
1
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
<td style="text-align:right;font-weight: bold;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
54
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.3521
</td>
<td style="text-align:right;">
12324
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
55
</td>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.4177
</td>
<td style="text-align:right;">
12405
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>When interpolated values of the <em>age</em> column (transferred attribute via interpolation) show the value <em>NA</em>, it means that the interpolation yielded an age lower than the previous one. This happens when the same <span class="math inline">\(Ai\)</span> and <span class="math inline">\(Aj\)</span> are used to evaluate two or more different samples <span class="math inline">\(Bk\)</span>, and the second <span class="math inline">\(Bk\)</span> is more similar to <span class="math inline">\(Ai\)</span> than the first one. These NA values can be removed with <em>na.omit()</em>, or interpolated with the functions <a href="https://www.rdocumentation.org/packages/imputeTS/versions/2.7/topics/na.interpolation">imputeTS::na.interpolation</a> or <a href="https://www.rdocumentation.org/packages/zoo/versions/1.8-6/topics/na.approx">zoo::na.approx</a>.</p>
<p>Without taking into account these <em>NA</em> values, the Pearson correlation of the interpolated ages with the real ones is 0.9984.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Blas M. Benito <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Blas M. Benito.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
