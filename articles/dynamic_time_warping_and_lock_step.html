<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Dynamic Time Warping and Lock Step Comparison • distantia</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Dynamic Time Warping and Lock Step Comparison">
<link rel="stylesheet" href="extra.css">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">distantia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/psi_dissimilarity_metric.html">The Psi Dissimilarity Metric</a></li>
    <li><a class="dropdown-item" href="../articles/dynamic_time_warping_and_lock_step.html">Dynamic Time Warping and Lock Step Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/time_series_lists.html">Working With Time Series Lists</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Original Paper</h6></li>
    <li><a class="external-link dropdown-item" href="https://nsojournals.onlinelibrary.wiley.com/doi/full/10.1111/ecog.04895">Benito &amp; Birks 2020 (Ecography)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BlasBenito/distantia/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dynamic Time Warping and Lock Step Comparison</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BlasBenito/distantia/blob/main/vignettes/articles/dynamic_time_warping_and_lock_step.Rmd" class="external-link"><code>vignettes/articles/dynamic_time_warping_and_lock_step.Rmd</code></a></small>
      <div class="d-none name"><code>dynamic_time_warping_and_lock_step.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="work-in-progress">WORK IN PROGRESS<a class="anchor" aria-label="anchor" href="#work-in-progress"></a>
</h2>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>The R package <code>distantia</code> implements two general methods
to compare time series: <strong>dynamic time warping</strong> and
<strong>lock step comparison</strong>. This article presents how these
methods are implemented, and offers hints about their application
scope.</p>
</div>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>The packages required to run the code in this article are
<code>distantia</code> and <code>dtw</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://blasbenito.github.io/distantia/">distantia</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dynamictimewarping.github.io/" class="external-link">dtw</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>The data frame <code>cities_temperature</code> contains long-term
time series of monthly temperatures for 20 large cities.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cities_temperature</span><span class="op">)</span></span></code></pre></div>
<p>The code below performs these operations:</p>
<ul>
<li>Uses the function <code><a href="../reference/tsl_initialize.html">tsl_initialize()</a></code> to transform the
<code>cities_temperature</code> data frame into a time series list.</li>
<li>Applies <code><a href="../reference/tsl_subset.html">tsl_subset()</a></code> to select three cities and a
shorter time span.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsl_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsl_initialize.html">tsl_initialize</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">cities_temperature</span>,</span>
<span>  name_column <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>  time_column <span class="op">=</span> <span class="st">"time"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tsl_subset.html">tsl_subset</a></span><span class="op">(</span></span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"London"</span>, </span>
<span>      <span class="st">"Paris"</span>, </span>
<span>      <span class="st">"Kinshasa"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"2000-01-01"</span>, </span>
<span>      <span class="st">"2005-01-01"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The time series plot below shows the resulting data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tsl_plot.html">tsl_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_raw</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The resulting TSL contains two synchronous time series with similar
temperature ranges (London and Paris), and a third one (Kinshasa) with a
much higher average temperature, and a different temporal pattern. A
different setup in the function <code><a href="../reference/tsl_plot.html">tsl_plot()</a></code> should make such
pattern more obvious.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tsl_plot.html">tsl_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_raw</span>,</span>
<span>  ylim <span class="op">=</span> <span class="st">"relative"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This data is in fact ready for a direct time series comparison with a
lock-step method. However, dynamic time warping works much better on
scaled and centered data when there are important differences in
magnitude between time series. The function <code><a href="../reference/tsl_transform.html">tsl_transform()</a></code>
paired with <code>f_scale</code> applies this transformation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsl_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsl_transform.html">tsl_transform</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl</span>,</span>
<span>  f <span class="op">=</span> <span class="va">f_scale</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tsl_plot.html">tsl_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_scaled</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="methods-for-dissimilarity-analysis">Methods for Dissimilarity Analysis<a class="anchor" aria-label="anchor" href="#methods-for-dissimilarity-analysis"></a>
</h3>
<p>The function <code><a href="../reference/distantia.html">distantia()</a></code> offers two alternative methods
to compare time series: <strong>Dynamic Time Warping</strong> and
<strong>Lock-Step</strong>.</p>
<div class="section level4">
<h4 id="dynamic-time-warping-dtw">Dynamic Time Warping (DTW)<a class="anchor" aria-label="anchor" href="#dynamic-time-warping-dtw"></a>
</h4>
<p>This method warps the time axes of the compared time series to
maximize the alignment of sections with similar shapes. DTW involves
these steps:</p>
<ol style="list-style-type: decimal">
<li>Compute the distance matrix between all samples of the two time
series.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psi_distance_matrix.html">psi_distance_matrix</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">tsl_scaled</span><span class="op">[[</span><span class="st">"London"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  y <span class="op">=</span> <span class="va">tsl_scaled</span><span class="op">[[</span><span class="st">"Kinshasa"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/utils_matrix_plot.html">utils_matrix_plot</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m.dist</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Transform the distance matrix into a cost matrix.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m.cost</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psi_cost_matrix.html">psi_cost_matrix</a></span><span class="op">(</span></span>
<span>  dist_matrix <span class="op">=</span> <span class="va">m.dist</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/utils_matrix_plot.html">utils_matrix_plot</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m.cost</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Find the least cost path</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m.cost.path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psi_cost_path.html">psi_cost_path</a></span><span class="op">(</span></span>
<span>  dist_matrix <span class="op">=</span> <span class="va">m.dist</span>,</span>
<span>  cost_matrix <span class="op">=</span> <span class="va">m.cost</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/utils_matrix_plot.html">utils_matrix_plot</a></span><span class="op">(</span></span>
<span>  m <span class="op">=</span> <span class="va">m.cost</span>,</span>
<span>  path <span class="op">=</span> <span class="va">m.cost.path</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The time warping is implicit in the coordinates of the least cost
path. For example, in the lower left corner of the plot above, the first
sample of London (column “y”) is paired with the saples 1 to 4 of
Kinshasa (column “x”).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">m.cost.path</span><span class="op">)</span></span></code></pre></div>
<p>All these individual steps plus the computation of the <em>psi</em>
dissimilarity score can be performed at once with the function
<code><a href="../reference/distantia.html">distantia()</a></code>, as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distantia.html">distantia</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_scaled</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"London"</span>, <span class="st">"Kinshasa"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  lock_step <span class="op">=</span> <span class="cn">FALSE</span> <span class="co">#default, lock step disabled</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"psi"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>The function <code><a href="../reference/distantia_plot.html">distantia_plot()</a></code> offers a good graphical
representation of the warping result and decomposes the computation of
the <em>psi</em> dissimilarity score.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/distantia_plot.html">distantia_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_scaled</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"London"</span>, <span class="st">"Kinshasa"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>DTW is an ideal method to compare time series with temporal shifts,
and is applicable to regular and irregular time series with the same or
different numbers of samples.</p>
<p><strong>DTW is sensitive to differences in magnitudes</strong></p>
<p>When the data is not scaled and/or centered, the sensitivity to data
magnitude of DTW may lead to local optima that distort the warping. The
example below comparing the raw temperatures of London and Kinshasa
shows two of these local optima, one in the <em>y</em> axis, at the
minimum temperature in Kinshasa (winter of 2001), and another in the
<em>x</em> axis, at the maximum temperature in London (summer of
2003).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/distantia_plot.html">distantia_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_raw</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"London"</span>, <span class="st">"Kinshasa"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This is not a particular issue of the algorithm implemented in
<code>distantia</code>, but a general behavior of time warping methods.
The code below shows a similar analysis performed with the R package <a href="https://CRAN.R-project.org/package=dtw" class="external-link"><code>dtw</code></a>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xy_dtw</span> <span class="op">&lt;-</span> <span class="fu">dtw</span><span class="fu">::</span><span class="fu">dtw</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">tsl_raw</span><span class="op">$</span><span class="va">London</span><span class="op">$</span><span class="va">temperature</span>,</span>
<span>  y <span class="op">=</span> <span class="va">tsl_raw</span><span class="op">$</span><span class="va">Kinshasa</span><span class="op">$</span><span class="va">temperature</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xy_dtw</span>, type <span class="op">=</span> <span class="st">"threeway"</span><span class="op">)</span></span></code></pre></div>
<p>, so it performs best when the data is scaled, and optionally
centered if absolute values are not critical for the analysis.</p>
</div>
<div class="section level4">
<h4 id="lock-step-ls">Lock-Step (LS)<a class="anchor" aria-label="anchor" href="#lock-step-ls"></a>
</h4>
<p>Compares values at corresponding time points directly, without any
temporal adjustments. This method is suitable for cases where preserving
temporal integrity is essential, but it requires time series sampled at
the same time points. This method does not require scaling unless the
results are to be compared with DTW, in which case scaling ensures
comparable results across both methods.</p>
<p>The column “psi” represents the normalized dissimilarity between
pairs of time series. According to these values, London and Kinshasa
show the most dissimilar temperatures, while London and Paris show the
most similar ones.</p>
<p>The time warping analysis can be plotted with
<code><a href="../reference/distantia_plot.html">distantia_plot()</a></code>. The temperature patterns of “Paris” and
“London” are quite similar, and require no warping.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/distantia_plot.html">distantia_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_three_cities</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Paris"</span>, <span class="st">"London"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The warping alignment between “London” and “Kinshasa” shows the
adjustments made by DTW to match the peaks and valleys of both time
series, and compensate for their shifted patterns.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/distantia_plot.html">distantia_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_three_cities</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"London"</span>, <span class="st">"Kinshasa"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>When the data is not scaled and/or centered, the sensitivity to data
magnitude of DTW may lead to local optima that distort the warping. The
example below comparing the raw temperatures of London and Kinshasa
shows two of these local optima, one in the <em>y</em> axis, at the
minimum temperature in Kinshasa (winter of 2001), and another in the
<em>x</em> axis, at the maximum temperature in London (summer of
2003).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsl_two_cities</span> <span class="op">&lt;-</span> <span class="va">tsl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tsl_subset.html">tsl_subset</a></span><span class="op">(</span></span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"London"</span>, </span>
<span>      <span class="st">"Kinshasa"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2000-01-01"</span>, <span class="st">"2005-01-01"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/distantia_plot.html">distantia_plot</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_two_cities</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="lock-step">Lock Step<a class="anchor" aria-label="anchor" href="#lock-step"></a>
</h5>
<p>When <code>lock_step = TRUE</code>, the lock-step method is
activated, and the time series are compared on an
observation-to-observation basis. This method yields increased
dissimilarity scores when the involved time series show shifted
patterns.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distantia.html">distantia</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_three_cities</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  lock_step <span class="op">=</span> <span class="cn">TRUE</span> <span class="co">#activates lock-step</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#adding the results of dtw to facilitate comparison</span></span>
<span><span class="va">df_ls</span><span class="op">$</span><span class="va">psi_dtw</span> <span class="op">&lt;-</span> <span class="va">df_dtw</span><span class="op">$</span><span class="va">psi</span></span>
<span><span class="va">df_ls</span><span class="op">$</span><span class="va">psi_lock_step</span> <span class="op">&lt;-</span> <span class="va">df_ls</span><span class="op">$</span><span class="va">psi</span></span>
<span></span>
<span><span class="va">df_ls</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"psi_lock_step"</span>,  <span class="st">"psi_dtw"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>It is important to take in mind that here we are performing the
lock-step analysis with the scaled data to compare its output with the
DTW results. The results on the raw data are shown below.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsl_three_cities</span> <span class="op">&lt;-</span> <span class="va">tsl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tsl_subset.html">tsl_subset</a></span><span class="op">(</span></span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"London"</span>, </span>
<span>      <span class="st">"Paris"</span>, </span>
<span>      <span class="st">"Kinshasa"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2000-01-01"</span>, <span class="st">"2005-01-01"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">df_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distantia.html">distantia</a></span><span class="op">(</span></span>
<span>  tsl <span class="op">=</span> <span class="va">tsl_three_cities</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  lock_step <span class="op">=</span> <span class="cn">TRUE</span> <span class="co">#activates lock-step</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_ls</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"psi"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://blasbenito.com" class="external-link">Blas M. Benito</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
